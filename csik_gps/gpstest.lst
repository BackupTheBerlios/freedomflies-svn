GAS LISTING /var/tmp//cchOv7GV.s 			page 1


   1               		.file	"gpstest.c"
   2               		.arch atmega32
   3               	__SREG__ = 0x3f
   4               	__SP_H__ = 0x3e
   5               	__SP_L__ = 0x3d
   6               	__tmp_reg__ = 0
   7               	__zero_reg__ = 1
   8               		.global __do_copy_data
   9               		.global __do_clear_bss
  10               		.stabs	"/opt/local/avr/avrlib/freedomflies/csik_gps/",100,0,2,.Ltext0
  11               		.stabs	"gpstest.c",100,0,2,.Ltext0
  12               		.text
  13               	.Ltext0:
  14               		.stabs	"gcc2_compiled.",60,0,0,0
  15               		.stabs	"int:t(0,1)=r(0,1);-32768;32767;",128,0,0,0
  16               		.stabs	"char:t(0,2)=r(0,2);0;127;",128,0,0,0
  17               		.stabs	"long int:t(0,3)=@s32;r(0,3);020000000000;017777777777;",128,0,0,0
  18               		.stabs	"unsigned int:t(0,4)=r(0,4);0;0177777;",128,0,0,0
  19               		.stabs	"long unsigned int:t(0,5)=@s32;r(0,5);0;037777777777;",128,0,0,0
  20               		.stabs	"long long int:t(0,6)=@s64;r(0,6);01000000000000000000000;0777777777777777777777;",128,0,0,
  21               		.stabs	"long long unsigned int:t(0,7)=@s64;r(0,7);0;01777777777777777777777;",128,0,0,0
  22               		.stabs	"short int:t(0,8)=r(0,8);-32768;32767;",128,0,0,0
  23               		.stabs	"short unsigned int:t(0,9)=r(0,9);0;0177777;",128,0,0,0
  24               		.stabs	"signed char:t(0,10)=@s8;r(0,10);-128;127;",128,0,0,0
  25               		.stabs	"unsigned char:t(0,11)=@s8;r(0,11);0;255;",128,0,0,0
  26               		.stabs	"float:t(0,12)=r(0,1);4;0;",128,0,0,0
  27               		.stabs	"double:t(0,13)=r(0,1);4;0;",128,0,0,0
  28               		.stabs	"long double:t(0,14)=r(0,1);4;0;",128,0,0,0
  29               		.stabs	"void:t(0,15)=(0,15)",128,0,0,0
  30               		.stabs	"/opt/local/lib/gcc/avr/4.0.2/../../../../avr/include/avr/io.h",130,0,0,0
  31               		.stabs	"/opt/local/lib/gcc/avr/4.0.2/../../../../avr/include/avr/sfr_defs.h",130,0,0,0
  32               		.stabs	"/opt/local/lib/gcc/avr/4.0.2/../../../../avr/include/inttypes.h",130,0,0,0
  33               		.stabs	"/opt/local/lib/gcc/avr/4.0.2/../../../../avr/include/stdint.h",130,0,0,0
  34               		.stabs	"int8_t:t(4,1)=(0,10)",128,0,116,0
  35               		.stabs	"uint8_t:t(4,2)=(0,11)",128,0,117,0
  36               		.stabs	"int16_t:t(4,3)=(0,1)",128,0,118,0
  37               		.stabs	"uint16_t:t(4,4)=(0,4)",128,0,119,0
  38               		.stabs	"int32_t:t(4,5)=(0,3)",128,0,120,0
  39               		.stabs	"uint32_t:t(4,6)=(0,5)",128,0,121,0
  40               		.stabs	"int64_t:t(4,7)=(0,6)",128,0,122,0
  41               		.stabs	"uint64_t:t(4,8)=(0,7)",128,0,123,0
  42               		.stabs	"intptr_t:t(4,9)=(4,3)",128,0,135,0
  43               		.stabs	"uintptr_t:t(4,10)=(4,4)",128,0,140,0
  44               		.stabs	"int_least8_t:t(4,11)=(4,1)",128,0,152,0
  45               		.stabs	"uint_least8_t:t(4,12)=(4,2)",128,0,157,0
  46               		.stabs	"int_least16_t:t(4,13)=(4,3)",128,0,162,0
  47               		.stabs	"uint_least16_t:t(4,14)=(4,4)",128,0,167,0
  48               		.stabs	"int_least32_t:t(4,15)=(4,5)",128,0,172,0
  49               		.stabs	"uint_least32_t:t(4,16)=(4,6)",128,0,177,0
  50               		.stabs	"int_least64_t:t(4,17)=(4,7)",128,0,182,0
  51               		.stabs	"uint_least64_t:t(4,18)=(4,8)",128,0,187,0
  52               		.stabs	"int_fast8_t:t(4,19)=(4,1)",128,0,200,0
  53               		.stabs	"uint_fast8_t:t(4,20)=(4,2)",128,0,205,0
  54               		.stabs	"int_fast16_t:t(4,21)=(4,3)",128,0,210,0
  55               		.stabs	"uint_fast16_t:t(4,22)=(4,4)",128,0,215,0
  56               		.stabs	"int_fast32_t:t(4,23)=(4,5)",128,0,220,0
  57               		.stabs	"uint_fast32_t:t(4,24)=(4,6)",128,0,225,0
GAS LISTING /var/tmp//cchOv7GV.s 			page 2


  58               		.stabs	"int_fast64_t:t(4,25)=(4,7)",128,0,230,0
  59               		.stabs	"uint_fast64_t:t(4,26)=(4,8)",128,0,235,0
  60               		.stabs	"intmax_t:t(4,27)=(4,7)",128,0,249,0
  61               		.stabs	"uintmax_t:t(4,28)=(4,8)",128,0,254,0
  62               		.stabn	162,0,0,0
  63               		.stabs	"int_farptr_t:t(3,1)=(4,5)",128,0,76,0
  64               		.stabs	"uint_farptr_t:t(3,2)=(4,6)",128,0,80,0
  65               		.stabn	162,0,0,0
  66               		.stabn	162,0,0,0
  67               		.stabn	162,0,0,0
  68               		.stabs	"/opt/local/avr/sixcode/uart.h",130,0,0,0
  69               		.stabs	"./global.h",130,0,0,0
  70               		.stabs	"/opt/local/avr/sixcode/avrlibtypes.h",130,0,0,0
  71               		.stabs	"u08:t(7,1)=(0,11)",128,0,32,0
  72               		.stabs	"s08:t(7,2)=(0,10)",128,0,33,0
  73               		.stabs	"u16:t(7,3)=(0,9)",128,0,34,0
  74               		.stabs	"s16:t(7,4)=(0,8)",128,0,35,0
  75               		.stabs	"u32:t(7,5)=(0,5)",128,0,36,0
  76               		.stabs	"s32:t(7,6)=(0,3)",128,0,37,0
  77               		.stabs	"u64:t(7,7)=(0,7)",128,0,38,0
  78               		.stabs	"s64:t(7,8)=(0,6)",128,0,39,0
  79               		.stabs	"BOOL:t(7,9)=(0,11)",128,0,69,0
  80               		.stabs	"BYTE:t(7,10)=(0,11)",128,0,70,0
  81               		.stabs	"WORD:t(7,11)=(0,4)",128,0,71,0
  82               		.stabs	"DWORD:t(7,12)=(0,5)",128,0,72,0
  83               		.stabs	"UCHAR:t(7,13)=(0,11)",128,0,74,0
  84               		.stabs	"UINT:t(7,14)=(0,4)",128,0,75,0
  85               		.stabs	"USHORT:t(7,15)=(0,9)",128,0,76,0
  86               		.stabs	"ULONG:t(7,16)=(0,5)",128,0,77,0
  87               		.stabs	"CHAR:t(7,17)=(0,2)",128,0,79,0
  88               		.stabs	"INT:t(7,18)=(0,1)",128,0,80,0
  89               		.stabs	"LONG:t(7,19)=(0,3)",128,0,81,0
  90               		.stabn	162,0,0,0
  91               		.stabn	162,0,0,0
  92               		.stabs	"/opt/local/avr/sixcode/buffer.h",130,0,0,0
  93               		.stabs	"struct_cBuffer:T(8,1)=s8dataptr:(8,2)=*(0,11),0,16;size:(0,9),16,16;datalength:(0,9),32,16
  94               		.stabs	"cBuffer:t(8,3)=(8,1)",128,0,47,0
  95               		.stabn	162,0,0,0
  96               		.stabn	162,0,0,0
  97               		.stabs	"/opt/local/avr/sixcode/rprintf.h",130,0,0,0
  98               		.stabs	"/opt/local/lib/gcc/avr/4.0.2/../../../../avr/include/avr/pgmspace.h",130,0,0,0
  99               		.stabs	"/opt/local/lib/gcc/avr/4.0.2/include/stddef.h",130,0,0,0
 100               		.stabs	"size_t:t(11,1)=(0,4)",128,0,214,0
 101               		.stabn	162,0,0,0
 102               		.stabs	"prog_void:t(10,1)=(10,2)=(10,2)",128,0,203,0
 103               		.stabs	"prog_char:t(10,3)=(10,4)=@s8;r(10,4);-128;127;",128,0,204,0
 104               		.stabs	"prog_uchar:t(10,5)=(10,6)=@s8;r(10,6);0;255;",128,0,205,0
 105               		.stabs	"prog_int8_t:t(10,7)=(10,4)",128,0,207,0
 106               		.stabs	"prog_uint8_t:t(10,8)=(10,6)",128,0,208,0
 107               		.stabs	"prog_int16_t:t(10,9)=(10,10)=(0,1)",128,0,209,0
 108               		.stabs	"prog_uint16_t:t(10,11)=(10,12)=(0,4)",128,0,210,0
 109               		.stabs	"prog_int32_t:t(10,13)=(10,14)=(0,3)",128,0,211,0
 110               		.stabs	"prog_uint32_t:t(10,15)=(10,16)=(0,5)",128,0,212,0
 111               		.stabs	"prog_int64_t:t(10,17)=(10,18)=(0,6)",128,0,213,0
 112               		.stabs	"prog_uint64_t:t(10,19)=(10,20)=(0,7)",128,0,214,0
 113               		.stabn	162,0,0,0
 114               		.stabn	162,0,0,0
GAS LISTING /var/tmp//cchOv7GV.s 			page 3


 115               		.stabs	"nmeap.h",130,0,0,0
 116               		.stabs	"nmeap_callout_t:t(12,1)=(12,2)=*(12,3)=f(0,15)",128,0,75,0
 117               		.stabs	"nmeap_sentence_parser_t:t(12,4)=(12,5)=*(12,6)=f(0,1)",128,0,87,0
 118               		.stabs	"nmeap_def.h",130,0,0,0
 119               		.stabs	"nmeap_sentence:T(13,1)=s14name:(13,2)=ar(13,3)=r(13,3);0;0177777;;0;5;(0,2),0,48;id:(0,1),
 120               		.stabs	"nmeap_sentence_t:t(13,5)=(13,1)",128,0,34,0
 121               		.stabs	"nmeap_context:T(13,6)=s718sentence:(13,7)=ar(13,3);0;7;(13,5),0,896;sentence_count:(0,1),8
 122               		.stabs	"nmeap_context_t:t(13,11)=(13,6)",128,0,70,0
 123               		.stabn	162,0,0,0
 124               		.stabs	"nmeap_gga:T(12,7)=s28latitude:(0,13),0,32;longitude:(0,13),32,32;altitude:(0,13),64,32;tim
 125               		.stabs	"nmeap_gga_t:t(12,8)=(12,7)",128,0,114,0
 126               		.stabs	"nmeap_rmc:T(12,9)=s29time:(0,5),0,32;warn:(0,2),32,8;latitude:(0,13),40,32;longitude:(0,13
 127               		.stabs	"nmeap_rmc_t:t(12,10)=(12,9)",128,0,128,0
 128               		.stabn	162,0,0,0
 129               		.stabs	"nmeap01.c",130,0,0,0
 130               		.stabs	"/opt/local/lib/gcc/avr/4.0.2/../../../../avr/include/stdio.h",130,0,0,0
 131               		.stabs	"/opt/local/lib/gcc/avr/4.0.2/include/stdarg.h",130,0,0,0
 132               		.stabs	"__gnuc_va_list:t(16,1)=(16,2)=*(0,15)",128,0,43,0
 133               		.stabs	"va_list:t(16,3)=(16,1)",128,0,105,0
 134               		.stabn	162,0,0,0
 135               		.stabs	"__file:T(15,1)=s14buf:(13,10),0,16;unget:(0,11),16,8;flags:(4,2),24,8;size:(0,1),32,16;len
 136               		.stabn	162,0,0,0
 137               		.stabs	"/opt/local/lib/gcc/avr/4.0.2/../../../../avr/include/stdlib.h",130,0,0,0
 138               		.stabs	"/opt/local/lib/gcc/avr/4.0.2/include/stddef.h",130,0,0,0
 139               		.stabs	"wchar_t:t(18,1)=(0,1)",128,0,326,0
 140               		.stabn	162,0,0,0
 141               		.stabs	"div_t:t(17,1)=(17,2)=s4quot:(0,1),0,16;rem:(0,1),16,16;;",128,0,69,0
 142               		.stabs	"ldiv_t:t(17,3)=(17,4)=s8quot:(0,3),0,32;rem:(0,3),32,32;;",128,0,75,0
 143               		.stabs	"__compar_fn_t:t(17,5)=(17,6)=*(17,7)=f(0,1)",128,0,78,0
 144               		.stabn	162,0,0,0
 145               		.stabn	162,0,0,0
 146               		.stabs	"gpsmath.c",130,0,0,0
 147               		.stabs	"./gpsmath.h",130,0,0,0
 148               		.stabs	"waypoint:T(20,1)=s8lat:(0,13),0,32;lon:(0,13),32,32;;",128,0,0,0
 149               		.stabn	162,0,0,0
 150               		.stabn	162,0,0,0
 151               		.stabs	"/opt/local/avr/sixcode/i2c.h",130,0,0,0
 152               		.stabs	" :T(21,1)=eI2C_IDLE:0,I2C_BUSY:1,I2C_MASTER_TX:2,I2C_MASTER_RX:3,I2C_SLAVE_TX:4,I2C_SLAVE_
 153               		.stabs	"eI2cStateType:t(21,2)=(21,1)",128,0,124,0
 154               		.stabn	162,0,0,0
 155               	.global	stackem_pointer
 156               	.global	stackem_pointer
 157               		.section .bss
 158               		.type	stackem_pointer, @object
 159               		.size	stackem_pointer, 1
 160               	stackem_pointer:
 161 0000 00        		.skip 1,0
 162               	.global	localBufferLength
 163               		.data
 164               		.type	localBufferLength, @object
 165               		.size	localBufferLength, 1
 166               	localBufferLength:
 167 0000 20        		.byte	32
 168               	.global	localBuffer
 169               		.type	localBuffer, @object
 170               		.size	localBuffer, 34
 171               	localBuffer:
GAS LISTING /var/tmp//cchOv7GV.s 			page 4


 172 0001 5468 6973 		.string	"This should be filling with data!"
 172      2073 686F 
 172      756C 6420 
 172      6265 2066 
 172      696C 6C69 
 173               		.text
 174               		.stabs	"nmeap_altitude:F(0,13)",36,0,152,nmeap_altitude
 175               		.stabs	"palt:P(0,16)=*(0,17)=k(0,2)",64,0,151,30
 176               		.stabs	"punits:P(0,16)",64,0,151,28
 177               	.global	nmeap_altitude
 178               		.type	nmeap_altitude, @function
 179               	nmeap_altitude:
 180               		.stabd	46,0,0
 181               		.stabs	"nmeap01.c",132,0,0,.Ltext1
 182               	.Ltext1:
   1:nmeap01.c     **** /*
   2:nmeap01.c     **** Copyright (c) 2005, David M Howard (daveh at dmh2000.com)
   3:nmeap01.c     **** All rights reserved.
   4:nmeap01.c     **** 
   5:nmeap01.c     **** This product is licensed for use and distribution under the BSD Open Source License.
   6:nmeap01.c     **** see the file COPYING for more details.
   7:nmeap01.c     **** 
   8:nmeap01.c     **** THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" 
   9:nmeap01.c     **** AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE 
  10:nmeap01.c     **** IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE 
  11:nmeap01.c     **** ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE 
  12:nmeap01.c     **** LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, 
  13:nmeap01.c     **** OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT 
  14:nmeap01.c     **** OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; 
  15:nmeap01.c     **** OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, 
  16:nmeap01.c     **** WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE 
  17:nmeap01.c     **** OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, 
  18:nmeap01.c     **** EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. 
  19:nmeap01.c     **** 
  20:nmeap01.c     **** */
  21:nmeap01.c     **** 
  22:nmeap01.c     **** /**
  23:nmeap01.c     ****  * nmeap01.c
  24:nmeap01.c     ****  * nmeap gps data parser
  25:nmeap01.c     ****  * 
  26:nmeap01.c     ****  * see the file COPYING for terms of the licnese
  27:nmeap01.c     **** */ 
  28:nmeap01.c     ****  
  29:nmeap01.c     ****  
  30:nmeap01.c     **** #include <stdio.h>
  31:nmeap01.c     **** #include <stdlib.h>
  32:nmeap01.c     **** #include <string.h>
  33:nmeap01.c     **** #include <ctype.h>
  34:nmeap01.c     **** #include "nmeap.h"#include "assert.h" 
  35:nmeap01.c     **** #include <math.h>
  36:nmeap01.c     **** 
  37:nmeap01.c     **** /* this only works if you are sure you have an upper case hex digit */
  38:nmeap01.c     **** #define HEXTOBIN(ch) ((ch <= '9') ? ch - '0' : ch - ('A' - 10))
  39:nmeap01.c     **** 
  40:nmeap01.c     **** /* forward references */
  41:nmeap01.c     **** int nmeap_init(nmeap_context_t *context,void *user_data);
  42:nmeap01.c     **** int nmeap_addParser(nmeap_context_t         *context,
GAS LISTING /var/tmp//cchOv7GV.s 			page 5


  43:nmeap01.c     **** 					 const char             *sentence_name,
  44:nmeap01.c     **** 					 nmeap_sentence_parser_t sentence_parser,
  45:nmeap01.c     **** 					 nmeap_callout_t         sentence_callout,
  46:nmeap01.c     ****                      void                  *sentence_data
  47:nmeap01.c     **** 					 );
  48:nmeap01.c     **** int nmeap_tokenize(nmeap_context_t *context);
  49:nmeap01.c     **** int nmeap_process(nmeap_context_t *context);
  50:nmeap01.c     **** int nmeap_parse(nmeap_context_t *context,char ch);
  51:nmeap01.c     **** int nmeap_parseBuffer(nmeap_context_t *context,const char *buffer,int *length);
  52:nmeap01.c     **** 
  53:nmeap01.c     **** /**
  54:nmeap01.c     ****  * get a latitude out of a pair of nmea tokens 
  55:nmeap01.c     ****  */
  56:nmeap01.c     **** double nmeap_latitude(const char *plat,const char *phem)
  57:nmeap01.c     **** {
  58:nmeap01.c     ****     double lat;
  59:nmeap01.c     ****     int    deg;
  60:nmeap01.c     ****     double min;
  61:nmeap01.c     ****     int    ns;
  62:nmeap01.c     ****     
  63:nmeap01.c     ****     assert(plat != 0);
  64:nmeap01.c     ****     assert(phem != 0);
  65:nmeap01.c     ****     
  66:nmeap01.c     ****     if (*plat == 0) {
  67:nmeap01.c     ****         return 0.0;
  68:nmeap01.c     ****     }
  69:nmeap01.c     ****     if (*phem == 0) {
  70:nmeap01.c     ****         return 0.0;
  71:nmeap01.c     ****     }
  72:nmeap01.c     ****     
  73:nmeap01.c     ****     /* north lat is +, south lat is - */
  74:nmeap01.c     ****     if (*phem == 'N') {
  75:nmeap01.c     ****         ns = 1;
  76:nmeap01.c     ****     }
  77:nmeap01.c     ****     else {
  78:nmeap01.c     ****         ns = -1;
  79:nmeap01.c     ****     }
  80:nmeap01.c     ****     
  81:nmeap01.c     ****     /* latitude is degrees, minutes, fractional minutes */
  82:nmeap01.c     ****     /* no validation is performed on the token. it better be good.*/
  83:nmeap01.c     ****     /* if it comes back 0.0 then probably the token was bad */
  84:nmeap01.c     ****     lat = atof(plat);
  85:nmeap01.c     ****     
  86:nmeap01.c     ****     /* extract the degree part */
  87:nmeap01.c     ****     deg = (int)(lat / 100.0);
  88:nmeap01.c     ****     
  89:nmeap01.c     ****     /* mask out the degrees */
  90:nmeap01.c     ****     min = lat - (deg * 100.0);
  91:nmeap01.c     ****     
  92:nmeap01.c     ****     /* compute the actual latitude in degrees.decimal-degrees */
  93:nmeap01.c     ****     lat = (deg + (min / 60.0)) * ns;
  94:nmeap01.c     ****     
  95:nmeap01.c     ****     return lat;
  96:nmeap01.c     **** }
  97:nmeap01.c     **** 
  98:nmeap01.c     **** 
  99:nmeap01.c     **** 
GAS LISTING /var/tmp//cchOv7GV.s 			page 6


 100:nmeap01.c     **** /**
 101:nmeap01.c     ****  * get a longitude out of a pair of nmea tokens 
 102:nmeap01.c     ****  */
 103:nmeap01.c     **** double nmeap_longitude(const char *plon,const char *phem)
 104:nmeap01.c     **** {
 105:nmeap01.c     ****     double lon;
 106:nmeap01.c     ****     int    deg;
 107:nmeap01.c     ****     double min;
 108:nmeap01.c     ****     int    ew;
 109:nmeap01.c     ****     
 110:nmeap01.c     ****     assert(plon != 0);
 111:nmeap01.c     ****     assert(phem != 0);
 112:nmeap01.c     ****     
 113:nmeap01.c     ****     if (*plon == 0) {
 114:nmeap01.c     ****         return 0.0;
 115:nmeap01.c     ****     }
 116:nmeap01.c     ****     if (*phem == 0) {
 117:nmeap01.c     ****         return 0.0;
 118:nmeap01.c     ****     }
 119:nmeap01.c     ****     
 120:nmeap01.c     ****     /* west long is negative, east long is positive */
 121:nmeap01.c     ****     if (*phem == 'E') {
 122:nmeap01.c     ****         ew = 1;
 123:nmeap01.c     ****     }
 124:nmeap01.c     ****     else {
 125:nmeap01.c     ****         ew = -1;
 126:nmeap01.c     ****     }
 127:nmeap01.c     ****     
 128:nmeap01.c     ****     /* longitude is degrees, minutes, fractional minutes */
 129:nmeap01.c     ****     /* no validation is performed on the token. it better be good.*/
 130:nmeap01.c     ****     /* if it comes back 0.0 then probably the token was bad */
 131:nmeap01.c     ****     lon = atof(plon);
 132:nmeap01.c     ****     
 133:nmeap01.c     ****     /* extract the degree part */
 134:nmeap01.c     ****     deg = (int)(lon / 100.0);
 135:nmeap01.c     ****     
 136:nmeap01.c     ****     /* mask out the degrees */
 137:nmeap01.c     ****     min = lon - (deg * 100.0);
 138:nmeap01.c     ****     
 139:nmeap01.c     ****     /* compute the actual lonitude in degrees.decimal-degrees */
 140:nmeap01.c     ****     lon = (deg + (min / 60.0)) * ew;
 141:nmeap01.c     **** 
 142:nmeap01.c     ****     
 143:nmeap01.c     ****     return lon;
 144:nmeap01.c     **** }
 145:nmeap01.c     **** 
 146:nmeap01.c     **** /**
 147:nmeap01.c     ****  * get an altitude longitude out of a pair of nmea tokens
 148:nmeap01.c     ****  * ALTITUDE is returned in METERS 
 149:nmeap01.c     ****  */
 150:nmeap01.c     **** double nmeap_altitude(const char *palt,const char *punits)
 151:nmeap01.c     **** {
 152:nmeap01.c     ****     double alt;
 183               		.stabn	68,0,152,.LM0-nmeap_altitude
 184               	.LM0:
 185               	/* prologue: frame size=0 */
 186 0000 CF93      		push r28
GAS LISTING /var/tmp//cchOv7GV.s 			page 7


 187 0002 DF93      		push r29
 188               	/* prologue end (size=2) */
 189 0004 FC01      		movw r30,r24
 190 0006 EB01      		movw r28,r22
 153:nmeap01.c     ****     
 154:nmeap01.c     ****     if (*palt == 0) {
 155:nmeap01.c     ****         return 0.0;
 191               		.stabn	68,0,155,.LM1-nmeap_altitude
 192               	.LM1:
 193 0008 8081      		ld r24,Z
 194 000a 8823      		tst r24
 195 000c 29F4      		brne .L2
 196               		.stabn	68,0,155,.LM2-nmeap_altitude
 197               	.LM2:
 198 000e 60E0      		ldi r22,lo8(0x0)
 199 0010 70E0      		ldi r23,hi8(0x0)
 200 0012 80E0      		ldi r24,hlo8(0x0)
 201 0014 90E0      		ldi r25,hhi8(0x0)
 202 0016 0EC0      		rjmp .L4
 203               	.L2:
 156:nmeap01.c     ****     }
 157:nmeap01.c     ****     
 158:nmeap01.c     ****     /* convert with no error checking */
 159:nmeap01.c     ****     alt = atof(palt);
 160:nmeap01.c     ****     
 204               		.stabn	68,0,160,.LM3-nmeap_altitude
 205               	.LM3:
 206 0018 CF01      		movw r24,r30
 207 001a 0E94 0000 		call atof
 161:nmeap01.c     ****     if (*punits == 'M') {
 162:nmeap01.c     ****         /* already in meters */ 
 208               		.stabn	68,0,162,.LM4-nmeap_altitude
 209               	.LM4:
 210 001e 2881      		ld r18,Y
 211 0020 2D34      		cpi r18,lo8(77)
 212 0022 41F0      		breq .L4
 163:nmeap01.c     ****     }
 164:nmeap01.c     ****     else if (*punits == 'F') {
 165:nmeap01.c     ****         /* convert to feet */
 213               		.stabn	68,0,165,.LM5-nmeap_altitude
 214               	.LM5:
 215 0024 2634      		cpi r18,lo8(70)
 216 0026 31F4      		brne .L4
 166:nmeap01.c     ****         alt = alt * 3.2808399;
 167:nmeap01.c     ****     }
 217               		.stabn	68,0,167,.LM6-nmeap_altitude
 218               	.LM6:
 219 0028 28E4      		ldi r18,lo8(0x4051f948)
 220 002a 39EF      		ldi r19,hi8(0x4051f948)
 221 002c 41E5      		ldi r20,hlo8(0x4051f948)
 222 002e 50E4      		ldi r21,hhi8(0x4051f948)
 223 0030 0E94 0000 		call __mulsf3
 224               	.L4:
 225               	/* epilogue: frame size=0 */
 226 0034 DF91      		pop r29
 227 0036 CF91      		pop r28
 228 0038 0895      		ret
GAS LISTING /var/tmp//cchOv7GV.s 			page 8


 229               	/* epilogue end (size=3) */
 230               	/* function nmeap_altitude size 29 (24) */
 231               		.size	nmeap_altitude, .-nmeap_altitude
 232               		.stabs	"alt:r(0,13)",64,0,153,22
 233               		.stabn	192,0,0,nmeap_altitude-nmeap_altitude
 234               		.stabn	224,0,0,.Lscope0-nmeap_altitude
 235               	.Lscope0:
 236               		.stabs	"",36,0,0,.Lscope0-nmeap_altitude
 237               		.stabd	78,0,0
 238               		.stabs	"nmeap_tokenize:F(0,1)",36,0,236,nmeap_tokenize
 239               		.stabs	"context:P(0,18)=*(13,11)",64,0,235,30
 240               	.global	nmeap_tokenize
 241               		.type	nmeap_tokenize, @function
 242               	nmeap_tokenize:
 243               		.stabd	46,0,0
 168:nmeap01.c     ****     
 169:nmeap01.c     ****     return alt;
 170:nmeap01.c     **** }
 171:nmeap01.c     **** 
 172:nmeap01.c     **** /**
 173:nmeap01.c     ****  * initialize an NMEA parser
 174:nmeap01.c     ****  */
 175:nmeap01.c     **** int nmeap_init(nmeap_context_t *context,void *user_data)
 176:nmeap01.c     **** {
 177:nmeap01.c     ****     assert(context != 0);
 178:nmeap01.c     **** 
 179:nmeap01.c     ****     memset(context,0,sizeof(*context));
 180:nmeap01.c     **** 
 181:nmeap01.c     ****     context->user_data = user_data;
 182:nmeap01.c     **** 
 183:nmeap01.c     ****     return 0;    
 184:nmeap01.c     **** }
 185:nmeap01.c     **** 
 186:nmeap01.c     ****  
 187:nmeap01.c     **** /**
 188:nmeap01.c     ****  * register an NMEA sentence parser
 189:nmeap01.c     ****  */
 190:nmeap01.c     **** int nmeap_addParser(nmeap_context_t         *context,
 191:nmeap01.c     **** 					 const char             *sentence_name,
 192:nmeap01.c     **** 					 nmeap_sentence_parser_t sentence_parser,
 193:nmeap01.c     **** 					 nmeap_callout_t         sentence_callout,
 194:nmeap01.c     ****                      void                  *sentence_data
 195:nmeap01.c     **** 					 )
 196:nmeap01.c     **** {
 197:nmeap01.c     ****     nmeap_sentence_t *s = 0;
 198:nmeap01.c     ****     
 199:nmeap01.c     ****     /* runtime error */
 200:nmeap01.c     ****     assert(context != 0);
 201:nmeap01.c     ****     
 202:nmeap01.c     ****     /* sentence capacity overflow */
 203:nmeap01.c     ****     if (context->sentence_count >= NMEAP_MAX_SENTENCES) {
 204:nmeap01.c     ****         return -1;
 205:nmeap01.c     ****     }
 206:nmeap01.c     ****     
 207:nmeap01.c     ****     /* point at next empty sentence buffer */
 208:nmeap01.c     ****     s = &context->sentence[context->sentence_count];
 209:nmeap01.c     ****     
GAS LISTING /var/tmp//cchOv7GV.s 			page 9


 210:nmeap01.c     ****     /* advance sentence data count */
 211:nmeap01.c     ****     context->sentence_count++;
 212:nmeap01.c     ****     
 213:nmeap01.c     ****     /* clear the sentence data */
 214:nmeap01.c     ****     memset(s,0,sizeof(*s));
 215:nmeap01.c     ****     
 216:nmeap01.c     ****     /* name */
 217:nmeap01.c     ****     strncpy(s->name,sentence_name,NMEAP_MAX_SENTENCE_NAME_LENGTH);
 218:nmeap01.c     ****     
 219:nmeap01.c     ****     /* parser */
 220:nmeap01.c     ****     s->parser = sentence_parser;
 221:nmeap01.c     ****     
 222:nmeap01.c     ****     /* callout */
 223:nmeap01.c     ****     s->callout = sentence_callout;
 224:nmeap01.c     ****     
 225:nmeap01.c     ****     /* data */
 226:nmeap01.c     ****     s->data    = sentence_data;
 227:nmeap01.c     **** 
 228:nmeap01.c     ****     return 0;
 229:nmeap01.c     **** }
 230:nmeap01.c     **** 
 231:nmeap01.c     **** /** 
 232:nmeap01.c     ****  * tokenize a buffer
 233:nmeap01.c     ****  */
 234:nmeap01.c     **** int nmeap_tokenize(nmeap_context_t *context)
 235:nmeap01.c     **** {
 236:nmeap01.c     ****     char *s;
 244               		.stabn	68,0,236,.LM7-nmeap_tokenize
 245               	.LM7:
 246               	/* prologue: frame size=0 */
 247               	/* prologue end (size=0) */
 248 003a FC01      		movw r30,r24
 237:nmeap01.c     ****     int   tokens;
 238:nmeap01.c     ****     int   state;
 239:nmeap01.c     ****     
 240:nmeap01.c     ****     /* first token is header. assume it is there */
 241:nmeap01.c     ****     tokens = 0;
 242:nmeap01.c     ****     s = context->input;
 243:nmeap01.c     ****     context->token[tokens] = s;
 249               		.stabn	68,0,243,.LM8-nmeap_tokenize
 250               	.LM8:
 251 003c DC01      		movw r26,r24
 252 003e AE58      		subi r26,lo8(-(114))
 253 0040 BF4F      		sbci r27,hi8(-(114))
 244:nmeap01.c     ****     
 254               		.stabn	68,0,244,.LM9-nmeap_tokenize
 255               	.LM9:
 256 0042 E258      		subi r30,lo8(-(382))
 257 0044 FE4F      		sbci r31,hi8(-(382))
 258 0046 A193      		st Z+,r26
 259 0048 B193      		st Z+,r27
 260 004a 41E0      		ldi r20,lo8(1)
 261 004c 50E0      		ldi r21,hi8(1)
 262 004e 20E0      		ldi r18,lo8(0)
 263 0050 30E0      		ldi r19,hi8(0)
 264 0052 19C0      		rjmp .L9
 265               	.L10:
GAS LISTING /var/tmp//cchOv7GV.s 			page 10


 245:nmeap01.c     ****     /* get rest of tokens */
 246:nmeap01.c     ****     tokens = 1;
 247:nmeap01.c     ****     state = 0;
 248:nmeap01.c     ****     while((*s != 0)&&(tokens < NMEAP_MAX_TOKENS)) {
 249:nmeap01.c     ****         switch(state) {
 250:nmeap01.c     ****         case 0:
 266               		.stabn	68,0,250,.LM10-nmeap_tokenize
 267               	.LM10:
 268 0054 2115      		cp r18,__zero_reg__
 269 0056 3105      		cpc r19,__zero_reg__
 270 0058 21F0      		breq .L12
 271 005a 2130      		cpi r18,1
 272 005c 3105      		cpc r19,__zero_reg__
 273 005e 81F4      		brne .L11
 274 0060 06C0      		rjmp .L13
 275               	.L12:
 251:nmeap01.c     ****             /* looking for end of a token */
 252:nmeap01.c     ****             if (*s == ',') {
 253:nmeap01.c     ****                 /* delimit at the comma */
 276               		.stabn	68,0,253,.LM11-nmeap_tokenize
 277               	.LM11:
 278 0062 8C32      		cpi r24,lo8(44)
 279 0064 69F4      		brne .L11
 254:nmeap01.c     ****                 *s    = 0;
 255:nmeap01.c     ****                 /* new token */
 280               		.stabn	68,0,255,.LM12-nmeap_tokenize
 281               	.LM12:
 282 0066 1C92      		st X,__zero_reg__
 283 0068 21E0      		ldi r18,lo8(1)
 284 006a 30E0      		ldi r19,hi8(1)
 285 006c 0BC0      		rjmp .L15
 286               	.L13:
 256:nmeap01.c     ****                 state = 1;
 257:nmeap01.c     ****             }
 258:nmeap01.c     ****             break;
 259:nmeap01.c     ****         case 1:
 260:nmeap01.c     ****             /* start of next token, might be another comma */
 261:nmeap01.c     ****             context->token[tokens++] = s;
 262:nmeap01.c     ****             if (*s == ',') {
 287               		.stabn	68,0,262,.LM13-nmeap_tokenize
 288               	.LM13:
 289 006e A193      		st Z+,r26
 290 0070 B193      		st Z+,r27
 291 0072 4F5F      		subi r20,lo8(-(1))
 292 0074 5F4F      		sbci r21,hi8(-(1))
 263:nmeap01.c     ****                 /* delimit at the comma */
 293               		.stabn	68,0,263,.LM14-nmeap_tokenize
 294               	.LM14:
 295 0076 8C91      		ld r24,X
 296 0078 8C32      		cpi r24,lo8(44)
 297 007a 11F4      		brne .L11
 264:nmeap01.c     ****                 *s    = 0;
 265:nmeap01.c     ****             }
 298               		.stabn	68,0,265,.LM15-nmeap_tokenize
 299               	.LM15:
 300 007c 1C92      		st X,__zero_reg__
 301 007e 02C0      		rjmp .L15
GAS LISTING /var/tmp//cchOv7GV.s 			page 11


 302               	.L11:
 303 0080 20E0      		ldi r18,lo8(0)
 304 0082 30E0      		ldi r19,hi8(0)
 305               	.L15:
 266:nmeap01.c     ****             else {   
 267:nmeap01.c     ****                 /* not a comma */
 268:nmeap01.c     ****                 state = 0;
 269:nmeap01.c     ****             }
 270:nmeap01.c     ****             break;
 271:nmeap01.c     ****         default:
 272:nmeap01.c     ****             state = 0;
 273:nmeap01.c     ****             break;
 274:nmeap01.c     ****         }
 275:nmeap01.c     ****         
 276:nmeap01.c     ****         // next character
 277:nmeap01.c     ****         s++;
 278:nmeap01.c     ****     }
 306               		.stabn	68,0,278,.LM16-nmeap_tokenize
 307               	.LM16:
 308 0084 1196      		adiw r26,1
 309               	.L9:
 310               		.stabn	68,0,249,.LM17-nmeap_tokenize
 311               	.LM17:
 312 0086 8C91      		ld r24,X
 313 0088 8823      		tst r24
 314 008a 19F0      		breq .L17
 315 008c 4831      		cpi r20,24
 316 008e 5105      		cpc r21,__zero_reg__
 317 0090 0CF3      		brlt .L10
 318               	.L17:
 279:nmeap01.c     ****     return tokens;
 280:nmeap01.c     **** }
 281:nmeap01.c     **** 
 319               		.stabn	68,0,281,.LM18-nmeap_tokenize
 320               	.LM18:
 321 0092 CA01      		movw r24,r20
 322               	/* epilogue: frame size=0 */
 323 0094 0895      		ret
 324               	/* epilogue end (size=1) */
 325               	/* function nmeap_tokenize size 46 (45) */
 326               		.size	nmeap_tokenize, .-nmeap_tokenize
 327               		.stabs	"s:r(13,10)",64,0,237,26
 328               		.stabs	"tokens:r(0,1)",64,0,238,20
 329               		.stabs	"state:r(0,1)",64,0,239,18
 330               		.stabn	192,0,0,nmeap_tokenize-nmeap_tokenize
 331               		.stabn	224,0,0,.Lscope1-nmeap_tokenize
 332               	.Lscope1:
 333               		.stabs	"",36,0,0,.Lscope1-nmeap_tokenize
 334               		.stabd	78,0,0
 335               		.stabs	"nmeap_process:F(0,1)",36,0,287,nmeap_process
 336               		.stabs	"context:P(0,18)",64,0,286,28
 337               	.global	nmeap_process
 338               		.type	nmeap_process, @function
 339               	nmeap_process:
 340               		.stabd	46,0,0
 282:nmeap01.c     **** /**
 283:nmeap01.c     ****  * process a sentence 
GAS LISTING /var/tmp//cchOv7GV.s 			page 12


 284:nmeap01.c     ****  */
 285:nmeap01.c     **** int nmeap_process(nmeap_context_t *context)
 286:nmeap01.c     **** {
 287:nmeap01.c     ****     int id = 0;
 341               		.stabn	68,0,287,.LM19-nmeap_process
 342               	.LM19:
 343               	/* prologue: frame size=0 */
 344 0096 CF92      		push r12
 345 0098 DF92      		push r13
 346 009a EF92      		push r14
 347 009c FF92      		push r15
 348 009e 0F93      		push r16
 349 00a0 1F93      		push r17
 350 00a2 CF93      		push r28
 351 00a4 DF93      		push r29
 352               	/* prologue end (size=8) */
 353 00a6 EC01      		movw r28,r24
 288:nmeap01.c     ****     int i;
 289:nmeap01.c     ****     nmeap_sentence_t *s;
 290:nmeap01.c     **** 	
 291:nmeap01.c     ****     /* copy the input to a debug buffer */
 292:nmeap01.c     ****     /* remove debug_input when everything is working. */
 293:nmeap01.c     ****     strncpy(context->debug_input,context->input,sizeof(context->debug_input));
 294:nmeap01.c     ****     
 354               		.stabn	68,0,294,.LM20-nmeap_process
 355               	.LM20:
 356 00a8 BC01      		movw r22,r24
 357 00aa 6E58      		subi r22,lo8(-(114))
 358 00ac 7F4F      		sbci r23,hi8(-(114))
 359 00ae 40E0      		ldi r20,lo8(256)
 360 00b0 51E0      		ldi r21,hi8(256)
 361 00b2 8453      		subi r24,lo8(-(460))
 362 00b4 9E4F      		sbci r25,hi8(-(460))
 363 00b6 0E94 0000 		call strncpy
 295:nmeap01.c     ****     /* tokenize the input */
 296:nmeap01.c     ****     context->tokens = nmeap_tokenize(context);
 297:nmeap01.c     ****     
 364               		.stabn	68,0,297,.LM21-nmeap_process
 365               	.LM21:
 366 00ba CE01      		movw r24,r28
 367 00bc 0E94 0000 		call nmeap_tokenize
 368 00c0 C255      		subi r28,lo8(-(430))
 369 00c2 DE4F      		sbci r29,hi8(-(430))
 370 00c4 9983      		std Y+1,r25
 371 00c6 8883      		st Y,r24
 372 00c8 CE5A      		subi r28,lo8(-(-430))
 373 00ca D140      		sbci r29,hi8(-(-430))
 374 00cc EE24      		clr r14
 375 00ce FF24      		clr r15
 376 00d0 CC24      		clr r12
 377 00d2 DD24      		clr r13
 378 00d4 8E01      		movw r16,r28
 379 00d6 1EC0      		rjmp .L21
 380               	.L22:
 298:nmeap01.c     ****     /* try to find a matching sentence parser */
 299:nmeap01.c     ****     /* this search is O(n). it has a lot of potential for optimization, at the expense of complexit
 300:nmeap01.c     ****     /* binary search instead of linear (have to keep sentences in sorted order) O(NlogN) */
GAS LISTING /var/tmp//cchOv7GV.s 			page 13


 301:nmeap01.c     ****     /* OR, when sentences are added, create a TRIE structure to find the names with a constant time
 302:nmeap01.c     ****     for(i=0;i<context->sentence_count;i++) {
 303:nmeap01.c     ****         s = &context->sentence[i];
 304:nmeap01.c     ****         assert(s != 0);
 305:nmeap01.c     ****         if (strncmp(context->input_name,s->name,5) == 0) {
 381               		.stabn	68,0,305,.LM22-nmeap_process
 382               	.LM22:
 383 00d8 0115      		cp r16,__zero_reg__
 384 00da 1105      		cpc r17,__zero_reg__
 385 00dc 09F4      		brne .L23
 386               	.L29:
 387 00de FFCF      		rjmp .L29
 388               	.L23:
 306:nmeap01.c     ****             /* found a match, call its parser */
 389               		.stabn	68,0,306,.LM23-nmeap_process
 390               	.LM23:
 391 00e0 45E0      		ldi r20,lo8(5)
 392 00e2 50E0      		ldi r21,hi8(5)
 393 00e4 B801      		movw r22,r16
 394 00e6 CE01      		movw r24,r28
 395 00e8 8A58      		subi r24,lo8(-(374))
 396 00ea 9E4F      		sbci r25,hi8(-(374))
 397 00ec 0E94 0000 		call strncmp
 398 00f0 892B      		or r24,r25
 399 00f2 59F4      		brne .L25
 307:nmeap01.c     ****             id = (*context->sentence[i].parser)(context,s);
 308:nmeap01.c     ****             if (id > 0) {
 400               		.stabn	68,0,308,.LM24-nmeap_process
 401               	.LM24:
 402 00f4 F801      		movw r30,r16
 403 00f6 2085      		ldd r18,Z+8
 404 00f8 3185      		ldd r19,Z+9
 405 00fa B801      		movw r22,r16
 406 00fc CE01      		movw r24,r28
 407 00fe F901      		movw r30,r18
 408 0100 0995      		icall
 409 0102 7C01      		movw r14,r24
 309:nmeap01.c     ****                 break;
 410               		.stabn	68,0,309,.LM25-nmeap_process
 411               	.LM25:
 412 0104 1816      		cp __zero_reg__,r24
 413 0106 1906      		cpc __zero_reg__,r25
 414 0108 74F0      		brlt .L27
 415               	.L25:
 416               		.stabn	68,0,303,.LM26-nmeap_process
 417               	.LM26:
 418 010a 0894      		sec
 419 010c C11C      		adc r12,__zero_reg__
 420 010e D11C      		adc r13,__zero_reg__
 421 0110 025F      		subi r16,lo8(-(14))
 422 0112 1F4F      		sbci r17,hi8(-(14))
 423               	.L21:
 424 0114 C059      		subi r28,lo8(-(112))
 425 0116 DF4F      		sbci r29,hi8(-(112))
 426 0118 8881      		ld r24,Y
 427 011a 9981      		ldd r25,Y+1
 428 011c C057      		subi r28,lo8(-(-112))
GAS LISTING /var/tmp//cchOv7GV.s 			page 14


 429 011e D040      		sbci r29,hi8(-(-112))
 430 0120 C816      		cp r12,r24
 431 0122 D906      		cpc r13,r25
 432 0124 CCF2      		brlt .L22
 433               	.L27:
 310:nmeap01.c     ****             }
 311:nmeap01.c     ****         }
 312:nmeap01.c     ****     }
 313:nmeap01.c     ****         
 314:nmeap01.c     ****     return id;
 315:nmeap01.c     **** }
 316:nmeap01.c     **** 
 434               		.stabn	68,0,316,.LM27-nmeap_process
 435               	.LM27:
 436 0126 C701      		movw r24,r14
 437               	/* epilogue: frame size=0 */
 438 0128 DF91      		pop r29
 439 012a CF91      		pop r28
 440 012c 1F91      		pop r17
 441 012e 0F91      		pop r16
 442 0130 FF90      		pop r15
 443 0132 EF90      		pop r14
 444 0134 DF90      		pop r13
 445 0136 CF90      		pop r12
 446 0138 0895      		ret
 447               	/* epilogue end (size=9) */
 448               	/* function nmeap_process size 82 (65) */
 449               		.size	nmeap_process, .-nmeap_process
 450               		.stabs	"id:r(0,1)",64,0,288,14
 451               		.stabs	"i:r(0,1)",64,0,289,12
 452               		.stabn	192,0,0,nmeap_process-nmeap_process
 453               		.stabn	224,0,0,.Lscope2-nmeap_process
 454               	.Lscope2:
 455               		.stabs	"",36,0,0,.Lscope2-nmeap_process
 456               		.stabd	78,0,0
 457               		.stabs	"nmeap_parse:F(0,1)",36,0,342,nmeap_parse
 458               		.stabs	"context:P(0,18)",64,0,341,28
 459               		.stabs	"ch:P(0,2)",64,0,341,13
 460               	.global	nmeap_parse
 461               		.type	nmeap_parse, @function
 462               	nmeap_parse:
 463               		.stabd	46,0,0
 317:nmeap01.c     **** /**
 318:nmeap01.c     ****                  +-5-+              +---+
 319:nmeap01.c     ****                  v   |              v   |
 320:nmeap01.c     ****  +------+       +------+           +------+         +------+         +------+
 321:nmeap01.c     ****  |   0  |--$--> |1-hdr |--alnum--> |2-data|----\r-->| 6-LF |---\n--->| done |--> 0
 322:nmeap01.c     ****  +------+       +------+           +------+         +------+         +------+
 323:nmeap01.c     ****                                     |                 ^
 324:nmeap01.c     ****                                     *                 +--------\r-------+
 325:nmeap01.c     ****                                     V                                   |
 326:nmeap01.c     ****                                  +------+           +------+         +------+
 327:nmeap01.c     ****                                  |3-cks |--xdigit-->|4-cks |-xdigit->| 5-CR |
 328:nmeap01.c     ****                                  +------+           +------+         +------+
 329:nmeap01.c     ****                                  
 330:nmeap01.c     **** return to start conditions:
 331:nmeap01.c     **** 1. buffer overflow
GAS LISTING /var/tmp//cchOv7GV.s 			page 15


 332:nmeap01.c     **** 2. invalid character for state
 333:nmeap01.c     **** 
 334:nmeap01.c     **** checksum calculation
 335:nmeap01.c     **** two hex digits represent the XOR of all characters between, but not
 336:nmeap01.c     **** including, the "$" and "*".  A checksum is required on some
 337:nmeap01.c     **** sentences.
 338:nmeap01.c     **** 
 339:nmeap01.c     **** */
 340:nmeap01.c     **** int nmeap_parse(nmeap_context_t *context,char ch)
 341:nmeap01.c     **** {
 342:nmeap01.c     ****     int status = 0;
 464               		.stabn	68,0,342,.LM28-nmeap_parse
 465               	.LM28:
 466               	/* prologue: frame size=0 */
 467 013a 8F92      		push r8
 468 013c 9F92      		push r9
 469 013e AF92      		push r10
 470 0140 BF92      		push r11
 471 0142 DF92      		push r13
 472 0144 EF92      		push r14
 473 0146 FF92      		push r15
 474 0148 0F93      		push r16
 475 014a 1F93      		push r17
 476 014c CF93      		push r28
 477 014e DF93      		push r29
 478               	/* prologue end (size=11) */
 479 0150 EC01      		movw r28,r24
 480 0152 D62E      		mov r13,r22
 343:nmeap01.c     ****     
 344:nmeap01.c     ****     /* check for input buffer overrun first to avoid duplicating code in the
 345:nmeap01.c     ****     individual states
 346:nmeap01.c     ****     */
 347:nmeap01.c     ****     if (context->input_count >= (sizeof(context->input)-1)) {
 348:nmeap01.c     ****         /* input buffer overrun, restart state machine */
 481               		.stabn	68,0,348,.LM29-nmeap_parse
 482               	.LM29:
 483 0154 92E7      		ldi r25,lo8(370)
 484 0156 892E      		mov r8,r25
 485 0158 91E0      		ldi r25,hi8(370)
 486 015a 992E      		mov r9,r25
 487 015c 8C0E      		add r8,r28
 488 015e 9D1E      		adc r9,r29
 489 0160 F401      		movw r30,r8
 490 0162 8081      		ld r24,Z
 491 0164 9181      		ldd r25,Z+1
 492 0166 8F3F      		cpi r24,255
 493 0168 9105      		cpc r25,__zero_reg__
 494 016a 40F0      		brlo .L31
 349:nmeap01.c     ****         context->input_state = 0;
 350:nmeap01.c     ****         /* reset input count */
 495               		.stabn	68,0,350,.LM30-nmeap_parse
 496               	.LM30:
 497 016c CC58      		subi r28,lo8(-(372))
 498 016e DE4F      		sbci r29,hi8(-(372))
 499 0170 1982      		std Y+1,__zero_reg__
 500 0172 1882      		st Y,__zero_reg__
 501 0174 C457      		subi r28,lo8(-(-372))
GAS LISTING /var/tmp//cchOv7GV.s 			page 16


 502 0176 D140      		sbci r29,hi8(-(-372))
 351:nmeap01.c     ****         context->input_count = 0;
 352:nmeap01.c     ****     }
 503               		.stabn	68,0,352,.LM31-nmeap_parse
 504               	.LM31:
 505 0178 1182      		std Z+1,__zero_reg__
 506 017a 1082      		st Z,__zero_reg__
 507               	.L31:
 353:nmeap01.c     ****     
 354:nmeap01.c     ****     /* store the byte */
 355:nmeap01.c     ****     context->input[context->input_count] = ch;
 356:nmeap01.c     ****     
 508               		.stabn	68,0,356,.LM32-nmeap_parse
 509               	.LM32:
 510 017c F401      		movw r30,r8
 511 017e 8081      		ld r24,Z
 512 0180 9181      		ldd r25,Z+1
 513 0182 8C01      		movw r16,r24
 514 0184 0C0F      		add r16,r28
 515 0186 1D1F      		adc r17,r29
 516 0188 0E58      		subi r16,lo8(-(114))
 517 018a 1F4F      		sbci r17,hi8(-(114))
 518 018c F801      		movw r30,r16
 519 018e D082      		st Z,r13
 520 0190 0257      		subi r16,lo8(-(-114))
 521 0192 1040      		sbci r17,hi8(-(-114))
 357:nmeap01.c     ****     /* next buffer position */
 358:nmeap01.c     ****     context->input_count++;
 359:nmeap01.c     ****     
 522               		.stabn	68,0,359,.LM33-nmeap_parse
 523               	.LM33:
 524 0194 7C01      		movw r14,r24
 525 0196 0894      		sec
 526 0198 E11C      		adc r14,__zero_reg__
 527 019a F11C      		adc r15,__zero_reg__
 528 019c F401      		movw r30,r8
 529 019e F182      		std Z+1,r15
 530 01a0 E082      		st Z,r14
 360:nmeap01.c     ****     /* run it through the lexical scanner */
 361:nmeap01.c     ****     switch(context->input_state) {
 362:nmeap01.c     ****     /* LOOKING FOR $ */
 531               		.stabn	68,0,362,.LM34-nmeap_parse
 532               	.LM34:
 533 01a2 84E7      		ldi r24,lo8(372)
 534 01a4 A82E      		mov r10,r24
 535 01a6 81E0      		ldi r24,hi8(372)
 536 01a8 B82E      		mov r11,r24
 537 01aa AC0E      		add r10,r28
 538 01ac BD1E      		adc r11,r29
 539 01ae F501      		movw r30,r10
 540 01b0 8081      		ld r24,Z
 541 01b2 9181      		ldd r25,Z+1
 542 01b4 8330      		cpi r24,3
 543 01b6 9105      		cpc r25,__zero_reg__
 544 01b8 09F4      		brne .+2
 545 01ba 5EC0      		rjmp .L37
 546 01bc 8430      		cpi r24,4
GAS LISTING /var/tmp//cchOv7GV.s 			page 17


 547 01be 9105      		cpc r25,__zero_reg__
 548 01c0 54F4      		brge .L41
 549 01c2 8130      		cpi r24,1
 550 01c4 9105      		cpc r25,__zero_reg__
 551 01c6 29F1      		breq .L35
 552 01c8 8230      		cpi r24,2
 553 01ca 9105      		cpc r25,__zero_reg__
 554 01cc 0CF0      		brlt .+2
 555 01ce 3FC0      		rjmp .L36
 556 01d0 892B      		or r24,r25
 557 01d2 69F0      		breq .L34
 558 01d4 06C1      		rjmp .L33
 559               	.L41:
 560 01d6 8530      		cpi r24,5
 561 01d8 9105      		cpc r25,__zero_reg__
 562 01da 09F4      		brne .+2
 563 01dc A2C0      		rjmp .L39
 564 01de 8530      		cpi r24,5
 565 01e0 9105      		cpc r25,__zero_reg__
 566 01e2 0CF4      		brge .+2
 567 01e4 66C0      		rjmp .L38
 568 01e6 0697      		sbiw r24,6
 569 01e8 09F0      		breq .+2
 570 01ea FBC0      		rjmp .L33
 571 01ec A4C0      		rjmp .L40
 572               	.L34:
 363:nmeap01.c     ****     case 0:
 364:nmeap01.c     ****         if (ch == '$') {
 365:nmeap01.c     ****             /*look for id */
 573               		.stabn	68,0,365,.LM35-nmeap_parse
 574               	.LM35:
 575 01ee F4E2      		ldi r31,lo8(36)
 576 01f0 DF16      		cp r13,r31
 577 01f2 59F4      		brne .L42
 366:nmeap01.c     ****             context->input_state = 1;
 367:nmeap01.c     ****             context->ccks        = 0;
 578               		.stabn	68,0,367,.LM36-nmeap_parse
 579               	.LM36:
 580 01f4 81E0      		ldi r24,lo8(1)
 581 01f6 90E0      		ldi r25,hi8(1)
 582 01f8 F501      		movw r30,r10
 583 01fa 9183      		std Z+1,r25
 584 01fc 8083      		st Z,r24
 368:nmeap01.c     **** 			context->icks        = 0;
 585               		.stabn	68,0,368,.LM37-nmeap_parse
 586               	.LM37:
 587 01fe C358      		subi r28,lo8(-(381))
 588 0200 DE4F      		sbci r29,hi8(-(381))
 589 0202 1882      		st Y,__zero_reg__
 369:nmeap01.c     ****         }
 590               		.stabn	68,0,369,.LM38-nmeap_parse
 591               	.LM38:
 592 0204 FE01      		movw r30,r28
 593 0206 1292      		st -Z,__zero_reg__
 594 0208 FEC0      		rjmp .L74
 595               	.L42:
 370:nmeap01.c     ****         else {
GAS LISTING /var/tmp//cchOv7GV.s 			page 18


 371:nmeap01.c     ****             /* header error, start over */
 372:nmeap01.c     ****             context->err_hdr++;
 373:nmeap01.c     ****             context->input_state = 0;
 596               		.stabn	68,0,373,.LM39-nmeap_parse
 597               	.LM39:
 598 020a FE01      		movw r30,r28
 599 020c EC54      		subi r30,lo8(-(436))
 600 020e FE4F      		sbci r31,hi8(-(436))
 601 0210 D6C0      		rjmp .L75
 602               	.L35:
 374:nmeap01.c     ****             context->input_count = 0;
 375:nmeap01.c     ****         }
 376:nmeap01.c     ****         break;
 377:nmeap01.c     ****     /* LOOKING FOR 5 CHARACTER SENTENCE ID */
 378:nmeap01.c     ****     case 1:
 379:nmeap01.c     ****         /* allow numbers even though it isn't usually done */
 380:nmeap01.c     ****         /* a proprietary id might have a numeral */
 381:nmeap01.c     ****         if (isalnum(ch)) {
 382:nmeap01.c     ****             /* store name separately */
 603               		.stabn	68,0,382,.LM40-nmeap_parse
 604               	.LM40:
 605 0212 8D2D      		mov r24,r13
 606 0214 9927      		clr r25
 607 0216 87FD      		sbrc r24,7
 608 0218 9095      		com r25
 609 021a 0E94 0000 		call isalnum
 610 021e 892B      		or r24,r25
 611 0220 91F0      		breq .L45
 383:nmeap01.c     ****             context->input_name[context->input_count - 2] = ch;
 384:nmeap01.c     ****             /* checksum */
 612               		.stabn	68,0,384,.LM41-nmeap_parse
 613               	.LM41:
 614 0222 0B58      		subi r16,lo8(-(373))
 615 0224 1E4F      		sbci r17,hi8(-(373))
 616 0226 F801      		movw r30,r16
 617 0228 D082      		st Z,r13
 385:nmeap01.c     ****             context->ccks ^= ch;
 386:nmeap01.c     ****             /* end of header? */
 618               		.stabn	68,0,386,.LM42-nmeap_parse
 619               	.LM42:
 620 022a FE01      		movw r30,r28
 621 022c E358      		subi r30,lo8(-(381))
 622 022e FE4F      		sbci r31,hi8(-(381))
 623 0230 8081      		ld r24,Z
 624 0232 8D25      		eor r24,r13
 625 0234 8083      		st Z,r24
 387:nmeap01.c     ****             if (context->input_count >= 6) {
 388:nmeap01.c     ****                 /* yes, get body */
 626               		.stabn	68,0,388,.LM43-nmeap_parse
 627               	.LM43:
 628 0236 F6E0      		ldi r31,lo8(6)
 629 0238 EF16      		cp r14,r31
 630 023a F104      		cpc r15,__zero_reg__
 631 023c 0CF4      		brge .+2
 632 023e E3C0      		rjmp .L74
 389:nmeap01.c     ****                 context->input_state = 2;
 390:nmeap01.c     ****             }
GAS LISTING /var/tmp//cchOv7GV.s 			page 19


 633               		.stabn	68,0,390,.LM44-nmeap_parse
 634               	.LM44:
 635 0240 82E0      		ldi r24,lo8(2)
 636 0242 90E0      		ldi r25,hi8(2)
 637 0244 74C0      		rjmp .L76
 638               	.L45:
 391:nmeap01.c     ****         }
 392:nmeap01.c     ****         else {
 393:nmeap01.c     ****             /* bad character, start over */
 394:nmeap01.c     ****             context->err_id++;
 395:nmeap01.c     ****             context->input_state = 0;
 639               		.stabn	68,0,395,.LM45-nmeap_parse
 640               	.LM45:
 641 0246 FE01      		movw r30,r28
 642 0248 E054      		subi r30,lo8(-(448))
 643 024a FE4F      		sbci r31,hi8(-(448))
 644 024c B8C0      		rjmp .L75
 645               	.L36:
 396:nmeap01.c     ****             context->input_count = 0;
 397:nmeap01.c     ****         }
 398:nmeap01.c     ****         break;
 399:nmeap01.c     ****     /* LOOKING FOR CR OR CHECKSUM INDICATOR */
 400:nmeap01.c     ****     case 2:
 401:nmeap01.c     ****         if (ch == '*') {
 402:nmeap01.c     ****             /* this sentence has a checksum */
 646               		.stabn	68,0,402,.LM46-nmeap_parse
 647               	.LM46:
 648 024e FAE2      		ldi r31,lo8(42)
 649 0250 DF16      		cp r13,r31
 650 0252 19F4      		brne .L49
 403:nmeap01.c     ****             context->input_state = 3;
 404:nmeap01.c     ****         }
 651               		.stabn	68,0,404,.LM47-nmeap_parse
 652               	.LM47:
 653 0254 83E0      		ldi r24,lo8(3)
 654 0256 90E0      		ldi r25,hi8(3)
 655 0258 6AC0      		rjmp .L76
 656               	.L49:
 657 025a FE01      		movw r30,r28
 658 025c E358      		subi r30,lo8(-(381))
 659 025e FE4F      		sbci r31,hi8(-(381))
 405:nmeap01.c     ****         else if (ch == '\r') {
 406:nmeap01.c     ****             /* carriage return, no checksum, force a match */
 660               		.stabn	68,0,406,.LM48-nmeap_parse
 661               	.LM48:
 662 0260 8DE0      		ldi r24,lo8(13)
 663 0262 D816      		cp r13,r24
 664 0264 29F4      		brne .L51
 407:nmeap01.c     **** 			context->icks = 0;
 408:nmeap01.c     **** 			context->ccks = 0;
 665               		.stabn	68,0,408,.LM49-nmeap_parse
 666               	.LM49:
 667 0266 C458      		subi r28,lo8(-(380))
 668 0268 DE4F      		sbci r29,hi8(-(380))
 669 026a 1882      		st Y,__zero_reg__
 409:nmeap01.c     ****             context->input_state = 6;
 670               		.stabn	68,0,409,.LM50-nmeap_parse
GAS LISTING /var/tmp//cchOv7GV.s 			page 20


 671               	.LM50:
 672 026c 1082      		st Z,__zero_reg__
 673 026e 5DC0      		rjmp .L77
 674               	.L51:
 410:nmeap01.c     ****         }
 411:nmeap01.c     ****         else {
 412:nmeap01.c     ****             /* continue accumulating data */
 413:nmeap01.c     ****             /* checksum */
 414:nmeap01.c     ****             context->ccks ^= ch;
 415:nmeap01.c     ****         }
 675               		.stabn	68,0,415,.LM51-nmeap_parse
 676               	.LM51:
 677 0270 8081      		ld r24,Z
 678 0272 8D25      		eor r24,r13
 679 0274 8083      		st Z,r24
 680 0276 C7C0      		rjmp .L74
 681               	.L37:
 416:nmeap01.c     ****         break;
 417:nmeap01.c     ****     /* LOOKING FOR FIRST CHECKSUM CHARACTER */
 418:nmeap01.c     ****     case 3:
 419:nmeap01.c     ****         /* must be upper case hex digit */
 420:nmeap01.c     ****         if (isxdigit(ch) && (ch <= 'F')) {
 421:nmeap01.c     ****             /* got first checksum byte */
 682               		.stabn	68,0,421,.LM52-nmeap_parse
 683               	.LM52:
 684 0278 0D2D      		mov r16,r13
 685 027a 1127      		clr r17
 686 027c 07FD      		sbrc r16,7
 687 027e 1095      		com r17
 688 0280 C801      		movw r24,r16
 689 0282 0E94 0000 		call isxdigit
 690 0286 892B      		or r24,r25
 691 0288 B1F1      		breq .L59
 692 028a F6E4      		ldi r31,lo8(70)
 693 028c FD15      		cp r31,r13
 694 028e 9CF1      		brlt .L59
 422:nmeap01.c     ****             context->input_state = 4;
 423:nmeap01.c     ****             context->icks = HEXTOBIN(ch) << 4;
 695               		.stabn	68,0,423,.LM53-nmeap_parse
 696               	.LM53:
 697 0290 84E0      		ldi r24,lo8(4)
 698 0292 90E0      		ldi r25,hi8(4)
 699 0294 F501      		movw r30,r10
 700 0296 9183      		std Z+1,r25
 701 0298 8083      		st Z,r24
 424:nmeap01.c     ****         }
 702               		.stabn	68,0,424,.LM54-nmeap_parse
 703               	.LM54:
 704 029a F9E3      		ldi r31,lo8(57)
 705 029c FD15      		cp r31,r13
 706 029e 14F4      		brge .L73
 707 02a0 0753      		subi r16,lo8(-(-55))
 708 02a2 1040      		sbci r17,hi8(-(-55))
 709               	.L73:
 710 02a4 802F      		mov r24,r16
 711 02a6 8295      		swap r24
 712 02a8 807F      		andi r24,0xf0
GAS LISTING /var/tmp//cchOv7GV.s 			page 21


 713 02aa C458      		subi r28,lo8(-(380))
 714 02ac DE4F      		sbci r29,hi8(-(380))
 715 02ae 8883      		st Y,r24
 716 02b0 AAC0      		rjmp .L74
 717               	.L38:
 425:nmeap01.c     ****         else {
 426:nmeap01.c     ****             /* input error, restart */
 427:nmeap01.c     ****             context->err_cks++;
 428:nmeap01.c     ****             context->input_state = 0;
 429:nmeap01.c     ****             context->input_count = 0;
 430:nmeap01.c     ****         }
 431:nmeap01.c     ****         break;
 432:nmeap01.c     ****         /* LOOKING FOR SECOND CHECKSUM CHARACTER */
 433:nmeap01.c     ****     case 4:
 434:nmeap01.c     ****         /* must be upper case hex digit */
 435:nmeap01.c     ****         if (isxdigit(ch) && (ch <= 'F')) {
 436:nmeap01.c     ****             /* got second checksum byte */
 718               		.stabn	68,0,436,.LM55-nmeap_parse
 719               	.LM55:
 720 02b2 8D2D      		mov r24,r13
 721 02b4 9927      		clr r25
 722 02b6 87FD      		sbrc r24,7
 723 02b8 9095      		com r25
 724 02ba 0E94 0000 		call isxdigit
 725 02be 892B      		or r24,r25
 726 02c0 D1F0      		breq .L59
 727 02c2 86E4      		ldi r24,lo8(70)
 728 02c4 8D15      		cp r24,r13
 729 02c6 BCF0      		brlt .L59
 437:nmeap01.c     ****             context->input_state = 5;
 438:nmeap01.c     ****             context->icks += HEXTOBIN(ch);
 730               		.stabn	68,0,438,.LM56-nmeap_parse
 731               	.LM56:
 732 02c8 85E0      		ldi r24,lo8(5)
 733 02ca 90E0      		ldi r25,hi8(5)
 734 02cc F501      		movw r30,r10
 735 02ce 9183      		std Z+1,r25
 736 02d0 8083      		st Z,r24
 439:nmeap01.c     ****         }
 737               		.stabn	68,0,439,.LM57-nmeap_parse
 738               	.LM57:
 739 02d2 C458      		subi r28,lo8(-(380))
 740 02d4 DE4F      		sbci r29,hi8(-(380))
 741 02d6 2881      		ld r18,Y
 742 02d8 CC57      		subi r28,lo8(-(-380))
 743 02da D140      		sbci r29,hi8(-(-380))
 744 02dc F9E3      		ldi r31,lo8(57)
 745 02de FD15      		cp r31,r13
 746 02e0 1CF0      		brlt .L62
 747 02e2 6D2D      		mov r22,r13
 748 02e4 6053      		subi r22,lo8(-(-48))
 749 02e6 02C0      		rjmp .L64
 750               	.L62:
 751 02e8 6D2D      		mov r22,r13
 752 02ea 6753      		subi r22,lo8(-(-55))
 753               	.L64:
 754 02ec C458      		subi r28,lo8(-(380))
GAS LISTING /var/tmp//cchOv7GV.s 			page 22


 755 02ee DE4F      		sbci r29,hi8(-(380))
 756 02f0 260F      		add r18,r22
 757 02f2 2883      		st Y,r18
 758 02f4 88C0      		rjmp .L74
 759               	.L59:
 440:nmeap01.c     ****         else {
 441:nmeap01.c     ****             /* input error, restart */
 442:nmeap01.c     ****             context->err_cks++;
 443:nmeap01.c     ****             context->input_state = 0;
 760               		.stabn	68,0,443,.LM58-nmeap_parse
 761               	.LM58:
 762 02f6 FE01      		movw r30,r28
 763 02f8 EC53      		subi r30,lo8(-(452))
 764 02fa FE4F      		sbci r31,hi8(-(452))
 765 02fc 8081      		ld r24,Z
 766 02fe 9181      		ldd r25,Z+1
 767 0300 A281      		ldd r26,Z+2
 768 0302 B381      		ldd r27,Z+3
 769 0304 0196      		adiw r24,1
 770 0306 A11D      		adc r26,__zero_reg__
 771 0308 B11D      		adc r27,__zero_reg__
 772 030a 8083      		st Z,r24
 773 030c 9183      		std Z+1,r25
 774 030e A283      		std Z+2,r26
 775 0310 B383      		std Z+3,r27
 444:nmeap01.c     ****             context->input_count = 0;
 776               		.stabn	68,0,444,.LM59-nmeap_parse
 777               	.LM59:
 778 0312 CC58      		subi r28,lo8(-(372))
 779 0314 DE4F      		sbci r29,hi8(-(372))
 780 0316 1982      		std Y+1,__zero_reg__
 781 0318 1882      		st Y,__zero_reg__
 445:nmeap01.c     ****         }
 782               		.stabn	68,0,445,.LM60-nmeap_parse
 783               	.LM60:
 784 031a FE01      		movw r30,r28
 785 031c 1292      		st -Z,__zero_reg__
 786 031e 1292      		st -Z,__zero_reg__
 787 0320 72C0      		rjmp .L74
 788               	.L39:
 446:nmeap01.c     ****         break;
 447:nmeap01.c     ****     /* LOOKING FOR CR */
 448:nmeap01.c     ****     case 5:
 449:nmeap01.c     ****         if (ch == '\r') {
 450:nmeap01.c     ****             /* carriage return */
 789               		.stabn	68,0,450,.LM61-nmeap_parse
 790               	.LM61:
 791 0322 8DE0      		ldi r24,lo8(13)
 792 0324 D816      		cp r13,r24
 793 0326 09F0      		breq .+2
 794 0328 47C0      		rjmp .L67
 795               	.L77:
 451:nmeap01.c     ****             context->input_state = 6;
 452:nmeap01.c     ****         }
 796               		.stabn	68,0,452,.LM62-nmeap_parse
 797               	.LM62:
 798 032a 86E0      		ldi r24,lo8(6)
GAS LISTING /var/tmp//cchOv7GV.s 			page 23


 799 032c 90E0      		ldi r25,hi8(6)
 800               	.L76:
 801 032e F501      		movw r30,r10
 802 0330 9183      		std Z+1,r25
 803 0332 8083      		st Z,r24
 804 0334 68C0      		rjmp .L74
 805               	.L40:
 453:nmeap01.c     ****         else {
 454:nmeap01.c     ****             /* input error, restart */
 455:nmeap01.c     ****             context->err_crl++;
 456:nmeap01.c     ****             context->input_state = 0;
 457:nmeap01.c     ****             context->input_count = 0;
 458:nmeap01.c     ****         }
 459:nmeap01.c     ****         break;
 460:nmeap01.c     ****     /* LOOKING FOR LINE FEED */
 461:nmeap01.c     ****     case 6:
 462:nmeap01.c     ****         if (ch == '\n') {
 463:nmeap01.c     ****             /* linefeed, line complete */
 806               		.stabn	68,0,463,.LM63-nmeap_parse
 807               	.LM63:
 808 0336 FAE0      		ldi r31,lo8(10)
 809 0338 DF16      		cp r13,r31
 810 033a F1F5      		brne .L67
 464:nmeap01.c     ****             
 465:nmeap01.c     ****             /* delimit buffer */
 466:nmeap01.c     ****             context->input[context->input_count] = 0;
 467:nmeap01.c     ****             
 811               		.stabn	68,0,467,.LM64-nmeap_parse
 812               	.LM64:
 813 033c EC0E      		add r14,r28
 814 033e FD1E      		adc r15,r29
 815 0340 82E7      		ldi r24,lo8(114)
 816 0342 90E0      		ldi r25,hi8(114)
 817 0344 E80E      		add r14,r24
 818 0346 F91E      		adc r15,r25
 819 0348 F701      		movw r30,r14
 820 034a 1082      		st Z,__zero_reg__
 468:nmeap01.c     ****             /* if the checksums match, process the sentence */
 469:nmeap01.c     **** 			if (context->ccks == context->icks) {
 470:nmeap01.c     **** 				/* process */
 821               		.stabn	68,0,470,.LM65-nmeap_parse
 822               	.LM65:
 823 034c FE01      		movw r30,r28
 824 034e E358      		subi r30,lo8(-(381))
 825 0350 FE4F      		sbci r31,hi8(-(381))
 826 0352 C458      		subi r28,lo8(-(380))
 827 0354 DE4F      		sbci r29,hi8(-(380))
 828 0356 9081      		ld r25,Z
 829 0358 8881      		ld r24,Y
 830 035a CC57      		subi r28,lo8(-(-380))
 831 035c D140      		sbci r29,hi8(-(-380))
 832 035e 9817      		cp r25,r24
 833 0360 99F4      		brne .L69
 471:nmeap01.c     **** 				status = nmeap_process(context);
 472:nmeap01.c     **** 				
 834               		.stabn	68,0,472,.LM66-nmeap_parse
 835               	.LM66:
GAS LISTING /var/tmp//cchOv7GV.s 			page 24


 836 0362 CE01      		movw r24,r28
 837 0364 0E94 0000 		call nmeap_process
 838 0368 9C01      		movw r18,r24
 473:nmeap01.c     **** 				/* count good messages */
 474:nmeap01.c     **** 				context->msgs++;
 475:nmeap01.c     **** 			}
 839               		.stabn	68,0,475,.LM67-nmeap_parse
 840               	.LM67:
 841 036a FE01      		movw r30,r28
 842 036c E055      		subi r30,lo8(-(432))
 843 036e FE4F      		sbci r31,hi8(-(432))
 844 0370 8081      		ld r24,Z
 845 0372 9181      		ldd r25,Z+1
 846 0374 A281      		ldd r26,Z+2
 847 0376 B381      		ldd r27,Z+3
 848 0378 0196      		adiw r24,1
 849 037a A11D      		adc r26,__zero_reg__
 850 037c B11D      		adc r27,__zero_reg__
 851 037e 8083      		st Z,r24
 852 0380 9183      		std Z+1,r25
 853 0382 A283      		std Z+2,r26
 854 0384 B383      		std Z+3,r27
 855 0386 10C0      		rjmp .L71
 856               	.L69:
 476:nmeap01.c     **** 			else {
 477:nmeap01.c     **** 				/* count checksum errors */
 478:nmeap01.c     **** 				context->err_cks++;
 479:nmeap01.c     **** 			}
 857               		.stabn	68,0,479,.LM68-nmeap_parse
 858               	.LM68:
 859 0388 FE01      		movw r30,r28
 860 038a EC53      		subi r30,lo8(-(452))
 861 038c FE4F      		sbci r31,hi8(-(452))
 862 038e 8081      		ld r24,Z
 863 0390 9181      		ldd r25,Z+1
 864 0392 A281      		ldd r26,Z+2
 865 0394 B381      		ldd r27,Z+3
 866 0396 0196      		adiw r24,1
 867 0398 A11D      		adc r26,__zero_reg__
 868 039a B11D      		adc r27,__zero_reg__
 869 039c 8083      		st Z,r24
 870 039e 9183      		std Z+1,r25
 871 03a0 A283      		std Z+2,r26
 872 03a2 B383      		std Z+3,r27
 873 03a4 20E0      		ldi r18,lo8(0)
 874 03a6 30E0      		ldi r19,hi8(0)
 875               	.L71:
 480:nmeap01.c     ****             
 481:nmeap01.c     ****             /* restart next time */
 482:nmeap01.c     ****             context->input_state = 0;
 483:nmeap01.c     ****             context->input_count = 0;
 876               		.stabn	68,0,483,.LM69-nmeap_parse
 877               	.LM69:
 878 03a8 CC58      		subi r28,lo8(-(372))
 879 03aa DE4F      		sbci r29,hi8(-(372))
 880 03ac 1982      		std Y+1,__zero_reg__
 881 03ae 1882      		st Y,__zero_reg__
GAS LISTING /var/tmp//cchOv7GV.s 			page 25


 484:nmeap01.c     ****         }
 882               		.stabn	68,0,484,.LM70-nmeap_parse
 883               	.LM70:
 884 03b0 FE01      		movw r30,r28
 885 03b2 1292      		st -Z,__zero_reg__
 886 03b4 1292      		st -Z,__zero_reg__
 887 03b6 29C0      		rjmp .L44
 888               	.L67:
 485:nmeap01.c     ****         else {
 486:nmeap01.c     ****             /* input error, restart */
 487:nmeap01.c     ****             context->err_crl++;
 488:nmeap01.c     ****             context->input_state = 0;
 889               		.stabn	68,0,488,.LM71-nmeap_parse
 890               	.LM71:
 891 03b8 FE01      		movw r30,r28
 892 03ba E853      		subi r30,lo8(-(456))
 893 03bc FE4F      		sbci r31,hi8(-(456))
 894               	.L75:
 895 03be 8081      		ld r24,Z
 896 03c0 9181      		ldd r25,Z+1
 897 03c2 A281      		ldd r26,Z+2
 898 03c4 B381      		ldd r27,Z+3
 899 03c6 0196      		adiw r24,1
 900 03c8 A11D      		adc r26,__zero_reg__
 901 03ca B11D      		adc r27,__zero_reg__
 902 03cc 8083      		st Z,r24
 903 03ce 9183      		std Z+1,r25
 904 03d0 A283      		std Z+2,r26
 905 03d2 B383      		std Z+3,r27
 489:nmeap01.c     ****             context->input_count = 0;
 906               		.stabn	68,0,489,.LM72-nmeap_parse
 907               	.LM72:
 908 03d4 F501      		movw r30,r10
 909 03d6 1182      		std Z+1,__zero_reg__
 910 03d8 1082      		st Z,__zero_reg__
 490:nmeap01.c     ****         }
 911               		.stabn	68,0,490,.LM73-nmeap_parse
 912               	.LM73:
 913 03da F401      		movw r30,r8
 914 03dc 1182      		std Z+1,__zero_reg__
 915 03de 1082      		st Z,__zero_reg__
 916 03e0 12C0      		rjmp .L74
 917               	.L33:
 491:nmeap01.c     ****         break;
 492:nmeap01.c     ****     default:
 493:nmeap01.c     ****         context->err_unk++;
 494:nmeap01.c     ****         context->input_state = 0;
 918               		.stabn	68,0,494,.LM74-nmeap_parse
 919               	.LM74:
 920 03e2 FE01      		movw r30,r28
 921 03e4 E454      		subi r30,lo8(-(444))
 922 03e6 FE4F      		sbci r31,hi8(-(444))
 923 03e8 8081      		ld r24,Z
 924 03ea 9181      		ldd r25,Z+1
 925 03ec A281      		ldd r26,Z+2
 926 03ee B381      		ldd r27,Z+3
 927 03f0 0196      		adiw r24,1
GAS LISTING /var/tmp//cchOv7GV.s 			page 26


 928 03f2 A11D      		adc r26,__zero_reg__
 929 03f4 B11D      		adc r27,__zero_reg__
 930 03f6 8083      		st Z,r24
 931 03f8 9183      		std Z+1,r25
 932 03fa A283      		std Z+2,r26
 933 03fc B383      		std Z+3,r27
 495:nmeap01.c     ****         break;
 934               		.stabn	68,0,495,.LM75-nmeap_parse
 935               	.LM75:
 936 03fe CC58      		subi r28,lo8(-(372))
 937 0400 DE4F      		sbci r29,hi8(-(372))
 938 0402 1982      		std Y+1,__zero_reg__
 939 0404 1882      		st Y,__zero_reg__
 940               	.L74:
 941 0406 20E0      		ldi r18,lo8(0)
 942 0408 30E0      		ldi r19,hi8(0)
 943               	.L44:
 496:nmeap01.c     ****     }
 497:nmeap01.c     ****             
 498:nmeap01.c     **** 	return status;
 499:nmeap01.c     **** }
 500:nmeap01.c     **** 
 944               		.stabn	68,0,500,.LM76-nmeap_parse
 945               	.LM76:
 946 040a C901      		movw r24,r18
 947               	/* epilogue: frame size=0 */
 948 040c DF91      		pop r29
 949 040e CF91      		pop r28
 950 0410 1F91      		pop r17
 951 0412 0F91      		pop r16
 952 0414 FF90      		pop r15
 953 0416 EF90      		pop r14
 954 0418 DF90      		pop r13
 955 041a BF90      		pop r11
 956 041c AF90      		pop r10
 957 041e 9F90      		pop r9
 958 0420 8F90      		pop r8
 959 0422 0895      		ret
 960               	/* epilogue end (size=12) */
 961               	/* function nmeap_parse size 374 (351) */
 962               		.size	nmeap_parse, .-nmeap_parse
 963               		.stabs	"status:r(0,1)",64,0,343,18
 964               		.stabn	192,0,0,nmeap_parse-nmeap_parse
 965               		.stabn	224,0,0,.Lscope3-nmeap_parse
 966               	.Lscope3:
 967               		.stabs	"",36,0,0,.Lscope3-nmeap_parse
 968               		.stabd	78,0,0
 969               		.stabs	"nmeap_parseBuffer:F(0,1)",36,0,506,nmeap_parseBuffer
 970               		.stabs	"context:P(0,18)",64,0,505,8
 971               		.stabs	"buffer:P(0,16)",64,0,505,22
 972               		.stabs	"length:P(0,19)=*(0,1)",64,0,505,12
 973               	.global	nmeap_parseBuffer
 974               		.type	nmeap_parseBuffer, @function
 975               	nmeap_parseBuffer:
 976               		.stabd	46,0,0
 501:nmeap01.c     **** /** 
 502:nmeap01.c     ****  * parse a buffer of nmea data
GAS LISTING /var/tmp//cchOv7GV.s 			page 27


 503:nmeap01.c     ****  */
 504:nmeap01.c     **** int nmeap_parseBuffer(nmeap_context_t *context,const char *buffer,int *length)
 505:nmeap01.c     **** {
 506:nmeap01.c     ****     int  i;
 977               		.stabn	68,0,506,.LM77-nmeap_parseBuffer
 978               	.LM77:
 979               	/* prologue: frame size=0 */
 980 0424 8F92      		push r8
 981 0426 9F92      		push r9
 982 0428 AF92      		push r10
 983 042a BF92      		push r11
 984 042c CF92      		push r12
 985 042e DF92      		push r13
 986 0430 EF92      		push r14
 987 0432 FF92      		push r15
 988 0434 0F93      		push r16
 989 0436 1F93      		push r17
 990 0438 CF93      		push r28
 991 043a DF93      		push r29
 992               	/* prologue end (size=12) */
 993 043c 4C01      		movw r8,r24
 994 043e 6A01      		movw r12,r20
 507:nmeap01.c     ****     int  status;
 508:nmeap01.c     ****     int  rem;
 509:nmeap01.c     ****     int  tlen;
 510:nmeap01.c     ****     
 511:nmeap01.c     ****     tlen   = *length;
 512:nmeap01.c     ****     rem    = *length;
 995               		.stabn	68,0,512,.LM78-nmeap_parseBuffer
 996               	.LM78:
 997 0440 FA01      		movw r30,r20
 998 0442 0081      		ld r16,Z
 999 0444 1181      		ldd r17,Z+1
 1000 0446 5801      		movw r10,r16
 1001 0448 EE24      		clr r14
 1002 044a FF24      		clr r15
 1003 044c EB01      		movw r28,r22
 1004 044e 0CC0      		rjmp .L79
 1005               	.L80:
 513:nmeap01.c     ****     status = 0;
 514:nmeap01.c     ****     /* for each byte in the buffer */
 515:nmeap01.c     ****     for(i=0;i<tlen;i++) {
 516:nmeap01.c     ****         /* decrement remaining byte count */
 517:nmeap01.c     ****         rem--;
 518:nmeap01.c     ****         /* parse the byte */
 1006               		.stabn	68,0,518,.LM79-nmeap_parseBuffer
 1007               	.LM79:
 1008 0450 0150      		subi r16,lo8(-(-1))
 1009 0452 1040      		sbci r17,hi8(-(-1))
 519:nmeap01.c     ****         status = nmeap_parse(context,buffer[i]);
 520:nmeap01.c     ****         if (status != 0) {
 1010               		.stabn	68,0,520,.LM80-nmeap_parseBuffer
 1011               	.LM80:
 1012 0454 6881      		ld r22,Y
 1013 0456 C401      		movw r24,r8
 1014 0458 0E94 0000 		call nmeap_parse
 521:nmeap01.c     ****             /* message found or error */
GAS LISTING /var/tmp//cchOv7GV.s 			page 28


 1015               		.stabn	68,0,521,.LM81-nmeap_parseBuffer
 1016               	.LM81:
 1017 045c 0097      		sbiw r24,0
 1018 045e 49F4      		brne .L81
 1019               		.stabn	68,0,516,.LM82-nmeap_parseBuffer
 1020               	.LM82:
 1021 0460 0894      		sec
 1022 0462 E11C      		adc r14,__zero_reg__
 1023 0464 F11C      		adc r15,__zero_reg__
 1024 0466 2196      		adiw r28,1
 1025               	.L79:
 1026 0468 EA14      		cp r14,r10
 1027 046a FB04      		cpc r15,r11
 1028 046c 8CF3      		brlt .L80
 1029 046e 80E0      		ldi r24,lo8(0)
 1030 0470 90E0      		ldi r25,hi8(0)
 1031               	.L81:
 522:nmeap01.c     ****             break;
 523:nmeap01.c     ****         }
 524:nmeap01.c     ****     }
 525:nmeap01.c     **** 	
 526:nmeap01.c     ****     /* return remaining byte count */
 527:nmeap01.c     ****     *length = rem;
 528:nmeap01.c     **** 	
 1032               		.stabn	68,0,528,.LM83-nmeap_parseBuffer
 1033               	.LM83:
 1034 0472 F601      		movw r30,r12
 1035 0474 1183      		std Z+1,r17
 1036 0476 0083      		st Z,r16
 1037               	/* epilogue: frame size=0 */
 1038 0478 DF91      		pop r29
 1039 047a CF91      		pop r28
 1040 047c 1F91      		pop r17
 1041 047e 0F91      		pop r16
 1042 0480 FF90      		pop r15
 1043 0482 EF90      		pop r14
 1044 0484 DF90      		pop r13
 1045 0486 CF90      		pop r12
 1046 0488 BF90      		pop r11
 1047 048a AF90      		pop r10
 1048 048c 9F90      		pop r9
 1049 048e 8F90      		pop r8
 1050 0490 0895      		ret
 1051               	/* epilogue end (size=13) */
 1052               	/* function nmeap_parseBuffer size 55 (30) */
 1053               		.size	nmeap_parseBuffer, .-nmeap_parseBuffer
 1054               		.stabs	"i:r(0,1)",64,0,507,14
 1055               		.stabs	"status:r(0,1)",64,0,508,24
 1056               		.stabs	"rem:r(0,1)",64,0,509,16
 1057               		.stabs	"tlen:r(0,1)",64,0,510,10
 1058               		.stabn	192,0,0,nmeap_parseBuffer-nmeap_parseBuffer
 1059               		.stabn	224,0,0,.Lscope4-nmeap_parseBuffer
 1060               	.Lscope4:
 1061               		.stabs	"",36,0,0,.Lscope4-nmeap_parseBuffer
 1062               		.stabd	78,0,0
 1063               		.stabs	"dist:F(0,13)",36,0,4,dist
 1064               		.stabs	"from:p(20,1)",160,0,4,1
GAS LISTING /var/tmp//cchOv7GV.s 			page 29


 1065               		.stabs	"to:p(20,1)",160,0,4,9
 1066               	.global	dist
 1067               		.type	dist, @function
 1068               	dist:
 1069               		.stabd	46,0,0
 1070               		.stabs	"gpsmath.c",132,0,0,.Ltext2
 1071               	.Ltext2:
   1:gpsmath.c     **** #include <gpsmath.h>
   2:gpsmath.c     **** 
   3:gpsmath.c     **** 
   4:gpsmath.c     **** double dist(struct waypoint from, struct waypoint to){
 1072               		.stabn	68,0,4,.LM84-dist
 1073               	.LM84:
 1074               	/* prologue: frame size=20 */
 1075 0492 2F92      		push r2
 1076 0494 3F92      		push r3
 1077 0496 4F92      		push r4
 1078 0498 5F92      		push r5
 1079 049a 6F92      		push r6
 1080 049c 7F92      		push r7
 1081 049e 8F92      		push r8
 1082 04a0 9F92      		push r9
 1083 04a2 AF92      		push r10
 1084 04a4 BF92      		push r11
 1085 04a6 CF92      		push r12
 1086 04a8 DF92      		push r13
 1087 04aa EF92      		push r14
 1088 04ac FF92      		push r15
 1089 04ae 0F93      		push r16
 1090 04b0 1F93      		push r17
 1091 04b2 CF93      		push r28
 1092 04b4 DF93      		push r29
 1093 04b6 CDB7      		in r28,__SP_L__
 1094 04b8 DEB7      		in r29,__SP_H__
 1095 04ba 6497      		sbiw r28,20
 1096 04bc 0FB6      		in __tmp_reg__,__SREG__
 1097 04be F894      		cli
 1098 04c0 DEBF      		out __SP_H__,r29
 1099 04c2 0FBE      		out __SREG__,__tmp_reg__
 1100 04c4 CDBF      		out __SP_L__,r28
 1101               	/* prologue end (size=26) */
 1102 04c6 2983      		std Y+1,r18
 1103 04c8 3A83      		std Y+2,r19
 1104 04ca 4B83      		std Y+3,r20
 1105 04cc 5C83      		std Y+4,r21
 1106 04ce 6D83      		std Y+5,r22
 1107 04d0 7E83      		std Y+6,r23
 1108 04d2 8F83      		std Y+7,r24
 1109 04d4 9887      		std Y+8,r25
 1110 04d6 A986      		std Y+9,r10
 1111 04d8 BA86      		std Y+10,r11
 1112 04da CB86      		std Y+11,r12
 1113 04dc DC86      		std Y+12,r13
 1114 04de ED86      		std Y+13,r14
 1115 04e0 FE86      		std Y+14,r15
 1116 04e2 0F87      		std Y+15,r16
 1117 04e4 188B      		std Y+16,r17
GAS LISTING /var/tmp//cchOv7GV.s 			page 30


   5:gpsmath.c     ****     double a, delta_lat, delta_lon;
   6:gpsmath.c     **** 
   7:gpsmath.c     ****     from.lat = from.lat* M_PI / 180;
 1118               		.stabn	68,0,7,.LM85-dist
 1119               	.LM85:
 1120 04e6 6981      		ldd r22,Y+1
 1121 04e8 7A81      		ldd r23,Y+2
 1122 04ea 8B81      		ldd r24,Y+3
 1123 04ec 9C81      		ldd r25,Y+4
 1124 04ee 2BED      		ldi r18,lo8(0x40490fdb)
 1125 04f0 3FE0      		ldi r19,hi8(0x40490fdb)
 1126 04f2 49E4      		ldi r20,hlo8(0x40490fdb)
 1127 04f4 50E4      		ldi r21,hhi8(0x40490fdb)
 1128 04f6 0E94 0000 		call __mulsf3
 1129 04fa 20E0      		ldi r18,lo8(0x43340000)
 1130 04fc 30E0      		ldi r19,hi8(0x43340000)
 1131 04fe 44E3      		ldi r20,hlo8(0x43340000)
 1132 0500 53E4      		ldi r21,hhi8(0x43340000)
 1133 0502 0E94 0000 		call __divsf3
 1134 0506 698B      		std Y+17,r22
 1135 0508 7A8B      		std Y+18,r23
 1136 050a 8B8B      		std Y+19,r24
 1137 050c 9C8B      		std Y+20,r25
   8:gpsmath.c     ****     to.lat = to.lat*M_PI/180;
 1138               		.stabn	68,0,8,.LM86-dist
 1139               	.LM86:
 1140 050e 6985      		ldd r22,Y+9
 1141 0510 7A85      		ldd r23,Y+10
 1142 0512 8B85      		ldd r24,Y+11
 1143 0514 9C85      		ldd r25,Y+12
 1144 0516 2BED      		ldi r18,lo8(0x40490fdb)
 1145 0518 3FE0      		ldi r19,hi8(0x40490fdb)
 1146 051a 49E4      		ldi r20,hlo8(0x40490fdb)
 1147 051c 50E4      		ldi r21,hhi8(0x40490fdb)
 1148 051e 0E94 0000 		call __mulsf3
 1149 0522 20E0      		ldi r18,lo8(0x43340000)
 1150 0524 30E0      		ldi r19,hi8(0x43340000)
 1151 0526 44E3      		ldi r20,hlo8(0x43340000)
 1152 0528 53E4      		ldi r21,hhi8(0x43340000)
 1153 052a 0E94 0000 		call __divsf3
 1154 052e 1B01      		movw r2,r22
 1155 0530 2C01      		movw r4,r24
   9:gpsmath.c     ****     from.lon = from.lon*M_PI/180;
  10:gpsmath.c     ****     to.lon = to.lon*M_PI/180;
  11:gpsmath.c     ****     
  12:gpsmath.c     ****     delta_lat = to.lat - from.lat;
  13:gpsmath.c     ****     delta_lon = to.lon - from.lon;
  14:gpsmath.c     ****     
  15:gpsmath.c     ****     a = sin(delta_lat/2) * sin(delta_lat/2) + cos(from.lat) * cos(to.lat) * sin(delta_lon/2) * sin(
 1156               		.stabn	68,0,15,.LM87-dist
 1157               	.LM87:
 1158 0532 2989      		ldd r18,Y+17
 1159 0534 3A89      		ldd r19,Y+18
 1160 0536 4B89      		ldd r20,Y+19
 1161 0538 5C89      		ldd r21,Y+20
 1162 053a 0E94 0000 		call __subsf3
 1163 053e 20E0      		ldi r18,lo8(0x3f000000)
GAS LISTING /var/tmp//cchOv7GV.s 			page 31


 1164 0540 30E0      		ldi r19,hi8(0x3f000000)
 1165 0542 40E0      		ldi r20,hlo8(0x3f000000)
 1166 0544 5FE3      		ldi r21,hhi8(0x3f000000)
 1167 0546 0E94 0000 		call __mulsf3
 1168 054a 0E94 0000 		call sin
 1169 054e 3B01      		movw r6,r22
 1170 0550 4C01      		movw r8,r24
 1171 0552 6D85      		ldd r22,Y+13
 1172 0554 7E85      		ldd r23,Y+14
 1173 0556 8F85      		ldd r24,Y+15
 1174 0558 9889      		ldd r25,Y+16
 1175 055a 2BED      		ldi r18,lo8(0x40490fdb)
 1176 055c 3FE0      		ldi r19,hi8(0x40490fdb)
 1177 055e 49E4      		ldi r20,hlo8(0x40490fdb)
 1178 0560 50E4      		ldi r21,hhi8(0x40490fdb)
 1179 0562 0E94 0000 		call __mulsf3
 1180 0566 20E0      		ldi r18,lo8(0x43340000)
 1181 0568 30E0      		ldi r19,hi8(0x43340000)
 1182 056a 44E3      		ldi r20,hlo8(0x43340000)
 1183 056c 53E4      		ldi r21,hhi8(0x43340000)
 1184 056e 0E94 0000 		call __divsf3
 1185 0572 7B01      		movw r14,r22
 1186 0574 8C01      		movw r16,r24
 1187 0576 6D81      		ldd r22,Y+5
 1188 0578 7E81      		ldd r23,Y+6
 1189 057a 8F81      		ldd r24,Y+7
 1190 057c 9885      		ldd r25,Y+8
 1191 057e 2BED      		ldi r18,lo8(0x40490fdb)
 1192 0580 3FE0      		ldi r19,hi8(0x40490fdb)
 1193 0582 49E4      		ldi r20,hlo8(0x40490fdb)
 1194 0584 50E4      		ldi r21,hhi8(0x40490fdb)
 1195 0586 0E94 0000 		call __mulsf3
 1196 058a 20E0      		ldi r18,lo8(0x43340000)
 1197 058c 30E0      		ldi r19,hi8(0x43340000)
 1198 058e 44E3      		ldi r20,hlo8(0x43340000)
 1199 0590 53E4      		ldi r21,hhi8(0x43340000)
 1200 0592 0E94 0000 		call __divsf3
 1201 0596 9B01      		movw r18,r22
 1202 0598 AC01      		movw r20,r24
 1203 059a C801      		movw r24,r16
 1204 059c B701      		movw r22,r14
 1205 059e 0E94 0000 		call __subsf3
 1206 05a2 20E0      		ldi r18,lo8(0x3f000000)
 1207 05a4 30E0      		ldi r19,hi8(0x3f000000)
 1208 05a6 40E0      		ldi r20,hlo8(0x3f000000)
 1209 05a8 5FE3      		ldi r21,hhi8(0x3f000000)
 1210 05aa 0E94 0000 		call __mulsf3
 1211 05ae 0E94 0000 		call sin
 1212 05b2 5B01      		movw r10,r22
 1213 05b4 6C01      		movw r12,r24
 1214 05b6 A401      		movw r20,r8
 1215 05b8 9301      		movw r18,r6
 1216 05ba C401      		movw r24,r8
 1217 05bc B301      		movw r22,r6
 1218 05be 0E94 0000 		call __mulsf3
 1219 05c2 3B01      		movw r6,r22
 1220 05c4 4C01      		movw r8,r24
GAS LISTING /var/tmp//cchOv7GV.s 			page 32


 1221 05c6 6989      		ldd r22,Y+17
 1222 05c8 7A89      		ldd r23,Y+18
 1223 05ca 8B89      		ldd r24,Y+19
 1224 05cc 9C89      		ldd r25,Y+20
 1225 05ce 0E94 0000 		call cos
 1226 05d2 7B01      		movw r14,r22
 1227 05d4 8C01      		movw r16,r24
 1228 05d6 C201      		movw r24,r4
 1229 05d8 B101      		movw r22,r2
 1230 05da 0E94 0000 		call cos
 1231 05de 9B01      		movw r18,r22
 1232 05e0 AC01      		movw r20,r24
 1233 05e2 C801      		movw r24,r16
 1234 05e4 B701      		movw r22,r14
 1235 05e6 0E94 0000 		call __mulsf3
 1236 05ea A601      		movw r20,r12
 1237 05ec 9501      		movw r18,r10
 1238 05ee 0E94 0000 		call __mulsf3
 1239 05f2 A601      		movw r20,r12
 1240 05f4 9501      		movw r18,r10
 1241 05f6 0E94 0000 		call __mulsf3
 1242 05fa 9B01      		movw r18,r22
 1243 05fc AC01      		movw r20,r24
 1244 05fe C401      		movw r24,r8
 1245 0600 B301      		movw r22,r6
 1246 0602 0E94 0000 		call __addsf3
 1247 0606 5B01      		movw r10,r22
 1248 0608 6C01      		movw r12,r24
  16:gpsmath.c     ****     a = 2 * atan2(sqrt(a), sqrt(1-a));
 1249               		.stabn	68,0,16,.LM88-dist
 1250               	.LM88:
 1251 060a 9B01      		movw r18,r22
 1252 060c AC01      		movw r20,r24
 1253 060e 60E0      		ldi r22,lo8(0x3f800000)
 1254 0610 70E0      		ldi r23,hi8(0x3f800000)
 1255 0612 80E8      		ldi r24,hlo8(0x3f800000)
 1256 0614 9FE3      		ldi r25,hhi8(0x3f800000)
 1257 0616 0E94 0000 		call __subsf3
 1258 061a 0E94 0000 		call sqrt
 1259 061e 7B01      		movw r14,r22
 1260 0620 8C01      		movw r16,r24
 1261 0622 C601      		movw r24,r12
 1262 0624 B501      		movw r22,r10
 1263 0626 0E94 0000 		call sqrt
 1264 062a A801      		movw r20,r16
 1265 062c 9701      		movw r18,r14
 1266 062e 0E94 0000 		call atan2
 1267 0632 9B01      		movw r18,r22
 1268 0634 AC01      		movw r20,r24
 1269 0636 0E94 0000 		call __addsf3
 1270 063a 20E0      		ldi r18,lo8(0x45c71800)
 1271 063c 38E1      		ldi r19,hi8(0x45c71800)
 1272 063e 47EC      		ldi r20,hlo8(0x45c71800)
 1273 0640 55E4      		ldi r21,hhi8(0x45c71800)
 1274 0642 0E94 0000 		call __mulsf3
 1275               	/* epilogue: frame size=20 */
 1276 0646 6496      		adiw r28,20
GAS LISTING /var/tmp//cchOv7GV.s 			page 33


 1277 0648 0FB6      		in __tmp_reg__,__SREG__
 1278 064a F894      		cli
 1279 064c DEBF      		out __SP_H__,r29
 1280 064e 0FBE      		out __SREG__,__tmp_reg__
 1281 0650 CDBF      		out __SP_L__,r28
 1282 0652 DF91      		pop r29
 1283 0654 CF91      		pop r28
 1284 0656 1F91      		pop r17
 1285 0658 0F91      		pop r16
 1286 065a FF90      		pop r15
 1287 065c EF90      		pop r14
 1288 065e DF90      		pop r13
 1289 0660 CF90      		pop r12
 1290 0662 BF90      		pop r11
 1291 0664 AF90      		pop r10
 1292 0666 9F90      		pop r9
 1293 0668 8F90      		pop r8
 1294 066a 7F90      		pop r7
 1295 066c 6F90      		pop r6
 1296 066e 5F90      		pop r5
 1297 0670 4F90      		pop r4
 1298 0672 3F90      		pop r3
 1299 0674 2F90      		pop r2
 1300 0676 0895      		ret
 1301               	/* epilogue end (size=25) */
 1302               	/* function dist size 243 (192) */
 1303               		.size	dist, .-dist
 1304               	.Lscope5:
 1305               		.stabs	"",36,0,0,.Lscope5-dist
 1306               		.stabd	78,0,0
 1307               		.stabs	"bearing:F(0,13)",36,0,22,bearing
 1308               		.stabs	"from:p(20,1)",160,0,22,1
 1309               		.stabs	"to:p(20,1)",160,0,22,9
 1310               	.global	bearing
 1311               		.type	bearing, @function
 1312               	bearing:
 1313               		.stabd	46,0,0
  17:gpsmath.c     ****     a = R * a;
  18:gpsmath.c     ****     
  19:gpsmath.c     ****     return a; //in km
  20:gpsmath.c     **** }
  21:gpsmath.c     **** 
  22:gpsmath.c     **** double bearing(struct waypoint from, struct waypoint to){
 1314               		.stabn	68,0,22,.LM89-bearing
 1315               	.LM89:
 1316               	/* prologue: frame size=20 */
 1317 0678 2F92      		push r2
 1318 067a 3F92      		push r3
 1319 067c 4F92      		push r4
 1320 067e 5F92      		push r5
 1321 0680 6F92      		push r6
 1322 0682 7F92      		push r7
 1323 0684 8F92      		push r8
 1324 0686 9F92      		push r9
 1325 0688 AF92      		push r10
 1326 068a BF92      		push r11
 1327 068c CF92      		push r12
GAS LISTING /var/tmp//cchOv7GV.s 			page 34


 1328 068e DF92      		push r13
 1329 0690 EF92      		push r14
 1330 0692 FF92      		push r15
 1331 0694 0F93      		push r16
 1332 0696 1F93      		push r17
 1333 0698 CF93      		push r28
 1334 069a DF93      		push r29
 1335 069c CDB7      		in r28,__SP_L__
 1336 069e DEB7      		in r29,__SP_H__
 1337 06a0 6497      		sbiw r28,20
 1338 06a2 0FB6      		in __tmp_reg__,__SREG__
 1339 06a4 F894      		cli
 1340 06a6 DEBF      		out __SP_H__,r29
 1341 06a8 0FBE      		out __SREG__,__tmp_reg__
 1342 06aa CDBF      		out __SP_L__,r28
 1343               	/* prologue end (size=26) */
 1344 06ac 2983      		std Y+1,r18
 1345 06ae 3A83      		std Y+2,r19
 1346 06b0 4B83      		std Y+3,r20
 1347 06b2 5C83      		std Y+4,r21
 1348 06b4 6D83      		std Y+5,r22
 1349 06b6 7E83      		std Y+6,r23
 1350 06b8 8F83      		std Y+7,r24
 1351 06ba 9887      		std Y+8,r25
 1352 06bc A986      		std Y+9,r10
 1353 06be BA86      		std Y+10,r11
 1354 06c0 CB86      		std Y+11,r12
 1355 06c2 DC86      		std Y+12,r13
 1356 06c4 ED86      		std Y+13,r14
 1357 06c6 FE86      		std Y+14,r15
 1358 06c8 0F87      		std Y+15,r16
 1359 06ca 188B      		std Y+16,r17
  23:gpsmath.c     ****     double a,b;
  24:gpsmath.c     ****     
  25:gpsmath.c     ****     from.lat = from.lat* M_PI / 180;
 1360               		.stabn	68,0,25,.LM90-bearing
 1361               	.LM90:
 1362 06cc 6981      		ldd r22,Y+1
 1363 06ce 7A81      		ldd r23,Y+2
 1364 06d0 8B81      		ldd r24,Y+3
 1365 06d2 9C81      		ldd r25,Y+4
 1366 06d4 2BED      		ldi r18,lo8(0x40490fdb)
 1367 06d6 3FE0      		ldi r19,hi8(0x40490fdb)
 1368 06d8 49E4      		ldi r20,hlo8(0x40490fdb)
 1369 06da 50E4      		ldi r21,hhi8(0x40490fdb)
 1370 06dc 0E94 0000 		call __mulsf3
 1371 06e0 20E0      		ldi r18,lo8(0x43340000)
 1372 06e2 30E0      		ldi r19,hi8(0x43340000)
 1373 06e4 44E3      		ldi r20,hlo8(0x43340000)
 1374 06e6 53E4      		ldi r21,hhi8(0x43340000)
 1375 06e8 0E94 0000 		call __divsf3
 1376 06ec 698B      		std Y+17,r22
 1377 06ee 7A8B      		std Y+18,r23
 1378 06f0 8B8B      		std Y+19,r24
 1379 06f2 9C8B      		std Y+20,r25
  26:gpsmath.c     ****     to.lat = to.lat*M_PI/180;
 1380               		.stabn	68,0,26,.LM91-bearing
GAS LISTING /var/tmp//cchOv7GV.s 			page 35


 1381               	.LM91:
 1382 06f4 6985      		ldd r22,Y+9
 1383 06f6 7A85      		ldd r23,Y+10
 1384 06f8 8B85      		ldd r24,Y+11
 1385 06fa 9C85      		ldd r25,Y+12
 1386 06fc 2BED      		ldi r18,lo8(0x40490fdb)
 1387 06fe 3FE0      		ldi r19,hi8(0x40490fdb)
 1388 0700 49E4      		ldi r20,hlo8(0x40490fdb)
 1389 0702 50E4      		ldi r21,hhi8(0x40490fdb)
 1390 0704 0E94 0000 		call __mulsf3
 1391 0708 20E0      		ldi r18,lo8(0x43340000)
 1392 070a 30E0      		ldi r19,hi8(0x43340000)
 1393 070c 44E3      		ldi r20,hlo8(0x43340000)
 1394 070e 53E4      		ldi r21,hhi8(0x43340000)
 1395 0710 0E94 0000 		call __divsf3
 1396 0714 5B01      		movw r10,r22
 1397 0716 6C01      		movw r12,r24
  27:gpsmath.c     ****     from.lon = from.lon*M_PI/180;
  28:gpsmath.c     ****     to.lon = to.lon*M_PI/180;
  29:gpsmath.c     ****     
  30:gpsmath.c     ****     a = sin(to.lon - from.lon)*cos(to.lat);
 1398               		.stabn	68,0,30,.LM92-bearing
 1399               	.LM92:
 1400 0718 6D85      		ldd r22,Y+13
 1401 071a 7E85      		ldd r23,Y+14
 1402 071c 8F85      		ldd r24,Y+15
 1403 071e 9889      		ldd r25,Y+16
 1404 0720 2BED      		ldi r18,lo8(0x40490fdb)
 1405 0722 3FE0      		ldi r19,hi8(0x40490fdb)
 1406 0724 49E4      		ldi r20,hlo8(0x40490fdb)
 1407 0726 50E4      		ldi r21,hhi8(0x40490fdb)
 1408 0728 0E94 0000 		call __mulsf3
 1409 072c 20E0      		ldi r18,lo8(0x43340000)
 1410 072e 30E0      		ldi r19,hi8(0x43340000)
 1411 0730 44E3      		ldi r20,hlo8(0x43340000)
 1412 0732 53E4      		ldi r21,hhi8(0x43340000)
 1413 0734 0E94 0000 		call __divsf3
 1414 0738 7B01      		movw r14,r22
 1415 073a 8C01      		movw r16,r24
 1416 073c 6D81      		ldd r22,Y+5
 1417 073e 7E81      		ldd r23,Y+6
 1418 0740 8F81      		ldd r24,Y+7
 1419 0742 9885      		ldd r25,Y+8
 1420 0744 2BED      		ldi r18,lo8(0x40490fdb)
 1421 0746 3FE0      		ldi r19,hi8(0x40490fdb)
 1422 0748 49E4      		ldi r20,hlo8(0x40490fdb)
 1423 074a 50E4      		ldi r21,hhi8(0x40490fdb)
 1424 074c 0E94 0000 		call __mulsf3
 1425 0750 20E0      		ldi r18,lo8(0x43340000)
 1426 0752 30E0      		ldi r19,hi8(0x43340000)
 1427 0754 44E3      		ldi r20,hlo8(0x43340000)
 1428 0756 53E4      		ldi r21,hhi8(0x43340000)
 1429 0758 0E94 0000 		call __divsf3
 1430 075c 9B01      		movw r18,r22
 1431 075e AC01      		movw r20,r24
 1432 0760 C801      		movw r24,r16
 1433 0762 B701      		movw r22,r14
GAS LISTING /var/tmp//cchOv7GV.s 			page 36


 1434 0764 0E94 0000 		call __subsf3
 1435 0768 3B01      		movw r6,r22
 1436 076a 4C01      		movw r8,r24
 1437 076c C601      		movw r24,r12
 1438 076e B501      		movw r22,r10
 1439 0770 0E94 0000 		call cos
 1440 0774 1B01      		movw r2,r22
 1441 0776 2C01      		movw r4,r24
  31:gpsmath.c     ****     b = cos(from.lat)*sin(to.lat) - sin(from.lat)*cos(to.lat)*cos(to.lon-from.lon);
 1442               		.stabn	68,0,31,.LM93-bearing
 1443               	.LM93:
 1444 0778 6989      		ldd r22,Y+17
 1445 077a 7A89      		ldd r23,Y+18
 1446 077c 8B89      		ldd r24,Y+19
 1447 077e 9C89      		ldd r25,Y+20
 1448 0780 0E94 0000 		call cos
 1449 0784 7B01      		movw r14,r22
 1450 0786 8C01      		movw r16,r24
 1451 0788 C601      		movw r24,r12
 1452 078a B501      		movw r22,r10
 1453 078c 0E94 0000 		call sin
 1454 0790 9B01      		movw r18,r22
 1455 0792 AC01      		movw r20,r24
 1456 0794 C801      		movw r24,r16
 1457 0796 B701      		movw r22,r14
 1458 0798 0E94 0000 		call __mulsf3
 1459 079c 5B01      		movw r10,r22
 1460 079e 6C01      		movw r12,r24
 1461 07a0 6989      		ldd r22,Y+17
 1462 07a2 7A89      		ldd r23,Y+18
 1463 07a4 8B89      		ldd r24,Y+19
 1464 07a6 9C89      		ldd r25,Y+20
 1465 07a8 0E94 0000 		call sin
 1466 07ac A201      		movw r20,r4
 1467 07ae 9101      		movw r18,r2
 1468 07b0 0E94 0000 		call __mulsf3
 1469 07b4 7B01      		movw r14,r22
 1470 07b6 8C01      		movw r16,r24
 1471 07b8 C401      		movw r24,r8
 1472 07ba B301      		movw r22,r6
 1473 07bc 0E94 0000 		call cos
 1474 07c0 9B01      		movw r18,r22
 1475 07c2 AC01      		movw r20,r24
 1476 07c4 C801      		movw r24,r16
 1477 07c6 B701      		movw r22,r14
 1478 07c8 0E94 0000 		call __mulsf3
 1479 07cc 9B01      		movw r18,r22
 1480 07ce AC01      		movw r20,r24
 1481 07d0 C601      		movw r24,r12
 1482 07d2 B501      		movw r22,r10
 1483 07d4 0E94 0000 		call __subsf3
 1484 07d8 7B01      		movw r14,r22
 1485 07da 8C01      		movw r16,r24
 1486               		.stabn	68,0,30,.LM94-bearing
 1487               	.LM94:
 1488 07dc C401      		movw r24,r8
 1489 07de B301      		movw r22,r6
GAS LISTING /var/tmp//cchOv7GV.s 			page 37


 1490 07e0 0E94 0000 		call sin
 1491 07e4 A201      		movw r20,r4
 1492 07e6 9101      		movw r18,r2
 1493 07e8 0E94 0000 		call __mulsf3
 1494 07ec A801      		movw r20,r16
 1495 07ee 9701      		movw r18,r14
 1496 07f0 0E94 0000 		call atan2
 1497 07f4 20E0      		ldi r18,lo8(0x43340000)
 1498 07f6 30E0      		ldi r19,hi8(0x43340000)
 1499 07f8 44E3      		ldi r20,hlo8(0x43340000)
 1500 07fa 53E4      		ldi r21,hhi8(0x43340000)
 1501 07fc 0E94 0000 		call __mulsf3
 1502 0800 2BED      		ldi r18,lo8(0x40490fdb)
 1503 0802 3FE0      		ldi r19,hi8(0x40490fdb)
 1504 0804 49E4      		ldi r20,hlo8(0x40490fdb)
 1505 0806 50E4      		ldi r21,hhi8(0x40490fdb)
 1506 0808 0E94 0000 		call __divsf3
 1507               	/* epilogue: frame size=20 */
 1508 080c 6496      		adiw r28,20
 1509 080e 0FB6      		in __tmp_reg__,__SREG__
 1510 0810 F894      		cli
 1511 0812 DEBF      		out __SP_H__,r29
 1512 0814 0FBE      		out __SREG__,__tmp_reg__
 1513 0816 CDBF      		out __SP_L__,r28
 1514 0818 DF91      		pop r29
 1515 081a CF91      		pop r28
 1516 081c 1F91      		pop r17
 1517 081e 0F91      		pop r16
 1518 0820 FF90      		pop r15
 1519 0822 EF90      		pop r14
 1520 0824 DF90      		pop r13
 1521 0826 CF90      		pop r12
 1522 0828 BF90      		pop r11
 1523 082a AF90      		pop r10
 1524 082c 9F90      		pop r9
 1525 082e 8F90      		pop r8
 1526 0830 7F90      		pop r7
 1527 0832 6F90      		pop r6
 1528 0834 5F90      		pop r5
 1529 0836 4F90      		pop r4
 1530 0838 3F90      		pop r3
 1531 083a 2F90      		pop r2
 1532 083c 0895      		ret
 1533               	/* epilogue end (size=25) */
 1534               	/* function bearing size 227 (176) */
 1535               		.size	bearing, .-bearing
 1536               	.Lscope6:
 1537               		.stabs	"",36,0,0,.Lscope6-bearing
 1538               		.stabd	78,0,0
 1539               		.stabs	"uartswInitBuffers:F(0,15)",36,0,92,uartswInitBuffers
 1540               	.global	uartswInitBuffers
 1541               		.type	uartswInitBuffers, @function
 1542               	uartswInitBuffers:
 1543               		.stabd	46,0,0
 1544               		.stabs	"uartsw.c",132,0,0,.Ltext3
 1545               	.Ltext3:
   1:uartsw.c      **** /*! \file uartsw.c \brief Software Interrupt-driven UART Driver. */
GAS LISTING /var/tmp//cchOv7GV.s 			page 38


   2:uartsw.c      **** //*****************************************************************************
   3:uartsw.c      **** //
   4:uartsw.c      **** // File Name	: 'uartsw.c'
   5:uartsw.c      **** // Title		: Software Interrupt-driven UART Driver
   6:uartsw.c      **** // Author		: Pascal Stang - Copyright (C) 2002-2004
   7:uartsw.c      **** // Created		: 7/20/2002
   8:uartsw.c      **** // Revised		: 4/27/2004
   9:uartsw.c      **** // Version		: 0.1
  10:uartsw.c      **** // Target MCU	: Atmel AVR Series (intended for the ATmega16 and ATmega32)
  11:uartsw.c      **** // Editor Tabs	: 4
  12:uartsw.c      **** //
  13:uartsw.c      **** // This code is distributed under the GNU Public License
  14:uartsw.c      **** //		which can be found at http://www.gnu.org/licenses/gpl.txt
  15:uartsw.c      **** //
  16:uartsw.c      **** //*****************************************************************************
  17:uartsw.c      **** 
  18:uartsw.c      **** #include <avr/io.h>
  19:uartsw.c      **** #include <avr/interrupt.h>
  20:uartsw.c      **** 
  21:uartsw.c      **** #include "global.h"
  22:uartsw.c      **** #include "timer.h"
  23:uartsw.c      **** #include "uartsw.h"
  24:uartsw.c      **** 
  25:uartsw.c      **** // Program ROM constants
  26:uartsw.c      **** 
  27:uartsw.c      **** // Global variables
  28:uartsw.c      **** 
  29:uartsw.c      **** // uartsw transmit status and data variables
  30:uartsw.c      **** static volatile u08 UartswTxBusy;
  31:uartsw.c      **** static volatile u08 UartswTxData;
  32:uartsw.c      **** static volatile u08 UartswTxBitNum;
  33:uartsw.c      **** 
  34:uartsw.c      **** // baud rate common to transmit and receive
  35:uartsw.c      **** static volatile u16 UartswBaudRateDiv;
  36:uartsw.c      **** 
  37:uartsw.c      **** // uartsw receive status and data variables
  38:uartsw.c      **** static volatile u08 UartswRxBusy;
  39:uartsw.c      **** static volatile u08 UartswRxData;
  40:uartsw.c      **** static volatile u08 UartswRxBitNum;
  41:uartsw.c      **** // receive buffer
  42:uartsw.c      **** static cBuffer uartswRxBuffer;               ///< uartsw receive buffer
  43:uartsw.c      **** // automatically allocate space in ram for each buffer
  44:uartsw.c      **** static char uartswRxData[UARTSW_RX_BUFFER_SIZE];
  45:uartsw.c      **** static char sentence[20];
  46:uartsw.c      **** 
  47:uartsw.c      **** // functions
  48:uartsw.c      **** 
  49:uartsw.c      **** //! enable and initialize the software uart
  50:uartsw.c      **** void uartswInit(void)
  51:uartsw.c      **** {
  52:uartsw.c      ****     // initialize the buffers
  53:uartsw.c      **** 	uartswInitBuffers();
  54:uartsw.c      **** 	// initialize the ports
  55:uartsw.c      **** 	sbi(UARTSW_TX_DDR, UARTSW_TX_PIN);
  56:uartsw.c      **** 	cbi(UARTSW_RX_DDR, UARTSW_RX_PIN);
  57:uartsw.c      **** 	cbi(UARTSW_RX_PORT, UARTSW_RX_PIN);
  58:uartsw.c      **** 	// initialize baud rate
GAS LISTING /var/tmp//cchOv7GV.s 			page 39


  59:uartsw.c      **** 	uartswSetBaudRate(19200);
  60:uartsw.c      **** 
  61:uartsw.c      **** 	// setup the transmitter
  62:uartsw.c      **** 	UartswTxBusy = FALSE;
  63:uartsw.c      **** 	// disable OC1A interrupt
  64:uartsw.c      **** 	cbi(TIMSK, OCIE1A);
  65:uartsw.c      **** 	// attach TxBit service routine to OC1A
  66:uartsw.c      **** 	timerAttach(TIMER1OUTCOMPAREA_INT, uartswTxBitService);
  67:uartsw.c      **** 
  68:uartsw.c      **** 	// setup the receiver
  69:uartsw.c      **** 	UartswRxBusy = FALSE;
  70:uartsw.c      **** 	// disable OC1B interrupt
  71:uartsw.c      **** 	cbi(TIMSK, OCIE1B);
  72:uartsw.c      **** 	// attach RxBit service routine to OC1B
  73:uartsw.c      **** 	timerAttach(TIMER1OUTCOMPAREB_INT, uartswRxBitService);
  74:uartsw.c      **** 	// attach RxBit service routine to ICP
  75:uartsw.c      **** 	timerAttach(TIMER1INPUTCAPTURE_INT, uartswRxBitService);
  76:uartsw.c      **** 	#ifdef UARTSW_INVERT 
  77:uartsw.c      **** 	// trigger on rising edge 
  78:uartsw.c      **** 	sbi(TCCR1B, ICES1); 
  79:uartsw.c      **** 	#else 
  80:uartsw.c      **** 	// trigger on falling edge 
  81:uartsw.c      **** 	cbi(TCCR1B, ICES1); 
  82:uartsw.c      **** 	#endif	
  83:uartsw.c      **** 	// enable ICP interrupt
  84:uartsw.c      **** 	sbi(TIMSK, TICIE1);
  85:uartsw.c      **** 
  86:uartsw.c      **** 	// turn on interrupts
  87:uartsw.c      **** 	sei();
  88:uartsw.c      **** }
  89:uartsw.c      **** 
  90:uartsw.c      **** //! create and initialize the uart buffers
  91:uartsw.c      **** void uartswInitBuffers(void)
  92:uartsw.c      **** {
 1546               		.stabn	68,0,92,.LM95-uartswInitBuffers
 1547               	.LM95:
 1548               	/* prologue: frame size=0 */
 1549               	/* prologue end (size=0) */
  93:uartsw.c      **** 	// initialize the UART receive buffer
  94:uartsw.c      **** 	bufferInit(&uartswRxBuffer, uartswRxData, UARTSW_RX_BUFFER_SIZE);
 1550               		.stabn	68,0,94,.LM96-uartswInitBuffers
 1551               	.LM96:
 1552 083e 40E2      		ldi r20,lo8(32)
 1553 0840 50E0      		ldi r21,hi8(32)
 1554 0842 60E0      		ldi r22,lo8(uartswRxData)
 1555 0844 70E0      		ldi r23,hi8(uartswRxData)
 1556 0846 80E0      		ldi r24,lo8(uartswRxBuffer)
 1557 0848 90E0      		ldi r25,hi8(uartswRxBuffer)
 1558 084a 0E94 0000 		call bufferInit
 1559               	/* epilogue: frame size=0 */
 1560 084e 0895      		ret
 1561               	/* epilogue end (size=1) */
 1562               	/* function uartswInitBuffers size 9 (8) */
 1563               		.size	uartswInitBuffers, .-uartswInitBuffers
 1564               	.Lscope7:
 1565               		.stabs	"",36,0,0,.Lscope7-uartswInitBuffers
 1566               		.stabd	78,0,0
GAS LISTING /var/tmp//cchOv7GV.s 			page 40


 1567               		.stabs	"uartswOff:F(0,15)",36,0,99,uartswOff
 1568               	.global	uartswOff
 1569               		.type	uartswOff, @function
 1570               	uartswOff:
 1571               		.stabd	46,0,0
  95:uartsw.c      **** }
  96:uartsw.c      **** 
  97:uartsw.c      **** //! turns off software UART
  98:uartsw.c      **** void uartswOff(void)
  99:uartsw.c      **** {
 1572               		.stabn	68,0,99,.LM97-uartswOff
 1573               	.LM97:
 1574               	/* prologue: frame size=0 */
 1575               	/* prologue end (size=0) */
 100:uartsw.c      **** 	// disable interrupts
 101:uartsw.c      **** 	cbi(TIMSK, OCIE1A);
 1576               		.stabn	68,0,101,.LM98-uartswOff
 1577               	.LM98:
 1578 0850 89B7      		in r24,89-0x20
 1579 0852 8F7E      		andi r24,lo8(-17)
 1580 0854 89BF      		out 89-0x20,r24
 102:uartsw.c      **** 	cbi(TIMSK, OCIE1B);
 1581               		.stabn	68,0,102,.LM99-uartswOff
 1582               	.LM99:
 1583 0856 89B7      		in r24,89-0x20
 1584 0858 877F      		andi r24,lo8(-9)
 1585 085a 89BF      		out 89-0x20,r24
 103:uartsw.c      **** 	cbi(TIMSK, TICIE1);
 1586               		.stabn	68,0,103,.LM100-uartswOff
 1587               	.LM100:
 1588 085c 89B7      		in r24,89-0x20
 1589 085e 8F7D      		andi r24,lo8(-33)
 1590 0860 89BF      		out 89-0x20,r24
 104:uartsw.c      **** 	// detach the service routines
 105:uartsw.c      **** 	timerDetach(TIMER1OUTCOMPAREA_INT);
 1591               		.stabn	68,0,105,.LM101-uartswOff
 1592               	.LM101:
 1593 0862 82E0      		ldi r24,lo8(2)
 1594 0864 0E94 0000 		call timerDetach
 106:uartsw.c      **** 	timerDetach(TIMER1OUTCOMPAREB_INT);
 1595               		.stabn	68,0,106,.LM102-uartswOff
 1596               	.LM102:
 1597 0868 83E0      		ldi r24,lo8(3)
 1598 086a 0E94 0000 		call timerDetach
 107:uartsw.c      **** 	timerDetach(TIMER1INPUTCAPTURE_INT);
 1599               		.stabn	68,0,107,.LM103-uartswOff
 1600               	.LM103:
 1601 086e 84E0      		ldi r24,lo8(4)
 1602 0870 0E94 0000 		call timerDetach
 1603               	/* epilogue: frame size=0 */
 1604 0874 0895      		ret
 1605               	/* epilogue end (size=1) */
 1606               	/* function uartswOff size 19 (18) */
 1607               		.size	uartswOff, .-uartswOff
 1608               	.Lscope8:
 1609               		.stabs	"",36,0,0,.Lscope8-uartswOff
 1610               		.stabd	78,0,0
GAS LISTING /var/tmp//cchOv7GV.s 			page 41


 1611               		.stabs	"uartswSetBaudRate:F(0,15)",36,0,111,uartswSetBaudRate
 1612               		.stabs	"baudrate:P(7,5)",64,0,110,14
 1613               	.global	uartswSetBaudRate
 1614               		.type	uartswSetBaudRate, @function
 1615               	uartswSetBaudRate:
 1616               		.stabd	46,0,0
 108:uartsw.c      **** }
 109:uartsw.c      **** 
 110:uartsw.c      **** void uartswSetBaudRate(u32 baudrate)
 111:uartsw.c      **** {
 1617               		.stabn	68,0,111,.LM104-uartswSetBaudRate
 1618               	.LM104:
 1619               	/* prologue: frame size=0 */
 1620 0876 EF92      		push r14
 1621 0878 FF92      		push r15
 1622 087a 0F93      		push r16
 1623 087c 1F93      		push r17
 1624               	/* prologue end (size=4) */
 1625 087e 7B01      		movw r14,r22
 1626 0880 8C01      		movw r16,r24
 112:uartsw.c      **** 	// set timer prescaler
 113:uartsw.c      **** 	timer1SetPrescaler(TIMER_CLK_DIV1);
 1627               		.stabn	68,0,113,.LM105-uartswSetBaudRate
 1628               	.LM105:
 1629 0882 81E0      		ldi r24,lo8(1)
 1630 0884 0E94 0000 		call timer1SetPrescaler
 114:uartsw.c      **** 	// calculate division factor for requested baud rate, and set it
 115:uartsw.c      **** 	UartswBaudRateDiv = (u16)((F_CPU+(baudrate/2L))/(baudrate*1L));
 1631               		.stabn	68,0,115,.LM106-uartswSetBaudRate
 1632               	.LM106:
 1633 0888 C801      		movw r24,r16
 1634 088a B701      		movw r22,r14
 1635 088c 9695      		lsr r25
 1636 088e 8795      		ror r24
 1637 0890 7795      		ror r23
 1638 0892 6795      		ror r22
 1639 0894 6050      		subi r22,lo8(-(16000000))
 1640 0896 7C4D      		sbci r23,hi8(-(16000000))
 1641 0898 8B40      		sbci r24,hlo8(-(16000000))
 1642 089a 9F4F      		sbci r25,hhi8(-(16000000))
 1643 089c A801      		movw r20,r16
 1644 089e 9701      		movw r18,r14
 1645 08a0 0E94 0000 		call __udivmodsi4
 1646 08a4 3093 0000 		sts (UartswBaudRateDiv)+1,r19
 1647 08a8 2093 0000 		sts UartswBaudRateDiv,r18
 1648               	/* epilogue: frame size=0 */
 1649 08ac 1F91      		pop r17
 1650 08ae 0F91      		pop r16
 1651 08b0 FF90      		pop r15
 1652 08b2 EF90      		pop r14
 1653 08b4 0895      		ret
 1654               	/* epilogue end (size=5) */
 1655               	/* function uartswSetBaudRate size 32 (23) */
 1656               		.size	uartswSetBaudRate, .-uartswSetBaudRate
 1657               	.Lscope9:
 1658               		.stabs	"",36,0,0,.Lscope9-uartswSetBaudRate
 1659               		.stabd	78,0,0
GAS LISTING /var/tmp//cchOv7GV.s 			page 42


 1660               		.stabs	"uartswInit:F(0,15)",36,0,51,uartswInit
 1661               	.global	uartswInit
 1662               		.type	uartswInit, @function
 1663               	uartswInit:
 1664               		.stabd	46,0,0
 1665               		.stabn	68,0,51,.LM107-uartswInit
 1666               	.LM107:
 1667               	/* prologue: frame size=0 */
 1668 08b6 0F93      		push r16
 1669 08b8 1F93      		push r17
 1670               	/* prologue end (size=2) */
 1671               		.stabn	68,0,53,.LM108-uartswInit
 1672               	.LM108:
 1673 08ba 0E94 0000 		call uartswInitBuffers
 1674               		.stabn	68,0,55,.LM109-uartswInit
 1675               	.LM109:
 1676 08be 8D9A      		sbi 49-0x20,5
 1677               		.stabn	68,0,56,.LM110-uartswInit
 1678               	.LM110:
 1679 08c0 8E98      		cbi 49-0x20,6
 1680               		.stabn	68,0,57,.LM111-uartswInit
 1681               	.LM111:
 1682 08c2 9698      		cbi 50-0x20,6
 1683               		.stabn	68,0,59,.LM112-uartswInit
 1684               	.LM112:
 1685 08c4 60E0      		ldi r22,lo8(19200)
 1686 08c6 7BE4      		ldi r23,hi8(19200)
 1687 08c8 80E0      		ldi r24,hlo8(19200)
 1688 08ca 90E0      		ldi r25,hhi8(19200)
 1689 08cc 0E94 0000 		call uartswSetBaudRate
 1690               		.stabn	68,0,62,.LM113-uartswInit
 1691               	.LM113:
 1692 08d0 1092 0000 		sts UartswTxBusy,__zero_reg__
 1693               		.stabn	68,0,64,.LM114-uartswInit
 1694               	.LM114:
 1695 08d4 89B7      		in r24,89-0x20
 1696 08d6 8F7E      		andi r24,lo8(-17)
 1697 08d8 89BF      		out 89-0x20,r24
 1698               		.stabn	68,0,66,.LM115-uartswInit
 1699               	.LM115:
 1700 08da 60E0      		ldi r22,lo8(pm(uartswTxBitService))
 1701 08dc 70E0      		ldi r23,hi8(pm(uartswTxBitService))
 1702 08de 82E0      		ldi r24,lo8(2)
 1703 08e0 0E94 0000 		call timerAttach
 1704               		.stabn	68,0,69,.LM116-uartswInit
 1705               	.LM116:
 1706 08e4 1092 0000 		sts UartswRxBusy,__zero_reg__
 1707               		.stabn	68,0,71,.LM117-uartswInit
 1708               	.LM117:
 1709 08e8 89B7      		in r24,89-0x20
 1710 08ea 877F      		andi r24,lo8(-9)
 1711 08ec 89BF      		out 89-0x20,r24
 1712               		.stabn	68,0,73,.LM118-uartswInit
 1713               	.LM118:
 1714 08ee 00E0      		ldi r16,lo8(pm(uartswRxBitService))
 1715 08f0 10E0      		ldi r17,hi8(pm(uartswRxBitService))
 1716 08f2 B801      		movw r22,r16
GAS LISTING /var/tmp//cchOv7GV.s 			page 43


 1717 08f4 83E0      		ldi r24,lo8(3)
 1718 08f6 0E94 0000 		call timerAttach
 1719               		.stabn	68,0,75,.LM119-uartswInit
 1720               	.LM119:
 1721 08fa B801      		movw r22,r16
 1722 08fc 84E0      		ldi r24,lo8(4)
 1723 08fe 0E94 0000 		call timerAttach
 1724               		.stabn	68,0,81,.LM120-uartswInit
 1725               	.LM120:
 1726 0902 8EB5      		in r24,78-0x20
 1727 0904 8F7B      		andi r24,lo8(-65)
 1728 0906 8EBD      		out 78-0x20,r24
 1729               		.stabn	68,0,84,.LM121-uartswInit
 1730               	.LM121:
 1731 0908 89B7      		in r24,89-0x20
 1732 090a 8062      		ori r24,lo8(32)
 1733 090c 89BF      		out 89-0x20,r24
 1734               		.stabn	68,0,87,.LM122-uartswInit
 1735               	.LM122:
 1736               	/* #APP */
 1737 090e 7894      		sei
 1738               	/* #NOAPP */
 1739               	/* epilogue: frame size=0 */
 1740 0910 1F91      		pop r17
 1741 0912 0F91      		pop r16
 1742 0914 0895      		ret
 1743               	/* epilogue end (size=3) */
 1744               	/* function uartswInit size 49 (44) */
 1745               		.size	uartswInit, .-uartswInit
 1746               	.Lscope10:
 1747               		.stabs	"",36,0,0,.Lscope10-uartswInit
 1748               		.stabd	78,0,0
 1749               		.stabs	"uartswGetRxBuffer:F(0,20)=*(8,3)",36,0,120,uartswGetRxBuffer
 1750               	.global	uartswGetRxBuffer
 1751               		.type	uartswGetRxBuffer, @function
 1752               	uartswGetRxBuffer:
 1753               		.stabd	46,0,0
 116:uartsw.c      **** }
 117:uartsw.c      **** 
 118:uartsw.c      **** //! returns the receive buffer structure 
 119:uartsw.c      **** cBuffer* uartswGetRxBuffer(void)
 120:uartsw.c      **** {
 1754               		.stabn	68,0,120,.LM123-uartswGetRxBuffer
 1755               	.LM123:
 1756               	/* prologue: frame size=0 */
 1757               	/* prologue end (size=0) */
 121:uartsw.c      **** 	// return rx buffer pointer
 122:uartsw.c      **** 	return &uartswRxBuffer;
 123:uartsw.c      **** }
 1758               		.stabn	68,0,123,.LM124-uartswGetRxBuffer
 1759               	.LM124:
 1760 0916 80E0      		ldi r24,lo8(uartswRxBuffer)
 1761 0918 90E0      		ldi r25,hi8(uartswRxBuffer)
 1762               	/* epilogue: frame size=0 */
 1763 091a 0895      		ret
 1764               	/* epilogue end (size=1) */
 1765               	/* function uartswGetRxBuffer size 3 (2) */
GAS LISTING /var/tmp//cchOv7GV.s 			page 44


 1766               		.size	uartswGetRxBuffer, .-uartswGetRxBuffer
 1767               	.Lscope11:
 1768               		.stabs	"",36,0,0,.Lscope11-uartswGetRxBuffer
 1769               		.stabd	78,0,0
 1770               		.stabs	"uartswSendByte:F(0,15)",36,0,126,uartswSendByte
 1771               		.stabs	"data:P(7,1)",64,0,125,25
 1772               	.global	uartswSendByte
 1773               		.type	uartswSendByte, @function
 1774               	uartswSendByte:
 1775               		.stabd	46,0,0
 124:uartsw.c      **** 
 125:uartsw.c      **** void uartswSendByte(u08 data)
 126:uartsw.c      **** {
 1776               		.stabn	68,0,126,.LM125-uartswSendByte
 1777               	.LM125:
 1778               	/* prologue: frame size=0 */
 1779               	/* prologue end (size=0) */
 1780 091c 982F      		mov r25,r24
 1781               	.L101:
 127:uartsw.c      **** 	// wait until uart is ready
 128:uartsw.c      **** 	while(UartswTxBusy);
 1782               		.stabn	68,0,128,.LM126-uartswSendByte
 1783               	.LM126:
 1784 091e 8091 0000 		lds r24,UartswTxBusy
 1785 0922 8823      		tst r24
 1786 0924 E1F7      		brne .L101
 129:uartsw.c      **** 	// set busy flag
 130:uartsw.c      **** 	UartswTxBusy = TRUE;
 1787               		.stabn	68,0,130,.LM127-uartswSendByte
 1788               	.LM127:
 1789 0926 8FEF      		ldi r24,lo8(-1)
 1790 0928 8093 0000 		sts UartswTxBusy,r24
 131:uartsw.c      **** 	// save data
 132:uartsw.c      **** 	UartswTxData = data;
 1791               		.stabn	68,0,132,.LM128-uartswSendByte
 1792               	.LM128:
 1793 092c 9093 0000 		sts UartswTxData,r25
 133:uartsw.c      **** 	// set number of bits (+1 for stop bit)
 134:uartsw.c      **** 	UartswTxBitNum = 9;
 1794               		.stabn	68,0,134,.LM129-uartswSendByte
 1795               	.LM129:
 1796 0930 89E0      		ldi r24,lo8(9)
 1797 0932 8093 0000 		sts UartswTxBitNum,r24
 135:uartsw.c      **** 	
 136:uartsw.c      **** 	// set the start bit
 137:uartsw.c      **** 	#ifdef UARTSW_INVERT
 138:uartsw.c      **** 	sbi(UARTSW_TX_PORT, UARTSW_TX_PIN);
 139:uartsw.c      **** 	#else
 140:uartsw.c      **** 	cbi(UARTSW_TX_PORT, UARTSW_TX_PIN);
 1798               		.stabn	68,0,140,.LM130-uartswSendByte
 1799               	.LM130:
 1800 0936 9598      		cbi 50-0x20,5
 141:uartsw.c      **** 	#endif
 142:uartsw.c      **** 
 143:uartsw.c      **** 	// schedule the next bit
 144:uartsw.c      **** 	outw(OCR1A, inw(TCNT1) + UartswBaudRateDiv);
 1801               		.stabn	68,0,144,.LM131-uartswSendByte
GAS LISTING /var/tmp//cchOv7GV.s 			page 45


 1802               	.LM131:
 1803 0938 8CB5      		in r24,76-0x20
 1804 093a 9DB5      		in r25,(76)+1-0x20
 1805 093c 2091 0000 		lds r18,UartswBaudRateDiv
 1806 0940 3091 0000 		lds r19,(UartswBaudRateDiv)+1
 1807 0944 820F      		add r24,r18
 1808 0946 931F      		adc r25,r19
 1809 0948 9BBD      		out (74)+1-0x20,r25
 1810 094a 8ABD      		out 74-0x20,r24
 145:uartsw.c      **** 	// enable OC1A interrupt
 146:uartsw.c      **** 	sbi(TIMSK, OCIE1A);
 1811               		.stabn	68,0,146,.LM132-uartswSendByte
 1812               	.LM132:
 1813 094c 89B7      		in r24,89-0x20
 1814 094e 8061      		ori r24,lo8(16)
 1815 0950 89BF      		out 89-0x20,r24
 1816               	/* epilogue: frame size=0 */
 1817 0952 0895      		ret
 1818               	/* epilogue end (size=1) */
 1819               	/* function uartswSendByte size 28 (27) */
 1820               		.size	uartswSendByte, .-uartswSendByte
 1821               	.Lscope12:
 1822               		.stabs	"",36,0,0,.Lscope12-uartswSendByte
 1823               		.stabd	78,0,0
 1824               		.stabs	"uartswReceiveByte:F(7,1)",36,0,151,uartswReceiveByte
 1825               		.stabs	"rxData:P(0,21)=*(7,1)",64,0,150,28
 1826               	.global	uartswReceiveByte
 1827               		.type	uartswReceiveByte, @function
 1828               	uartswReceiveByte:
 1829               		.stabd	46,0,0
 147:uartsw.c      **** }
 148:uartsw.c      **** 
 149:uartsw.c      **** //! gets a byte (if available) from the uart receive buffer
 150:uartsw.c      **** u08 uartswReceiveByte(u08* rxData)
 151:uartsw.c      **** {
 1830               		.stabn	68,0,151,.LM133-uartswReceiveByte
 1831               	.LM133:
 1832               	/* prologue: frame size=0 */
 1833 0954 CF93      		push r28
 1834 0956 DF93      		push r29
 1835               	/* prologue end (size=2) */
 1836 0958 EC01      		movw r28,r24
 152:uartsw.c      **** 	// make sure we have a receive buffer
 153:uartsw.c      **** 	if(uartswRxBuffer.size)
 1837               		.stabn	68,0,153,.LM134-uartswReceiveByte
 1838               	.LM134:
 1839 095a 8091 0000 		lds r24,uartswRxBuffer+2
 1840 095e 9091 0000 		lds r25,(uartswRxBuffer+2)+1
 1841 0962 892B      		or r24,r25
 1842 0964 71F0      		breq .L107
 154:uartsw.c      **** 	{
 155:uartsw.c      **** 		// make sure we have data
 156:uartsw.c      **** 		if(uartswRxBuffer.datalength)
 1843               		.stabn	68,0,156,.LM135-uartswReceiveByte
 1844               	.LM135:
 1845 0966 8091 0000 		lds r24,uartswRxBuffer+4
 1846 096a 9091 0000 		lds r25,(uartswRxBuffer+4)+1
GAS LISTING /var/tmp//cchOv7GV.s 			page 46


 1847 096e 892B      		or r24,r25
 1848 0970 41F0      		breq .L107
 157:uartsw.c      **** 		{
 158:uartsw.c      **** 			// get byte from beginning of buffer
 159:uartsw.c      **** 			*rxData = bufferGetFromFront(&uartswRxBuffer);
 1849               		.stabn	68,0,159,.LM136-uartswReceiveByte
 1850               	.LM136:
 1851 0972 80E0      		ldi r24,lo8(uartswRxBuffer)
 1852 0974 90E0      		ldi r25,hi8(uartswRxBuffer)
 1853 0976 0E94 0000 		call bufferGetFromFront
 1854 097a 8883      		st Y,r24
 1855 097c 8FEF      		ldi r24,lo8(255)
 1856 097e 90E0      		ldi r25,hi8(255)
 1857 0980 02C0      		rjmp .L110
 1858               	.L107:
 160:uartsw.c      **** 			return TRUE;
 1859               		.stabn	68,0,160,.LM137-uartswReceiveByte
 1860               	.LM137:
 1861 0982 80E0      		ldi r24,lo8(0)
 1862 0984 90E0      		ldi r25,hi8(0)
 1863               	.L110:
 1864               	/* epilogue: frame size=0 */
 1865 0986 DF91      		pop r29
 1866 0988 CF91      		pop r28
 1867 098a 0895      		ret
 1868               	/* epilogue end (size=3) */
 1869               	/* function uartswReceiveByte size 28 (23) */
 1870               		.size	uartswReceiveByte, .-uartswReceiveByte
 1871               	.Lscope13:
 1872               		.stabs	"",36,0,0,.Lscope13-uartswReceiveByte
 1873               		.stabd	78,0,0
 1874               		.stabs	"uartswTxBitService:F(0,15)",36,0,176,uartswTxBitService
 1875               	.global	uartswTxBitService
 1876               		.type	uartswTxBitService, @function
 1877               	uartswTxBitService:
 1878               		.stabd	46,0,0
 161:uartsw.c      **** 		}
 162:uartsw.c      **** 		else
 163:uartsw.c      **** 		{
 164:uartsw.c      **** 			// no data
 165:uartsw.c      **** 			return FALSE;
 166:uartsw.c      **** 		}
 167:uartsw.c      **** 	}
 168:uartsw.c      **** 	else
 169:uartsw.c      **** 	{
 170:uartsw.c      **** 		// no buffer
 171:uartsw.c      **** 		return FALSE;
 172:uartsw.c      **** 	}
 173:uartsw.c      **** }
 174:uartsw.c      **** 
 175:uartsw.c      **** void uartswTxBitService(void)
 176:uartsw.c      **** {
 1879               		.stabn	68,0,176,.LM138-uartswTxBitService
 1880               	.LM138:
 1881               	/* prologue: frame size=0 */
 1882               	/* prologue end (size=0) */
 177:uartsw.c      **** 	if(UartswTxBitNum)
GAS LISTING /var/tmp//cchOv7GV.s 			page 47


 1883               		.stabn	68,0,177,.LM139-uartswTxBitService
 1884               	.LM139:
 1885 098c 8091 0000 		lds r24,UartswTxBitNum
 1886 0990 8823      		tst r24
 1887 0992 11F1      		breq .L113
 178:uartsw.c      **** 	{
 179:uartsw.c      **** 		// there are bits still waiting to be transmitted
 180:uartsw.c      **** 		if(UartswTxBitNum > 1)
 1888               		.stabn	68,0,180,.LM140-uartswTxBitService
 1889               	.LM140:
 1890 0994 8091 0000 		lds r24,UartswTxBitNum
 1891 0998 8230      		cpi r24,lo8(2)
 1892 099a 68F0      		brlo .L115
 181:uartsw.c      **** 		{
 182:uartsw.c      **** 			// transmit data bits (inverted, LSB first)
 183:uartsw.c      **** 			#ifdef UARTSW_INVERT
 184:uartsw.c      **** 			if( !(UartswTxData & 0x01) )
 185:uartsw.c      **** 			#else
 186:uartsw.c      **** 			if( (UartswTxData & 0x01) )
 1893               		.stabn	68,0,186,.LM141-uartswTxBitService
 1894               	.LM141:
 1895 099c 8091 0000 		lds r24,UartswTxData
 1896 09a0 80FF      		sbrs r24,0
 1897 09a2 02C0      		rjmp .L117
 187:uartsw.c      **** 			#endif
 188:uartsw.c      **** 				sbi(UARTSW_TX_PORT, UARTSW_TX_PIN);
 1898               		.stabn	68,0,188,.LM142-uartswTxBitService
 1899               	.LM142:
 1900 09a4 959A      		sbi 50-0x20,5
 1901 09a6 01C0      		rjmp .L119
 1902               	.L117:
 189:uartsw.c      **** 			else
 190:uartsw.c      **** 				cbi(UARTSW_TX_PORT, UARTSW_TX_PIN);
 1903               		.stabn	68,0,190,.LM143-uartswTxBitService
 1904               	.LM143:
 1905 09a8 9598      		cbi 50-0x20,5
 1906               	.L119:
 191:uartsw.c      **** 			// shift bits down
 192:uartsw.c      **** 			UartswTxData = UartswTxData>>1;
 1907               		.stabn	68,0,192,.LM144-uartswTxBitService
 1908               	.LM144:
 1909 09aa 8091 0000 		lds r24,UartswTxData
 1910 09ae 8695      		lsr r24
 1911 09b0 8093 0000 		sts UartswTxData,r24
 1912 09b4 01C0      		rjmp .L120
 1913               	.L115:
 193:uartsw.c      **** 		}
 194:uartsw.c      **** 		else
 195:uartsw.c      **** 		{
 196:uartsw.c      **** 			// transmit stop bit
 197:uartsw.c      **** 			#ifdef UARTSW_INVERT
 198:uartsw.c      **** 			cbi(UARTSW_TX_PORT, UARTSW_TX_PIN);
 199:uartsw.c      **** 			#else
 200:uartsw.c      **** 			sbi(UARTSW_TX_PORT, UARTSW_TX_PIN);
 1914               		.stabn	68,0,200,.LM145-uartswTxBitService
 1915               	.LM145:
 1916 09b6 959A      		sbi 50-0x20,5
GAS LISTING /var/tmp//cchOv7GV.s 			page 48


 1917               	.L120:
 201:uartsw.c      **** 			#endif
 202:uartsw.c      **** 		}
 203:uartsw.c      **** 		// schedule the next bit
 204:uartsw.c      **** 		outw(OCR1A, inw(OCR1A) + UartswBaudRateDiv);
 1918               		.stabn	68,0,204,.LM146-uartswTxBitService
 1919               	.LM146:
 1920 09b8 8AB5      		in r24,74-0x20
 1921 09ba 9BB5      		in r25,(74)+1-0x20
 1922 09bc 2091 0000 		lds r18,UartswBaudRateDiv
 1923 09c0 3091 0000 		lds r19,(UartswBaudRateDiv)+1
 1924 09c4 820F      		add r24,r18
 1925 09c6 931F      		adc r25,r19
 1926 09c8 9BBD      		out (74)+1-0x20,r25
 1927 09ca 8ABD      		out 74-0x20,r24
 205:uartsw.c      **** 		// count down
 206:uartsw.c      **** 		UartswTxBitNum--;
 1928               		.stabn	68,0,206,.LM147-uartswTxBitService
 1929               	.LM147:
 1930 09cc 8091 0000 		lds r24,UartswTxBitNum
 1931 09d0 8150      		subi r24,lo8(-(-1))
 1932 09d2 8093 0000 		sts UartswTxBitNum,r24
 1933 09d6 0895      		ret
 1934               	.L113:
 207:uartsw.c      **** 	}
 208:uartsw.c      **** 	else
 209:uartsw.c      **** 	{
 210:uartsw.c      **** 		// transmission is done
 211:uartsw.c      **** 		// clear busy flag
 212:uartsw.c      **** 		UartswTxBusy = FALSE;
 1935               		.stabn	68,0,212,.LM148-uartswTxBitService
 1936               	.LM148:
 1937 09d8 1092 0000 		sts UartswTxBusy,__zero_reg__
 1938 09dc 0895      		ret
 1939               	/* epilogue: frame size=0 */
 1940               	/* epilogue: noreturn */
 1941               	/* epilogue end (size=0) */
 1942               	/* function uartswTxBitService size 41 (41) */
 1943               		.size	uartswTxBitService, .-uartswTxBitService
 1944               	.Lscope14:
 1945               		.stabs	"",36,0,0,.Lscope14-uartswTxBitService
 1946               		.stabd	78,0,0
 1947               		.stabs	"uartswRxBitService:F(0,15)",36,0,217,uartswRxBitService
 1948               	.global	uartswRxBitService
 1949               		.type	uartswRxBitService, @function
 1950               	uartswRxBitService:
 1951               		.stabd	46,0,0
 213:uartsw.c      **** 	}
 214:uartsw.c      **** }
 215:uartsw.c      **** 
 216:uartsw.c      **** void uartswRxBitService(void)
 217:uartsw.c      **** {
 1952               		.stabn	68,0,217,.LM149-uartswRxBitService
 1953               	.LM149:
 1954               	/* prologue: frame size=0 */
 1955 09de 1F93      		push r17
 1956 09e0 CF93      		push r28
GAS LISTING /var/tmp//cchOv7GV.s 			page 49


 1957 09e2 DF93      		push r29
 1958               	/* prologue end (size=3) */
 218:uartsw.c      **** 	// this function runs on either:
 219:uartsw.c      **** 	// - a rising edge interrupt
 220:uartsw.c      **** 	// - OC1B
 221:uartsw.c      **** 	u08 c=0;
 222:uartsw.c      **** 	u08 string_length;
 223:uartsw.c      **** 	
 224:uartsw.c      **** 	if(!UartswRxBusy)
 1959               		.stabn	68,0,224,.LM150-uartswRxBitService
 1960               	.LM150:
 1961 09e4 8091 0000 		lds r24,UartswRxBusy
 1962 09e8 8823      		tst r24
 1963 09ea 19F5      		brne .L124
 225:uartsw.c      **** 	{
 226:uartsw.c      **** 		// this is a start bit
 227:uartsw.c      **** 		// disable ICP interrupt
 228:uartsw.c      **** 		cbi(TIMSK, TICIE1);
 1964               		.stabn	68,0,228,.LM151-uartswRxBitService
 1965               	.LM151:
 1966 09ec 89B7      		in r24,89-0x20
 1967 09ee 8F7D      		andi r24,lo8(-33)
 1968 09f0 89BF      		out 89-0x20,r24
 229:uartsw.c      **** 		// schedule data bit sampling 1.5 bit periods from now
 230:uartsw.c      **** 		outw(OCR1B, inw(TCNT1) + UartswBaudRateDiv + UartswBaudRateDiv/2);
 1969               		.stabn	68,0,230,.LM152-uartswRxBitService
 1970               	.LM152:
 1971 09f2 2CB5      		in r18,76-0x20
 1972 09f4 3DB5      		in r19,(76)+1-0x20
 1973 09f6 4091 0000 		lds r20,UartswBaudRateDiv
 1974 09fa 5091 0000 		lds r21,(UartswBaudRateDiv)+1
 1975 09fe 8091 0000 		lds r24,UartswBaudRateDiv
 1976 0a02 9091 0000 		lds r25,(UartswBaudRateDiv)+1
 1977 0a06 240F      		add r18,r20
 1978 0a08 351F      		adc r19,r21
 1979 0a0a 9695      		lsr r25
 1980 0a0c 8795      		ror r24
 1981 0a0e 280F      		add r18,r24
 1982 0a10 391F      		adc r19,r25
 1983 0a12 39BD      		out (72)+1-0x20,r19
 1984 0a14 28BD      		out 72-0x20,r18
 231:uartsw.c      **** 		// clear OC1B interrupt flag
 232:uartsw.c      **** 		sbi(TIFR, OCF1B);
 1985               		.stabn	68,0,232,.LM153-uartswRxBitService
 1986               	.LM153:
 1987 0a16 88B7      		in r24,88-0x20
 1988 0a18 8860      		ori r24,lo8(8)
 1989 0a1a 88BF      		out 88-0x20,r24
 233:uartsw.c      **** 		// enable OC1B interrupt
 234:uartsw.c      **** 		sbi(TIMSK, OCIE1B);
 1990               		.stabn	68,0,234,.LM154-uartswRxBitService
 1991               	.LM154:
 1992 0a1c 89B7      		in r24,89-0x20
 1993 0a1e 8860      		ori r24,lo8(8)
 1994 0a20 89BF      		out 89-0x20,r24
 235:uartsw.c      **** 		// set start bit flag
 236:uartsw.c      **** 		UartswRxBusy = TRUE;
GAS LISTING /var/tmp//cchOv7GV.s 			page 50


 1995               		.stabn	68,0,236,.LM155-uartswRxBitService
 1996               	.LM155:
 1997 0a22 8FEF      		ldi r24,lo8(-1)
 1998 0a24 8093 0000 		sts UartswRxBusy,r24
 237:uartsw.c      **** 		// reset bit counter
 238:uartsw.c      **** 		UartswRxBitNum = 0;
 1999               		.stabn	68,0,238,.LM156-uartswRxBitService
 2000               	.LM156:
 2001 0a28 1092 0000 		sts UartswRxBitNum,__zero_reg__
 239:uartsw.c      **** 		// reset data
 240:uartsw.c      **** 		UartswRxData = 0;
 2002               		.stabn	68,0,240,.LM157-uartswRxBitService
 2003               	.LM157:
 2004 0a2c 1092 0000 		sts UartswRxData,__zero_reg__
 2005 0a30 72C0      		rjmp .L140
 2006               	.L124:
 241:uartsw.c      **** 	}
 242:uartsw.c      **** 	else
 243:uartsw.c      **** 	{
 244:uartsw.c      **** 		// start bit has already been received
 245:uartsw.c      **** 		// we're in the data bits
 246:uartsw.c      **** 		
 247:uartsw.c      **** 		// shift data byte to make room for new bit
 248:uartsw.c      **** 		UartswRxData = UartswRxData>>1;
 2007               		.stabn	68,0,248,.LM158-uartswRxBitService
 2008               	.LM158:
 2009 0a32 8091 0000 		lds r24,UartswRxData
 2010 0a36 8695      		lsr r24
 2011 0a38 8093 0000 		sts UartswRxData,r24
 249:uartsw.c      **** 
 250:uartsw.c      **** 		// sample the data line
 251:uartsw.c      **** 		#ifdef UARTSW_INVERT
 252:uartsw.c      **** 		if( !(inb(UARTSW_RX_PORTIN) & (1<<UARTSW_RX_PIN)) )
 253:uartsw.c      **** 		#else
 254:uartsw.c      **** 		if( (inb(UARTSW_RX_PORTIN) & (1<<UARTSW_RX_PIN)) )
 2012               		.stabn	68,0,254,.LM159-uartswRxBitService
 2013               	.LM159:
 2014 0a3c 869B      		sbis 48-0x20,6
 2015 0a3e 05C0      		rjmp .L127
 255:uartsw.c      **** 		#endif
 256:uartsw.c      **** 		{
 257:uartsw.c      **** 			// serial line is marking
 258:uartsw.c      **** 			// record '1' bit
 259:uartsw.c      **** 			UartswRxData |= 0x80;
 2016               		.stabn	68,0,259,.LM160-uartswRxBitService
 2017               	.LM160:
 2018 0a40 8091 0000 		lds r24,UartswRxData
 2019 0a44 8068      		ori r24,lo8(-128)
 2020 0a46 8093 0000 		sts UartswRxData,r24
 2021               	.L127:
 260:uartsw.c      **** 		}
 261:uartsw.c      **** 
 262:uartsw.c      **** 		// increment bit counter
 263:uartsw.c      **** 		UartswRxBitNum++;
 2022               		.stabn	68,0,263,.LM161-uartswRxBitService
 2023               	.LM161:
 2024 0a4a 8091 0000 		lds r24,UartswRxBitNum
GAS LISTING /var/tmp//cchOv7GV.s 			page 51


 2025 0a4e 8F5F      		subi r24,lo8(-(1))
 2026 0a50 8093 0000 		sts UartswRxBitNum,r24
 264:uartsw.c      **** 		// schedule next bit sample
 265:uartsw.c      **** 		outw(OCR1B, inw(OCR1B) + UartswBaudRateDiv);
 2027               		.stabn	68,0,265,.LM162-uartswRxBitService
 2028               	.LM162:
 2029 0a54 88B5      		in r24,72-0x20
 2030 0a56 99B5      		in r25,(72)+1-0x20
 2031 0a58 2091 0000 		lds r18,UartswBaudRateDiv
 2032 0a5c 3091 0000 		lds r19,(UartswBaudRateDiv)+1
 2033 0a60 820F      		add r24,r18
 2034 0a62 931F      		adc r25,r19
 2035 0a64 99BD      		out (72)+1-0x20,r25
 2036 0a66 88BD      		out 72-0x20,r24
 266:uartsw.c      **** 
 267:uartsw.c      **** 		// check if we have a full byte
 268:uartsw.c      **** 		if(UartswRxBitNum >= 8)
 2037               		.stabn	68,0,268,.LM163-uartswRxBitService
 2038               	.LM163:
 2039 0a68 8091 0000 		lds r24,UartswRxBitNum
 2040 0a6c 8830      		cpi r24,lo8(8)
 2041 0a6e 08F4      		brsh .+2
 2042 0a70 52C0      		rjmp .L140
 269:uartsw.c      **** 		{
 270:uartsw.c      **** 			// save data in receive buffer
 271:uartsw.c      **** 			// if \r then add to our 'sentence' buffer
 272:uartsw.c      **** 			if(UartswRxData == ',')
 2043               		.stabn	68,0,272,.LM164-uartswRxBitService
 2044               	.LM164:
 2045 0a72 8091 0000 		lds r24,UartswRxData
 2046 0a76 8C32      		cpi r24,lo8(44)
 2047 0a78 D9F4      		brne .L130
 273:uartsw.c      **** 			{
 274:uartsw.c      **** 				if(uartswRxBuffer.datalength<8)
 2048               		.stabn	68,0,274,.LM165-uartswRxBitService
 2049               	.LM165:
 2050 0a7a 8091 0000 		lds r24,uartswRxBuffer+4
 2051 0a7e 9091 0000 		lds r25,(uartswRxBuffer+4)+1
 2052 0a82 0897      		sbiw r24,8
 2053 0a84 40F4      		brsh .L132
 275:uartsw.c      **** 				{
 276:uartsw.c      **** 					bufferAddToEnd(&uartswRxBuffer, UartswRxData);
 2054               		.stabn	68,0,276,.LM166-uartswRxBitService
 2055               	.LM166:
 2056 0a86 6091 0000 		lds r22,UartswRxData
 2057 0a8a 80E0      		ldi r24,lo8(uartswRxBuffer)
 2058 0a8c 90E0      		ldi r25,hi8(uartswRxBuffer)
 2059 0a8e 0E94 0000 		call bufferAddToEnd
 277:uartsw.c      **** 					bufferAddToEnd(&uartswRxBuffer, 'q');
 2060               		.stabn	68,0,277,.LM167-uartswRxBitService
 2061               	.LM167:
 2062 0a92 61E7      		ldi r22,lo8(113)
 2063 0a94 07C0      		rjmp .L144
 2064               	.L132:
 278:uartsw.c      **** 					bufferAddToEnd(&uartswRxBuffer, ' ');
 279:uartsw.c      **** 				}
 280:uartsw.c      **** 				else
GAS LISTING /var/tmp//cchOv7GV.s 			page 52


 281:uartsw.c      **** 				{
 282:uartsw.c      **** 					bufferAddToEnd(&uartswRxBuffer, UartswRxData);
 2065               		.stabn	68,0,282,.LM168-uartswRxBitService
 2066               	.LM168:
 2067 0a96 6091 0000 		lds r22,UartswRxData
 2068 0a9a 80E0      		ldi r24,lo8(uartswRxBuffer)
 2069 0a9c 90E0      		ldi r25,hi8(uartswRxBuffer)
 2070 0a9e 0E94 0000 		call bufferAddToEnd
 283:uartsw.c      **** 					bufferAddToEnd(&uartswRxBuffer, 'w');
 2071               		.stabn	68,0,283,.LM169-uartswRxBitService
 2072               	.LM169:
 2073 0aa2 67E7      		ldi r22,lo8(119)
 2074               	.L144:
 2075 0aa4 80E0      		ldi r24,lo8(uartswRxBuffer)
 2076 0aa6 90E0      		ldi r25,hi8(uartswRxBuffer)
 2077 0aa8 0E94 0000 		call bufferAddToEnd
 284:uartsw.c      **** 					bufferAddToEnd(&uartswRxBuffer, ' ');
 2078               		.stabn	68,0,284,.LM170-uartswRxBitService
 2079               	.LM170:
 2080 0aac 60E2      		ldi r22,lo8(32)
 2081 0aae 24C0      		rjmp .L143
 2082               	.L130:
 285:uartsw.c      **** 				}
 286:uartsw.c      **** 			}
 287:uartsw.c      **** 			//Since device sends /r/n, /r is used to xfer all data to the storage buffer (sentence)
 288:uartsw.c      **** 			//This would be a good place to store them into a variable instead, and parse
 289:uartsw.c      **** 			//But for now it would save time to fix it in the python instead.
 290:uartsw.c      **** 			else if(UartswRxData == '\r') 
 2083               		.stabn	68,0,290,.LM171-uartswRxBitService
 2084               	.LM171:
 2085 0ab0 8091 0000 		lds r24,UartswRxData
 2086 0ab4 8D30      		cpi r24,lo8(13)
 2087 0ab6 D1F4      		brne .L135
 291:uartsw.c      **** 			{
 292:uartsw.c      **** 				string_length = uartswRxBuffer.datalength;
 2088               		.stabn	68,0,292,.LM172-uartswRxBitService
 2089               	.LM172:
 2090 0ab8 1091 0000 		lds r17,uartswRxBuffer+4
 2091 0abc C0E0      		ldi r28,lo8(0)
 2092 0abe D0E0      		ldi r29,hi8(0)
 2093               	.L137:
 293:uartsw.c      **** 				for(c=0;c<=string_length;++c)
 294:uartsw.c      **** 				{
 295:uartsw.c      **** 					sentence[c] = bufferGetFromFront(&uartswRxBuffer);
 2094               		.stabn	68,0,295,.LM173-uartswRxBitService
 2095               	.LM173:
 2096 0ac0 80E0      		ldi r24,lo8(uartswRxBuffer)
 2097 0ac2 90E0      		ldi r25,hi8(uartswRxBuffer)
 2098 0ac4 0E94 0000 		call bufferGetFromFront
 2099 0ac8 EC2F      		mov r30,r28
 2100 0aca FF27      		clr r31
 2101 0acc E050      		subi r30,lo8(-(sentence))
 2102 0ace F040      		sbci r31,hi8(-(sentence))
 2103 0ad0 8083      		st Z,r24
 2104 0ad2 2196      		adiw r28,1
 2105               		.stabn	68,0,293,.LM174-uartswRxBitService
 2106               	.LM174:
GAS LISTING /var/tmp//cchOv7GV.s 			page 53


 2107 0ad4 1C17      		cp r17,r28
 2108 0ad6 A0F7      		brsh .L137
 296:uartsw.c      **** 				}
 297:uartsw.c      **** 				sentence[c] = '\0';
 2109               		.stabn	68,0,297,.LM175-uartswRxBitService
 2110               	.LM175:
 2111 0ad8 EC2F      		mov r30,r28
 2112 0ada FF27      		clr r31
 2113 0adc E050      		subi r30,lo8(-(sentence))
 2114 0ade F040      		sbci r31,hi8(-(sentence))
 2115 0ae0 1082      		st Z,__zero_reg__
 298:uartsw.c      **** 				bufferFlush(&uartswRxBuffer);
 2116               		.stabn	68,0,298,.LM176-uartswRxBitService
 2117               	.LM176:
 2118 0ae2 80E0      		ldi r24,lo8(uartswRxBuffer)
 2119 0ae4 90E0      		ldi r25,hi8(uartswRxBuffer)
 2120 0ae6 0E94 0000 		call bufferFlush
 2121 0aea 0AC0      		rjmp .L134
 2122               	.L135:
 299:uartsw.c      **** 				
 300:uartsw.c      **** 			}
 301:uartsw.c      **** 			else
 302:uartsw.c      **** 				if(UartswRxData != '\n') bufferAddToEnd(&uartswRxBuffer, UartswRxData); // save data in receive
 2123               		.stabn	68,0,302,.LM177-uartswRxBitService
 2124               	.LM177:
 2125 0aec 8091 0000 		lds r24,UartswRxData
 2126 0af0 8A30      		cpi r24,lo8(10)
 2127 0af2 31F0      		breq .L134
 2128 0af4 6091 0000 		lds r22,UartswRxData
 2129               	.L143:
 2130 0af8 80E0      		ldi r24,lo8(uartswRxBuffer)
 2131 0afa 90E0      		ldi r25,hi8(uartswRxBuffer)
 2132 0afc 0E94 0000 		call bufferAddToEnd
 2133               	.L134:
 303:uartsw.c      **** 			// disable OC1B interrupt
 304:uartsw.c      **** 			cbi(TIMSK, OCIE1B);
 2134               		.stabn	68,0,304,.LM178-uartswRxBitService
 2135               	.LM178:
 2136 0b00 89B7      		in r24,89-0x20
 2137 0b02 877F      		andi r24,lo8(-9)
 2138 0b04 89BF      		out 89-0x20,r24
 305:uartsw.c      **** 			// clear ICP interrupt flag
 306:uartsw.c      **** 			sbi(TIFR, ICF1);
 2139               		.stabn	68,0,306,.LM179-uartswRxBitService
 2140               	.LM179:
 2141 0b06 88B7      		in r24,88-0x20
 2142 0b08 8062      		ori r24,lo8(32)
 2143 0b0a 88BF      		out 88-0x20,r24
 307:uartsw.c      **** 			// enable ICP interrupt
 308:uartsw.c      **** 			sbi(TIMSK, TICIE1);
 2144               		.stabn	68,0,308,.LM180-uartswRxBitService
 2145               	.LM180:
 2146 0b0c 89B7      		in r24,89-0x20
 2147 0b0e 8062      		ori r24,lo8(32)
 2148 0b10 89BF      		out 89-0x20,r24
 309:uartsw.c      **** 			// clear start bit flag
 310:uartsw.c      **** 			UartswRxBusy = FALSE;
GAS LISTING /var/tmp//cchOv7GV.s 			page 54


 2149               		.stabn	68,0,310,.LM181-uartswRxBitService
 2150               	.LM181:
 2151 0b12 1092 0000 		sts UartswRxBusy,__zero_reg__
 2152               	.L140:
 2153               	/* epilogue: frame size=0 */
 2154 0b16 DF91      		pop r29
 2155 0b18 CF91      		pop r28
 2156 0b1a 1F91      		pop r17
 2157 0b1c 0895      		ret
 2158               	/* epilogue end (size=4) */
 2159               	/* function uartswRxBitService size 161 (154) */
 2160               		.size	uartswRxBitService, .-uartswRxBitService
 2161               		.stabs	"string_length:r(7,1)",64,0,222,17
 2162               		.stabn	192,0,0,uartswRxBitService-uartswRxBitService
 2163               		.stabn	224,0,0,.Lscope15-uartswRxBitService
 2164               	.Lscope15:
 2165               		.stabs	"",36,0,0,.Lscope15-uartswRxBitService
 2166               		.stabd	78,0,0
 2167               		.section	.progmem.data,"a",@progbits
 2168               		.type	__c.2588, @object
 2169               		.size	__c.2588, 46
 2170               	__c.2588:
 2171 0000 0D0A 2057 		.string	"\r\n We come in peace!  We mean you no harm.\r\n "
 2171      6520 636F 
 2171      6D65 2069 
 2171      6E20 7065 
 2171      6163 6521 
 2172               		.type	__c.2585, @object
 2173               		.size	__c.2585, 46
 2174               	__c.2585:
 2175 002e 0D0A 2057 		.string	"\r\n We come in peace!  We mean you no harm.\r\n "
 2175      6520 636F 
 2175      6D65 2069 
 2175      6E20 7065 
 2175      6163 6521 
 2176               		.type	__c.2582, @object
 2177               		.size	__c.2582, 131
 2178               	__c.2582:
 2179 005c 0D0A 5768 		.ascii	"\r\nWhat do we want?  Heybeas corpuss!  When do we want it? "
 2179      6174 2064 
 2179      6F20 7765 
 2179      2077 616E 
 2179      743F 2020 
 2180 0096 2057 6520 		.ascii	" We alre"
 2180      616C 7265 
 2181 009e 6164 7920 		.string	"ady have the right, but the right is being illegaly violated!\r\n "
 2181      6861 7665 
 2181      2074 6865 
 2181      2072 6967 
 2181      6874 2C20 
 2182               		.type	__c.2579, @object
 2183               		.size	__c.2579, 88
 2184               	__c.2579:
 2185 00df 0D0A 2043 		.ascii	"\r\n Close Guantanamo Now"
 2185      6C6F 7365 
 2185      2047 7561 
 2185      6E74 616E 
GAS LISTING /var/tmp//cchOv7GV.s 			page 55


 2185      616D 6F20 
 2186 00f6 2120 2049 		.string	"!  It is illegal, immoral, and hurting our national security!\r\n "
 2186      7420 6973 
 2186      2069 6C6C 
 2186      6567 616C 
 2186      2C20 696D 
 2187               		.type	__c.2575, @object
 2188               		.size	__c.2575, 49
 2189               	__c.2575:
 2190 0137 0D0A 2052 		.string	"\r\n Restore heybeas corpuss! Stop the torture!\r\n "
 2190      6573 746F 
 2190      7265 2068 
 2190      6579 6265 
 2190      6173 2063 
 2191               		.text
 2192               		.stabs	"sendTextMessage:F(0,15)",36,0,257,sendTextMessage
 2193               		.stabs	"theMessage:P(0,11)",64,0,256,24
 2194               	.global	sendTextMessage
 2195               		.type	sendTextMessage, @function
 2196               	sendTextMessage:
 2197               		.stabd	46,0,0
 2198               		.stabs	"gpstest.c",132,0,0,.Ltext4
 2199               	.Ltext4:
   1:gpstest.c     **** //Integration test of GPs nmea parse code with No.6
   2:gpstest.c     **** //Last Modified 19Sep06 jlev
   3:gpstest.c     ****  
   4:gpstest.c     **** //----- Include Files ---------------------------------------------------------
   5:gpstest.c     **** #include <avr/io.h>		// include I/O definitions (port names, pin names, etc)
   6:gpstest.c     **** #include <avr/signal.h>	// include "signal" names (interrupt names)
   7:gpstest.c     **** #include <avr/interrupt.h>	// include interrupt support
   8:gpstest.c     **** #include "uart.h"		// include uart function library
   9:gpstest.c     **** #include "rprintf.h"	// include printf function library
  10:gpstest.c     **** #include "timer.h"		// include timer function library
  11:gpstest.c     **** #include "global.h"		// include our global settings
  12:gpstest.c     **** #include "string.h"		// use for strlen()
  13:gpstest.c     **** #include "video.h"  //user video thingy
  14:gpstest.c     **** 
  15:gpstest.c     **** 
  16:gpstest.c     **** //our nmea includes
  17:gpstest.c     **** #include "nmeap.h"
  18:gpstest.c     **** #include "nmeap_def.h"
  19:gpstest.c     **** #include "nmeap01.c"
  20:gpstest.c     **** #include "gpsmath.c"
  21:gpstest.c     **** 
  22:gpstest.c     **** //software uart includes
  23:gpstest.c     **** #include "uartswconf.h"
  24:gpstest.c     **** #include "uartsw.h"
  25:gpstest.c     **** #include "uartsw.c"
  26:gpstest.c     **** 
  27:gpstest.c     **** //i2c includes
  28:gpstest.c     **** #include "i2c.h"		// include i2c support
  29:gpstest.c     **** #define LOCAL_ADDR		0xA0
  30:gpstest.c     **** //#define RPRINTF_FLOAT	TRUE	//This allows rprintf to print floats -- useful for lats/longs
  31:gpstest.c     **** 
  32:gpstest.c     **** //#define USE_VID_CARD
  33:gpstest.c     **** #define USE_VOICE_BOX
  34:gpstest.c     **** unsigned char voiceBoxCue;
GAS LISTING /var/tmp//cchOv7GV.s 			page 56


  35:gpstest.c     **** 
  36:gpstest.c     **** unsigned char localBuffer[] = "This should be filling with data!";
  37:gpstest.c     **** unsigned char localBufferLength = 0x20;
  38:gpstest.c     **** 
  39:gpstest.c     **** static nmeap_context_t nmea;	//parser context
  40:gpstest.c     **** static int user_data;			//not sure what this is for...
  41:gpstest.c     **** static nmeap_gga_t     gga;     //data buffer for GGA sentences
  42:gpstest.c     **** static nmeap_rmc_t     rmc;     //data buffer for RMC sentences
  43:gpstest.c     **** 
  44:gpstest.c     **** static cBuffer gpsBuffer; //serial receive buffer
  45:gpstest.c     **** static char gpsBufferData[UART_RX_BUFFER_SIZE]; //allocate space in ram for buffer
  46:gpstest.c     **** void addToBuffer(unsigned char ch); //the interrupt handler
  47:gpstest.c     **** 
  48:gpstest.c     **** //i2c routines
  49:gpstest.c     **** void i2cSlaveReceiveService(u08 receiveDataLength, u08* receiveData);
  50:gpstest.c     **** u08 i2cSlaveTransmitService(u08 transmitDataLengthMax, u08* transmitData);
  51:gpstest.c     **** u08 message_sent;
  52:gpstest.c     **** void initVoiceBox(void);
  53:gpstest.c     **** 
  54:gpstest.c     **** //printing to array routines.  these are used to print floats to the i2c, since sprintf doesn't wor
  55:gpstest.c     **** //instead, we set rprintfinit(print_to_string), then at the end have a string that we send to the i
  56:gpstest.c     **** #define stackem_length 0x20
  57:gpstest.c     **** u08 stackem[stackem_length];
  58:gpstest.c     **** u08 stackem_pointer = 0;
  59:gpstest.c     **** void print_to_string(u08 the_char);
  60:gpstest.c     **** void sendTextMessage(u08);
  61:gpstest.c     **** 
  62:gpstest.c     **** //For voice box
  63:gpstest.c     **** #define CTRLA = 0x01
  64:gpstest.c     **** 
  65:gpstest.c     **** //----- Begin Code ------------------------------------------------------------
  66:gpstest.c     **** int main(void)
  67:gpstest.c     **** {
  68:gpstest.c     **** 	int status;
  69:gpstest.c     ****     // Test of csik's gps math code
  70:gpstest.c     ****     struct waypoint from,to;
  71:gpstest.c     ****     //from.lat = 50.0912;
  72:gpstest.c     ****     //from.lon = -001.50;
  73:gpstest.c     ****     // set when we get valid GPS
  74:gpstest.c     **** 	to.lat = 42.359051;
  75:gpstest.c     ****     to.lon = -71.093355;
  76:gpstest.c     **** 	// 77 Mass Ave, taken off Google Maps
  77:gpstest.c     ****     
  78:gpstest.c     **** 	//initialize i2c message_sent to 0 to see if we're getting messages...
  79:gpstest.c     **** 	message_sent = 0;
  80:gpstest.c     ****  
  81:gpstest.c     ****    
  82:gpstest.c     ****     //set uart receive rate to output from GPS
  83:gpstest.c     **** 
  84:gpstest.c     **** 	// initialize our libraries
  85:gpstest.c     **** 	// initialize the UART (serial port)
  86:gpstest.c     **** 	uartInit();
  87:gpstest.c     **** 	timerInit();
  88:gpstest.c     ****  	timerPause(500);
  89:gpstest.c     **** 
  90:gpstest.c     **** 
  91:gpstest.c     **** #ifdef USE_VOICE_BOX
GAS LISTING /var/tmp//cchOv7GV.s 			page 57


  92:gpstest.c     **** 	////PRE_INIT FOR THE V8699A VOICE SYNTH//////////////////////////////
  93:gpstest.c     **** 	uartSetBaudRate(4800);
  94:gpstest.c     **** 	// make all rprintf statements use uart for output
  95:gpstest.c     **** 	rprintfInit(uartSendByte);
  96:gpstest.c     **** 	initVoiceBox();
  97:gpstest.c     **** 	voiceBoxCue = 'x';
  98:gpstest.c     **** #endif /* USE_VOICE_BOX */
  99:gpstest.c     **** 
 100:gpstest.c     **** ////// initialize the timer system
 101:gpstest.c     **** 
 102:gpstest.c     **** 
 103:gpstest.c     **** #ifdef USE_VIDEO_CARD
 104:gpstest.c     **** 	////PRE_INIT FOR THE VIDEO CARD//////////////////////////////
 105:gpstest.c     **** 	uartSetBaudRate(2400);
 106:gpstest.c     **** 	// make all rprintf statements use uart for output
 107:gpstest.c     **** 	rprintfInit(uartSendByte);
 108:gpstest.c     **** 	initVideo();
 109:gpstest.c     **** 	//////////////////////////////////////////////////////////////
 110:gpstest.c     **** 	uartSetBaudRate(4800);
 111:gpstest.c     **** 	// make all rprintf statements use uart for output
 112:gpstest.c     **** 	rprintfInit(uartSendByte);
 113:gpstest.c     **** 	// initialize the timer syste
 114:gpstest.c     **** #endif /* USE_VIDEO_CARD */
 115:gpstest.c     **** 	
 116:gpstest.c     **** 	// print a little intro message so we know things are working
 117:gpstest.c     **** #ifndef USE_VID_CARD 
 118:gpstest.c     **** 	// print an intro message
 119:gpstest.c     **** 	rprintf("\r\nWelcome to GPS subsystem!\r\n");
 120:gpstest.c     **** #endif /* USE_VID_CARD */
 121:gpstest.c     **** 
 122:gpstest.c     **** 
 123:gpstest.c     **** 
 124:gpstest.c     **** ////// initialize software uart
 125:gpstest.c     **** 	uartswInit();
 126:gpstest.c     **** 	uartswSetBaudRate(19200);
 127:gpstest.c     **** 
 128:gpstest.c     **** ////// initialize i2c///////////////////////////////////////////////////////////////////
 129:gpstest.c     **** 	// initialize i2c function library
 130:gpstest.c     **** 	i2cInit();
 131:gpstest.c     **** 	// set local device address and allow response to general call
 132:gpstest.c     **** 	i2cSetLocalDeviceAddr(LOCAL_ADDR, TRUE);
 133:gpstest.c     **** 	// set the Slave Receive Handler function
 134:gpstest.c     **** 	// (this function will run whenever a master somewhere else on the bus
 135:gpstest.c     **** 	//  writes data to us as a slave)
 136:gpstest.c     **** 	i2cSetSlaveReceiveHandler( i2cSlaveReceiveService );
 137:gpstest.c     **** 	// set the Slave Transmit Handler function
 138:gpstest.c     **** 	// (this function will run whenever a master somewhere else on the bus
 139:gpstest.c     **** 	//  attempts to read data from us as a slave)
 140:gpstest.c     **** 	i2cSetSlaveTransmitHandler( i2cSlaveTransmitService );
 141:gpstest.c     **** 	
 142:gpstest.c     **** 	
 143:gpstest.c     ****    	//initialize the gps receive buffer
 144:gpstest.c     ****    	bufferInit(&gpsBuffer,gpsBufferData,UART_RX_BUFFER_SIZE);
 145:gpstest.c     **** 
 146:gpstest.c     **** 	uartSetRxHandler(addToBuffer); //custom handler	
 147:gpstest.c     **** 	
 148:gpstest.c     **** 	//rprintf("set handler\r\n");
GAS LISTING /var/tmp//cchOv7GV.s 			page 58


 149:gpstest.c     **** 	
 150:gpstest.c     **** 	//initialize gps library
 151:gpstest.c     **** 	status = nmeap_init(&nmea,&user_data);
 152:gpstest.c     **** 	if (status != 0) {
 153:gpstest.c     ****         rprintf("nmeap_init %d\n",status);
 154:gpstest.c     ****     }
 155:gpstest.c     ****    	// initialize gps parsers 
 156:gpstest.c     **** 	status = nmeap_addParser(&nmea,"GPGGA",nmeap_gpgga,0,&gga);
 157:gpstest.c     **** 	if (status != 0) {
 158:gpstest.c     ****         rprintf("nmeap_add GGA %d\n",status);
 159:gpstest.c     ****     }
 160:gpstest.c     ****     status = nmeap_addParser(&nmea,"GPRMC",nmeap_gprmc,0,&rmc);
 161:gpstest.c     ****     if (status != 0) {
 162:gpstest.c     ****         rprintf("nmeap_add RMC %d\n",status);
 163:gpstest.c     ****     }
 164:gpstest.c     **** 	// WHAT IS THIS?????
 165:gpstest.c     **** 	//rprintf("gga.latitude = ");
 166:gpstest.c     **** 	//rprintfFloat(8,gga.latitude);
 167:gpstest.c     **** 	//rprintf("\r\n");
 168:gpstest.c     **** 	
 169:gpstest.c     **** 	for(;;) {
 170:gpstest.c     **** 		//set up variables for access by spi routine
 171:gpstest.c     **** 		float latitude, longitude, altitude, speed;
 172:gpstest.c     **** 		//make sure we have data
 173:gpstest.c     **** 		char ch = bufferGetFromFront(&gpsBuffer);
 174:gpstest.c     **** 		if(ch != 0) {
 175:gpstest.c     **** 				//rprintf("%c",ch); //debug
 176:gpstest.c     **** 				status = nmeap_parse(&nmea,ch);
 177:gpstest.c     **** 				switch(status) {
 178:gpstest.c     **** 					case NMEAP_GPGGA:
 179:gpstest.c     **** #ifdef USE_VID_CARD
 180:gpstest.c     **** 						writeVideoScreen(gga.latitude, gga.longitude, gga.time, gga.altitude, rmc.course, rmc.speed, 
 181:gpstest.c     **** #endif /* end USE_VID_CARD*/
 182:gpstest.c     **** #ifdef USE_TERMINAL
 183:gpstest.c     **** 						rprintf("GGA");
 184:gpstest.c     **** 						rprintf("\tLat: ");
 185:gpstest.c     **** 						rprintfFloat(8,gga.latitude);
 186:gpstest.c     **** 						rprintf(" Lon: ");
 187:gpstest.c     **** 						rprintfFloat(8,gga.longitude);
 188:gpstest.c     **** 						rprintf(" Alt: ");
 189:gpstest.c     **** 						rprintfFloat(8,gga.altitude);
 190:gpstest.c     **** 						rprintf("\r\n");
 191:gpstest.c     **** 						
 192:gpstest.c     **** 						//print distance to 77 Mass Ave
 193:gpstest.c     **** 						from.lat = gga.latitude;
 194:gpstest.c     **** 						from.lon = gga.longitude;
 195:gpstest.c     **** 						rprintf("Dist to 77 (km): ");
 196:gpstest.c     **** 						rprintfFloat(8,dist(from,to));
 197:gpstest.c     **** 						rprintf("\r\n");
 198:gpstest.c     **** 						rprintf("Bearing to 77 (deg): ");
 199:gpstest.c     **** 						rprintfFloat(8,bearing(from,to));
 200:gpstest.c     **** 						rprintf("\r\n\r\n");
 201:gpstest.c     **** #endif /* end USE_TERMINAL */
 202:gpstest.c     **** 						break;
 203:gpstest.c     **** 					case NMEAP_GPRMC:
 204:gpstest.c     **** #ifdef USE_VID_CARD
 205:gpstest.c     **** 						writeVideoScreen(gga.latitude, gga.longitude, gga.time, gga.altitude, rmc.course, rmc.speed, 
GAS LISTING /var/tmp//cchOv7GV.s 			page 59


 206:gpstest.c     **** #endif /* USE_VID_CARD */
 207:gpstest.c     **** 
 208:gpstest.c     **** #ifdef USE_TERMINAL
 209:gpstest.c     **** 						rprintf("RMC");
 210:gpstest.c     **** 						//rprintf("\tLat: ");
 211:gpstest.c     **** 						//rprintfFloat(8,rmc.latitude);
 212:gpstest.c     **** 						//rprintf(" Lon: ");
 213:gpstest.c     **** 						//rprintfFloat(8,rmc.longitude);
 214:gpstest.c     **** 						rprintf(" Vel (kt): ");
 215:gpstest.c     **** 						rprintfFloat(8,rmc.speed);
 216:gpstest.c     **** 						rprintf(" Course over ground (deg): ");
 217:gpstest.c     **** 						rprintfFloat(8,rmc.course);
 218:gpstest.c     **** 						rprintf("\r\n");
 219:gpstest.c     **** #endif /* end using terminal */
 220:gpstest.c     **** 						break;
 221:gpstest.c     **** 					default:
 222:gpstest.c     **** 						break;
 223:gpstest.c     **** 			        } //end switch	
 224:gpstest.c     **** 			
 225:gpstest.c     **** 			}//	end if(ch != 0)
 226:gpstest.c     **** 			
 227:gpstest.c     **** 			//  here one would write to the video and the i2c buffer... set a mutex?  in other words, we wan
 228:gpstest.c     **** 			// use two data objects, write back and forth and switch in a single operation?
 229:gpstest.c     **** 			// write a make a readable write b make b readable
 230:gpstest.c     **** 			// writeVideoScreen(gga.latitude, gga.longitude, gga.altitude, speed, char ERROR)
 231:gpstest.c     **** 			
 232:gpstest.c     **** 			// OR, should the master give a character and then receive a value?
 233:gpstest.c     **** 			// that would seem to make more sense, but it means sort of immediate updates...
 234:gpstest.c     **** 			//rprintf("%c\r\n",voiceBoxCue);
 235:gpstest.c     **** 			//This should cue for the voice box...
 236:gpstest.c     **** 			if(voiceBoxCue != 'x')
 237:gpstest.c     **** 			{
 238:gpstest.c     **** 				sendTextMessage(voiceBoxCue);
 239:gpstest.c     **** 			}
 240:gpstest.c     **** 
 241:gpstest.c     **** 			if(message_sent != 0)
 242:gpstest.c     **** 			{
 243:gpstest.c     **** 				message_sent = 1;
 244:gpstest.c     **** 				rprintf("\r\nsent i2c!");
 245:gpstest.c     **** 			}
 246:gpstest.c     **** 	} //end for
 247:gpstest.c     **** 	
 248:gpstest.c     **** 	return 0;
 249:gpstest.c     **** }
 250:gpstest.c     **** /*
 251:gpstest.c     **** #define  h "Restore Habeas Corpus Now!"
 252:gpstest.c     **** #define  m "Close Guantanamo Now!  It is illegal, immoral, and hurting our national security!"
 253:gpstest.c     **** #define  n "What do we want?  Heybeas corpuss!  When do we want it?  We already have the right, but
 254:gpstest.c     **** #define  p "We come in peace!  We mean you no harm."
 255:gpstest.c     **** */
 256:gpstest.c     **** void sendTextMessage(unsigned char theMessage)
 257:gpstest.c     **** {	
 2200               		.stabn	68,0,257,.LM182-sendTextMessage
 2201               	.LM182:
 2202               	/* prologue: frame size=0 */
 2203               	/* prologue end (size=0) */
 258:gpstest.c     **** 	switch(theMessage)
GAS LISTING /var/tmp//cchOv7GV.s 			page 60


 2204               		.stabn	68,0,258,.LM183-sendTextMessage
 2205               	.LM183:
 2206 0b1e 8D36      		cpi r24,lo8(109)
 2207 0b20 79F0      		breq .L149
 2208               		.stabn	68,0,258,.LM184-sendTextMessage
 2209               	.LM184:
 2210 0b22 8E36      		cpi r24,lo8(110)
 2211 0b24 28F4      		brsh .L152
 2212 0b26 8631      		cpi r24,lo8(22)
 2213 0b28 A1F0      		breq .L147
 2214 0b2a 8836      		cpi r24,lo8(104)
 2215 0b2c E9F4      		brne .L146
 2216 0b2e 05C0      		rjmp .L148
 2217               	.L152:
 2218 0b30 8E36      		cpi r24,lo8(110)
 2219 0b32 49F0      		breq .L150
 2220 0b34 8037      		cpi r24,lo8(112)
 2221 0b36 C1F4      		brne .L146
 2222 0b38 09C0      		rjmp .L151
 2223               	.L148:
 259:gpstest.c     **** 	{
 260:gpstest.c     **** 		case 'h':
 261:gpstest.c     **** 			rprintf("\r\n Restore heybeas corpuss! Stop the torture!\r\n ");
 2224               		.stabn	68,0,261,.LM185-sendTextMessage
 2225               	.LM185:
 2226 0b3a 80E0      		ldi r24,lo8(__c.2575)
 2227 0b3c 90E0      		ldi r25,hi8(__c.2575)
 2228 0b3e 0BC0      		rjmp .L154
 2229               	.L149:
 262:gpstest.c     **** 			break;
 263:gpstest.c     **** 		case 'm':
 264:gpstest.c     **** 			rprintf("\r\n Close Guantanamo Now!  It is illegal, immoral, and hurting our national security!\
 2230               		.stabn	68,0,264,.LM186-sendTextMessage
 2231               	.LM186:
 2232 0b40 80E0      		ldi r24,lo8(__c.2579)
 2233 0b42 90E0      		ldi r25,hi8(__c.2579)
 2234 0b44 08C0      		rjmp .L154
 2235               	.L150:
 265:gpstest.c     **** 			break;
 266:gpstest.c     **** 		case 'n':
 267:gpstest.c     **** 			rprintf("\r\nWhat do we want?  Heybeas corpuss!  When do we want it?  We already have the right,
 2236               		.stabn	68,0,267,.LM187-sendTextMessage
 2237               	.LM187:
 2238 0b46 80E0      		ldi r24,lo8(__c.2582)
 2239 0b48 90E0      		ldi r25,hi8(__c.2582)
 2240 0b4a 05C0      		rjmp .L154
 2241               	.L151:
 268:gpstest.c     **** 			break;
 269:gpstest.c     **** 		case 'p':
 270:gpstest.c     **** 			rprintf("\r\n We come in peace!  We mean you no harm.\r\n ");
 2242               		.stabn	68,0,270,.LM188-sendTextMessage
 2243               	.LM188:
 2244 0b4c 80E0      		ldi r24,lo8(__c.2585)
 2245 0b4e 90E0      		ldi r25,hi8(__c.2585)
 2246 0b50 02C0      		rjmp .L154
 2247               	.L147:
 271:gpstest.c     **** 			break;
GAS LISTING /var/tmp//cchOv7GV.s 			page 61


 272:gpstest.c     **** 		case 22:
 273:gpstest.c     **** 			rprintf("\r\n We come in peace!  We mean you no harm.\r\n ");
 2248               		.stabn	68,0,273,.LM189-sendTextMessage
 2249               	.LM189:
 2250 0b52 80E0      		ldi r24,lo8(__c.2588)
 2251 0b54 90E0      		ldi r25,hi8(__c.2588)
 2252               	.L154:
 2253 0b56 9F93      		push r25
 2254 0b58 8F93      		push r24
 2255 0b5a 81E0      		ldi r24,lo8(1)
 2256 0b5c 8F93      		push r24
 2257 0b5e 0E94 0000 		call rprintf1RamRom
 2258 0b62 0F90      		pop __tmp_reg__
 2259 0b64 0F90      		pop __tmp_reg__
 2260 0b66 0F90      	 	pop __tmp_reg__
 2261               	.L146:
 274:gpstest.c     **** 			break;
 275:gpstest.c     **** 		default:
 276:gpstest.c     **** 			break;
 277:gpstest.c     **** 	}
 278:gpstest.c     **** 	voiceBoxCue = 'x';
 2262               		.stabn	68,0,278,.LM190-sendTextMessage
 2263               	.LM190:
 2264 0b68 88E7      		ldi r24,lo8(120)
 2265 0b6a 8093 0000 		sts voiceBoxCue,r24
 2266               	/* epilogue: frame size=0 */
 2267 0b6e 0895      		ret
 2268               	/* epilogue end (size=1) */
 2269               	/* function sendTextMessage size 41 (40) */
 2270               		.size	sendTextMessage, .-sendTextMessage
 2271               	.Lscope16:
 2272               		.stabs	"",36,0,0,.Lscope16-sendTextMessage
 2273               		.stabd	78,0,0
 2274               		.section	.progmem.data
 2275               		.type	__c.2606, @object
 2276               		.size	__c.2606, 26
 2277               	__c.2606:
 2278 0168 5265 7374 		.string	"Restore heybeas corpuss\r\n"
 2278      6F72 6520 
 2278      6865 7962 
 2278      6561 7320 
 2278      636F 7270 
 2279               		.type	__c.2604, @object
 2280               		.size	__c.2604, 7
 2281               	__c.2604:
 2282 0182 2563 3250 		.string	"%c2P\r\n"
 2282      0D0A 00
 2283               		.type	__c.2602, @object
 2284               		.size	__c.2602, 7
 2285               	__c.2602:
 2286 0189 2563 344F 		.string	"%c4O\r\n"
 2286      0D0A 00
 2287               		.type	__c.2600, @object
 2288               		.size	__c.2600, 24
 2289               	__c.2600:
 2290 0190 436C 6F73 		.string	"Close Guantanamo now!\r\n"
 2290      6520 4775 
GAS LISTING /var/tmp//cchOv7GV.s 			page 62


 2290      616E 7461 
 2290      6E61 6D6F 
 2290      206E 6F77 
 2291               		.type	__c.2598, @object
 2292               		.size	__c.2598, 5
 2293               	__c.2598:
 2294 01a8 3250 0D0A 		.string	"2P\r\n"
 2294      00
 2295               		.type	__c.2596, @object
 2296               		.size	__c.2596, 5
 2297               	__c.2596:
 2298 01ad 344F 0D0A 		.string	"4O\r\n"
 2298      00
 2299               		.text
 2300               		.stabs	"initVoiceBox:F(0,15)",36,0,282,initVoiceBox
 2301               	.global	initVoiceBox
 2302               		.type	initVoiceBox, @function
 2303               	initVoiceBox:
 2304               		.stabd	46,0,0
 279:gpstest.c     **** }
 280:gpstest.c     **** 
 281:gpstest.c     **** 
 282:gpstest.c     **** void initVoiceBox(void){
 2305               		.stabn	68,0,282,.LM191-initVoiceBox
 2306               	.LM191:
 2307               	/* prologue: frame size=0 */
 2308 0b70 FF92      		push r15
 2309 0b72 0F93      		push r16
 2310 0b74 1F93      		push r17
 2311               	/* prologue end (size=3) */
 283:gpstest.c     **** 	rprintfCRLF();
 2312               		.stabn	68,0,283,.LM192-initVoiceBox
 2313               	.LM192:
 2314 0b76 0E94 0000 		call rprintfCRLF
 284:gpstest.c     **** 	rprintfu08(1);//rprintfu08(small);((u08) 1);  //ctrl A = ascii code 1 -- sets voicebox to accept a
 2315               		.stabn	68,0,284,.LM193-initVoiceBox
 2316               	.LM193:
 2317 0b7a 81E0      		ldi r24,lo8(1)
 2318 0b7c 0E94 0000 		call rprintfu08
 285:gpstest.c     **** 	rprintf("4O\r\n"); //4o is the voice to use -- richochet randy!
 2319               		.stabn	68,0,285,.LM194-initVoiceBox
 2320               	.LM194:
 2321 0b80 80E0      		ldi r24,lo8(__c.2596)
 2322 0b82 90E0      		ldi r25,hi8(__c.2596)
 2323 0b84 9F93      		push r25
 2324 0b86 8F93      		push r24
 2325 0b88 51E0      		ldi r21,lo8(1)
 2326 0b8a F52E      		mov r15,r21
 2327 0b8c FF92      		push r15
 2328 0b8e 0E94 0000 		call rprintf1RamRom
 286:gpstest.c     **** 	rprintfu08(1); //rprintfChar((u08) 1);  //ctrl A = ascii code 1 -- sets voicebox to accept a comma
 2329               		.stabn	68,0,286,.LM195-initVoiceBox
 2330               	.LM195:
 2331 0b92 81E0      		ldi r24,lo8(1)
 2332 0b94 0E94 0000 		call rprintfu08
 287:gpstest.c     **** 	rprintf("2P\r\n"); //4o is the voice to use -- richochet randy!
 2333               		.stabn	68,0,287,.LM196-initVoiceBox
GAS LISTING /var/tmp//cchOv7GV.s 			page 63


 2334               	.LM196:
 2335 0b98 80E0      		ldi r24,lo8(__c.2598)
 2336 0b9a 90E0      		ldi r25,hi8(__c.2598)
 2337 0b9c 9F93      		push r25
 2338 0b9e 8F93      		push r24
 2339 0ba0 FF92      		push r15
 2340 0ba2 0E94 0000 		call rprintf1RamRom
 288:gpstest.c     **** 	
 289:gpstest.c     **** 	rprintf("Close Guantanamo now!\r\n");
 2341               		.stabn	68,0,289,.LM197-initVoiceBox
 2342               	.LM197:
 2343 0ba6 80E0      		ldi r24,lo8(__c.2600)
 2344 0ba8 90E0      		ldi r25,hi8(__c.2600)
 2345 0baa 9F93      		push r25
 2346 0bac 8F93      		push r24
 2347 0bae FF92      		push r15
 2348 0bb0 0E94 0000 		call rprintf1RamRom
 290:gpstest.c     **** 	rprintfCRLF();
 2349               		.stabn	68,0,290,.LM198-initVoiceBox
 2350               	.LM198:
 2351 0bb4 0E94 0000 		call rprintfCRLF
 291:gpstest.c     **** 	rprintf("%c4O\r\n",0x01);
 2352               		.stabn	68,0,291,.LM199-initVoiceBox
 2353               	.LM199:
 2354 0bb8 01E0      		ldi r16,lo8(1)
 2355 0bba 10E0      		ldi r17,hi8(1)
 2356 0bbc 1F93      		push r17
 2357 0bbe 0F93      		push r16
 2358 0bc0 80E0      		ldi r24,lo8(__c.2602)
 2359 0bc2 90E0      		ldi r25,hi8(__c.2602)
 2360 0bc4 9F93      		push r25
 2361 0bc6 8F93      		push r24
 2362 0bc8 FF92      		push r15
 2363 0bca 0E94 0000 		call rprintf1RamRom
 292:gpstest.c     **** 	rprintf("%c2P\r\n",0x01);
 2364               		.stabn	68,0,292,.LM200-initVoiceBox
 2365               	.LM200:
 2366 0bce 1F93      		push r17
 2367 0bd0 0F93      		push r16
 2368 0bd2 80E0      		ldi r24,lo8(__c.2604)
 2369 0bd4 90E0      		ldi r25,hi8(__c.2604)
 2370 0bd6 9F93      		push r25
 2371 0bd8 8F93      		push r24
 2372 0bda FF92      		push r15
 2373 0bdc 0E94 0000 		call rprintf1RamRom
 293:gpstest.c     **** 	rprintf("Restore heybeas corpuss\r\n");
 2374               		.stabn	68,0,293,.LM201-initVoiceBox
 2375               	.LM201:
 2376 0be0 80E0      		ldi r24,lo8(__c.2606)
 2377 0be2 90E0      		ldi r25,hi8(__c.2606)
 2378 0be4 9F93      		push r25
 2379 0be6 8F93      		push r24
 2380 0be8 FF92      		push r15
 2381 0bea 0E94 0000 		call rprintf1RamRom
 2382 0bee 8DB7      		in r24,__SP_L__
 2383 0bf0 9EB7      		in r25,__SP_H__
 2384 0bf2 4696      		adiw r24,22
GAS LISTING /var/tmp//cchOv7GV.s 			page 64


 2385 0bf4 0FB6      		in __tmp_reg__,__SREG__
 2386 0bf6 F894      		cli
 2387 0bf8 9EBF      		out __SP_H__,r25
 2388 0bfa 0FBE      		out __SREG__,__tmp_reg__
 2389 0bfc 8DBF      		out __SP_L__,r24
 2390               	/* epilogue: frame size=0 */
 2391 0bfe 1F91      		pop r17
 2392 0c00 0F91      		pop r16
 2393 0c02 FF90      		pop r15
 2394 0c04 0895      		ret
 2395               	/* epilogue end (size=4) */
 2396               	/* function initVoiceBox size 75 (68) */
 2397               		.size	initVoiceBox, .-initVoiceBox
 2398               	.Lscope17:
 2399               		.stabs	"",36,0,0,.Lscope17-initVoiceBox
 2400               		.stabd	78,0,0
 2401               		.stabs	"addToBuffer:F(0,15)",36,0,296,addToBuffer
 2402               		.stabs	"ch:P(0,11)",64,0,296,24
 2403               	.global	addToBuffer
 2404               		.type	addToBuffer, @function
 2405               	addToBuffer:
 2406               		.stabd	46,0,0
 294:gpstest.c     **** }
 295:gpstest.c     **** 
 296:gpstest.c     **** void addToBuffer(unsigned char ch) {
 2407               		.stabn	68,0,296,.LM202-addToBuffer
 2408               	.LM202:
 2409               	/* prologue: frame size=0 */
 2410               	/* prologue end (size=0) */
 297:gpstest.c     **** 	bufferAddToEnd(&gpsBuffer,ch);
 2411               		.stabn	68,0,297,.LM203-addToBuffer
 2412               	.LM203:
 2413 0c06 682F      		mov r22,r24
 2414 0c08 80E0      		ldi r24,lo8(gpsBuffer)
 2415 0c0a 90E0      		ldi r25,hi8(gpsBuffer)
 2416 0c0c 0E94 0000 		call bufferAddToEnd
 2417               	/* epilogue: frame size=0 */
 2418 0c10 0895      		ret
 2419               	/* epilogue end (size=1) */
 2420               	/* function addToBuffer size 6 (5) */
 2421               		.size	addToBuffer, .-addToBuffer
 2422               	.Lscope18:
 2423               		.stabs	"",36,0,0,.Lscope18-addToBuffer
 2424               		.stabd	78,0,0
 2425               		.stabs	"i2cSlaveReceiveService:F(0,15)",36,0,302,i2cSlaveReceiveService
 2426               		.stabs	"receiveDataLength:P(7,1)",64,0,301,25
 2427               		.stabs	"receiveData:P(0,21)",64,0,301,26
 2428               	.global	i2cSlaveReceiveService
 2429               		.type	i2cSlaveReceiveService, @function
 2430               	i2cSlaveReceiveService:
 2431               		.stabd	46,0,0
 298:gpstest.c     **** }
 299:gpstest.c     **** 
 300:gpstest.c     **** // slave operations
 301:gpstest.c     **** void i2cSlaveReceiveService(u08 receiveDataLength, u08* receiveData)
 302:gpstest.c     **** {
 2432               		.stabn	68,0,302,.LM204-i2cSlaveReceiveService
GAS LISTING /var/tmp//cchOv7GV.s 			page 65


 2433               	.LM204:
 2434               	/* prologue: frame size=0 */
 2435               	/* prologue end (size=0) */
 2436 0c12 982F      		mov r25,r24
 2437 0c14 DB01      		movw r26,r22
 303:gpstest.c     **** 	u08 i;
 304:gpstest.c     **** 
 305:gpstest.c     **** 	// this function will run when a master somewhere else on the bus
 306:gpstest.c     **** 	// addresses us and wishes to write data to us
 307:gpstest.c     **** 
 308:gpstest.c     **** 	//showByte(*receiveData);
 309:gpstest.c     **** 	cbi(PORTB, PB6);
 2438               		.stabn	68,0,309,.LM205-i2cSlaveReceiveService
 2439               	.LM205:
 2440 0c16 C698      		cbi 56-0x20,6
 2441 0c18 20E0      		ldi r18,lo8(0)
 2442 0c1a 30E0      		ldi r19,hi8(0)
 2443 0c1c 07C0      		rjmp .L160
 2444               	.L161:
 310:gpstest.c     **** 
 311:gpstest.c     **** 	// copy the received data to a local buffer
 312:gpstest.c     **** 	for(i=0; i<receiveDataLength; i++)
 313:gpstest.c     **** 	{
 314:gpstest.c     **** 		localBuffer[i] = *receiveData++;
 2445               		.stabn	68,0,314,.LM206-i2cSlaveReceiveService
 2446               	.LM206:
 2447 0c1e 8D91      		ld r24,X+
 2448 0c20 FF27      		clr r31
 2449 0c22 E050      		subi r30,lo8(-(localBuffer))
 2450 0c24 F040      		sbci r31,hi8(-(localBuffer))
 2451 0c26 8083      		st Z,r24
 2452 0c28 2F5F      		subi r18,lo8(-(1))
 2453 0c2a 3F4F      		sbci r19,hi8(-(1))
 2454               	.L160:
 2455 0c2c E22F      		mov r30,r18
 2456               		.stabn	68,0,312,.LM207-i2cSlaveReceiveService
 2457               	.LM207:
 2458 0c2e 2917      		cp r18,r25
 2459 0c30 B0F3      		brlo .L161
 315:gpstest.c     **** 	}
 316:gpstest.c     **** 	localBufferLength = receiveDataLength;
 2460               		.stabn	68,0,316,.LM208-i2cSlaveReceiveService
 2461               	.LM208:
 2462 0c32 9093 0000 		sts localBufferLength,r25
 2463               	/* epilogue: frame size=0 */
 2464 0c36 0895      		ret
 2465               	/* epilogue end (size=1) */
 2466               	/* function i2cSlaveReceiveService size 19 (18) */
 2467               		.size	i2cSlaveReceiveService, .-i2cSlaveReceiveService
 2468               		.stabs	"i:r(7,1)",64,0,303,30
 2469               		.stabn	192,0,0,i2cSlaveReceiveService-i2cSlaveReceiveService
 2470               		.stabn	224,0,0,.Lscope19-i2cSlaveReceiveService
 2471               	.Lscope19:
 2472               		.stabs	"",36,0,0,.Lscope19-i2cSlaveReceiveService
 2473               		.stabd	78,0,0
 2474               		.section	.progmem.data
 2475               		.type	__c.2660, @object
GAS LISTING /var/tmp//cchOv7GV.s 			page 66


 2476               		.size	__c.2660, 3
 2477               	__c.2660:
 2478 01b2 7020 00   		.string	"p "
 2479               		.type	__c.2657, @object
 2480               		.size	__c.2657, 3
 2481               	__c.2657:
 2482 01b5 6D20 00   		.string	"m "
 2483               		.type	__c.2654, @object
 2484               		.size	__c.2654, 3
 2485               	__c.2654:
 2486 01b8 6E20 00   		.string	"n "
 2487               		.type	__c.2651, @object
 2488               		.size	__c.2651, 3
 2489               	__c.2651:
 2490 01bb 6820 00   		.string	"h "
 2491               		.type	__c.2648, @object
 2492               		.size	__c.2648, 3
 2493               	__c.2648:
 2494 01be 6720 00   		.string	"g "
 2495               		.type	__c.2645, @object
 2496               		.size	__c.2645, 3
 2497               	__c.2645:
 2498 01c1 6420 00   		.string	"d "
 2499               		.type	__c.2642, @object
 2500               		.size	__c.2642, 2
 2501               	__c.2642:
 2502 01c4 6300      		.string	"c"
 2503               		.type	__c.2639, @object
 2504               		.size	__c.2639, 3
 2505               	__c.2639:
 2506 01c6 6420 00   		.string	"d "
 2507               		.type	__c.2636, @object
 2508               		.size	__c.2636, 3
 2509               	__c.2636:
 2510 01c9 6F20 00   		.string	"o "
 2511               		.type	__c.2632, @object
 2512               		.size	__c.2632, 3
 2513               	__c.2632:
 2514 01cc 6120 00   		.string	"a "
 2515               		.text
 2516               		.stabs	"i2cSlaveTransmitService:F(7,1)",36,0,340,i2cSlaveTransmitService
 2517               		.stabs	"transmitDataLengthMax:P(7,1)",64,0,339,24
 2518               		.stabs	"transmitData:P(0,21)",64,0,339,28
 2519               	.global	i2cSlaveTransmitService
 2520               		.type	i2cSlaveTransmitService, @function
 2521               	i2cSlaveTransmitService:
 2522               		.stabd	46,0,0
 317:gpstest.c     **** 	
 318:gpstest.c     **** }
 319:gpstest.c     **** 
 320:gpstest.c     **** /*
 321:gpstest.c     **** #define	 q "pitch" #external (hmr3300) module
 322:gpstest.c     **** #define	 w "Roll" #external (hmr3300) module
 323:gpstest.c     **** #define	 c "Heading" #external (hmr3300) module heading
 324:gpstest.c     **** #define  d	"Direction" #The gps' heading
 325:gpstest.c     **** #define	 a "Latitude" 
 326:gpstest.c     **** #define	 o "Longitude"
GAS LISTING /var/tmp//cchOv7GV.s 			page 67


 327:gpstest.c     **** #define	 z "Altitude"
 328:gpstest.c     **** #define	 b "Battery"
 329:gpstest.c     **** #define  t	"dateTime"
 330:gpstest.c     **** #define	 f "Fuel"
 331:gpstest.c     **** #define	 s "Airspeed"
 332:gpstest.c     **** #define	 g "Groundspeed"
 333:gpstest.c     **** #define  h "Restore Habeas Corpus Now!"
 334:gpstest.c     **** #define  m "Close Guantanamo Now!  It is illegal, immoral, and hurting our national security!"
 335:gpstest.c     **** #define  n "What do we want?  Heybeas corpuss!  When do we want it?  We already have the right, but
 336:gpstest.c     **** #define  p "We come in peace!  We mean you no harm."
 337:gpstest.c     **** */
 338:gpstest.c     **** 
 339:gpstest.c     **** u08 i2cSlaveTransmitService(u08 transmitDataLengthMax, u08* transmitData)
 340:gpstest.c     **** {
 2523               		.stabn	68,0,340,.LM209-i2cSlaveTransmitService
 2524               	.LM209:
 2525               	/* prologue: frame size=0 */
 2526 0c38 CF93      		push r28
 2527 0c3a DF93      		push r29
 2528               	/* prologue end (size=2) */
 2529 0c3c EB01      		movw r28,r22
 341:gpstest.c     **** 	u08 i;
 342:gpstest.c     **** 	// this function will run when a master somewhere else on the bus
 343:gpstest.c     **** 	// addresses us and wishes to read data from us
 344:gpstest.c     **** 	
 345:gpstest.c     **** 	// I believe that this might be the place to load the response...
 346:gpstest.c     **** 	
 347:gpstest.c     **** 	//showByte(*transmitData);	
 348:gpstest.c     **** 	cbi(PORTB, PB7);
 2530               		.stabn	68,0,348,.LM210-i2cSlaveTransmitService
 2531               	.LM210:
 2532 0c3e C798      		cbi 56-0x20,7
 349:gpstest.c     **** 	rprintfInit(print_to_string);
 2533               		.stabn	68,0,349,.LM211-i2cSlaveTransmitService
 2534               	.LM211:
 2535 0c40 80E0      		ldi r24,lo8(pm(print_to_string))
 2536 0c42 90E0      		ldi r25,hi8(pm(print_to_string))
 2537 0c44 0E94 0000 		call rprintfInit
 350:gpstest.c     **** 	// temp for debugging.... CHANGE!
 351:gpstest.c     **** 	float test = -71.093355;  //MIT position
 352:gpstest.c     **** 	double test2 = 42.359051; //MIT position
 353:gpstest.c     **** 	stackem_pointer = 0;
 2538               		.stabn	68,0,353,.LM212-i2cSlaveTransmitService
 2539               	.LM212:
 2540 0c48 1092 0000 		sts stackem_pointer,__zero_reg__
 354:gpstest.c     **** 	switch(localBuffer[0])
 2541               		.stabn	68,0,354,.LM213-i2cSlaveTransmitService
 2542               	.LM213:
 2543 0c4c 8091 0000 		lds r24,localBuffer
 2544 0c50 8836      		cpi r24,lo8(104)
 2545 0c52 09F4      		brne .+2
 2546 0c54 AAC0      		rjmp .L170
 2547               		.stabn	68,0,354,.LM214-i2cSlaveTransmitService
 2548               	.LM214:
 2549 0c56 8936      		cpi r24,lo8(105)
 2550 0c58 78F4      		brsh .L176
 2551 0c5a 8336      		cpi r24,lo8(99)
GAS LISTING /var/tmp//cchOv7GV.s 			page 68


 2552 0c5c 09F4      		brne .+2
 2553 0c5e 52C0      		rjmp .L167
 2554 0c60 8436      		cpi r24,lo8(100)
 2555 0c62 20F4      		brsh .L177
 2556 0c64 8136      		cpi r24,lo8(97)
 2557 0c66 09F0      		breq .+2
 2558 0c68 BDC0      		rjmp .L165
 2559 0c6a 18C0      		rjmp .L166
 2560               	.L177:
 2561 0c6c 8436      		cpi r24,lo8(100)
 2562 0c6e C9F1      		breq .L168
 2563 0c70 8736      		cpi r24,lo8(103)
 2564 0c72 09F0      		breq .+2
 2565 0c74 B7C0      		rjmp .L165
 2566 0c76 85C0      		rjmp .L169
 2567               	.L176:
 2568 0c78 8F36      		cpi r24,lo8(111)
 2569 0c7a 09F1      		breq .L173
 2570 0c7c 8037      		cpi r24,lo8(112)
 2571 0c7e 38F4      		brsh .L178
 2572 0c80 8D36      		cpi r24,lo8(109)
 2573 0c82 09F4      		brne .+2
 2574 0c84 9CC0      		rjmp .L171
 2575 0c86 8E36      		cpi r24,lo8(110)
 2576 0c88 09F0      		breq .+2
 2577 0c8a ACC0      		rjmp .L165
 2578 0c8c 93C0      		rjmp .L172
 2579               	.L178:
 2580 0c8e 8037      		cpi r24,lo8(112)
 2581 0c90 09F4      		brne .+2
 2582 0c92 9AC0      		rjmp .L174
 2583 0c94 8437      		cpi r24,lo8(116)
 2584 0c96 09F0      		breq .+2
 2585 0c98 A5C0      		rjmp .L165
 2586 0c9a 44C0      		rjmp .L175
 2587               	.L166:
 355:gpstest.c     **** 	{
 356:gpstest.c     **** 		case 'a': //latitude
 357:gpstest.c     **** 			rprintf("a ");
 2588               		.stabn	68,0,357,.LM215-i2cSlaveTransmitService
 2589               	.LM215:
 2590 0c9c 80E0      		ldi r24,lo8(__c.2632)
 2591 0c9e 90E0      		ldi r25,hi8(__c.2632)
 2592 0ca0 9F93      		push r25
 2593 0ca2 8F93      		push r24
 2594 0ca4 81E0      		ldi r24,lo8(1)
 2595 0ca6 8F93      		push r24
 2596 0ca8 0E94 0000 		call rprintf1RamRom
 358:gpstest.c     **** 			rprintfFloat(8,gga.latitude);
 2597               		.stabn	68,0,358,.LM216-i2cSlaveTransmitService
 2598               	.LM216:
 2599 0cac 4091 0000 		lds r20,gga
 2600 0cb0 5091 0000 		lds r21,(gga)+1
 2601 0cb4 6091 0000 		lds r22,(gga)+2
 2602 0cb8 7091 0000 		lds r23,(gga)+3
 2603 0cbc 10C0      		rjmp .L188
 2604               	.L173:
GAS LISTING /var/tmp//cchOv7GV.s 			page 69


 359:gpstest.c     **** 			//rprintfFloat(8,test2);	
 360:gpstest.c     **** 			break;
 361:gpstest.c     **** 		case 'o': //longitude
 362:gpstest.c     **** 			rprintf("o ");
 2605               		.stabn	68,0,362,.LM217-i2cSlaveTransmitService
 2606               	.LM217:
 2607 0cbe 80E0      		ldi r24,lo8(__c.2636)
 2608 0cc0 90E0      		ldi r25,hi8(__c.2636)
 2609 0cc2 9F93      		push r25
 2610 0cc4 8F93      		push r24
 2611 0cc6 81E0      		ldi r24,lo8(1)
 2612 0cc8 8F93      		push r24
 2613 0cca 0E94 0000 		call rprintf1RamRom
 363:gpstest.c     **** 			rprintfFloat(8,gga.longitude);
 2614               		.stabn	68,0,363,.LM218-i2cSlaveTransmitService
 2615               	.LM218:
 2616 0cce 4091 0000 		lds r20,gga+4
 2617 0cd2 5091 0000 		lds r21,(gga+4)+1
 2618 0cd6 6091 0000 		lds r22,(gga+4)+2
 2619 0cda 7091 0000 		lds r23,(gga+4)+3
 2620               	.L188:
 2621 0cde 88E0      		ldi r24,lo8(8)
 2622 0ce0 61C0      		rjmp .L186
 2623               	.L168:
 364:gpstest.c     **** 			//rprintfFloat(8,test);	
 365:gpstest.c     **** 			break;
 366:gpstest.c     **** 		case 'd':
 367:gpstest.c     **** 			rprintf("d ");
 2624               		.stabn	68,0,367,.LM219-i2cSlaveTransmitService
 2625               	.LM219:
 2626 0ce2 80E0      		ldi r24,lo8(__c.2639)
 2627 0ce4 90E0      		ldi r25,hi8(__c.2639)
 2628 0ce6 9F93      		push r25
 2629 0ce8 8F93      		push r24
 2630 0cea 81E0      		ldi r24,lo8(1)
 2631 0cec 8F93      		push r24
 2632 0cee 0E94 0000 		call rprintf1RamRom
 368:gpstest.c     **** 			rprintfFloat(8,rmc.course);
 2633               		.stabn	68,0,368,.LM220-i2cSlaveTransmitService
 2634               	.LM220:
 2635 0cf2 4091 0000 		lds r20,rmc+17
 2636 0cf6 5091 0000 		lds r21,(rmc+17)+1
 2637 0cfa 6091 0000 		lds r22,(rmc+17)+2
 2638 0cfe 7091 0000 		lds r23,(rmc+17)+3
 2639 0d02 EDCF      		rjmp .L188
 2640               	.L167:
 369:gpstest.c     **** 			break;
 370:gpstest.c     **** 		case 'c':  // RETURNS compass, roll, and pitch
 371:gpstest.c     **** 			rprintf("c"); //ghetto -- no space before the data for some annoying reason -- blame uartsw.c
 2641               		.stabn	68,0,371,.LM221-i2cSlaveTransmitService
 2642               	.LM221:
 2643 0d04 80E0      		ldi r24,lo8(__c.2642)
 2644 0d06 90E0      		ldi r25,hi8(__c.2642)
 2645 0d08 9F93      		push r25
 2646 0d0a 8F93      		push r24
 2647 0d0c 81E0      		ldi r24,lo8(1)
 2648 0d0e 8F93      		push r24
GAS LISTING /var/tmp//cchOv7GV.s 			page 70


 2649 0d10 0E94 0000 		call rprintf1RamRom
 372:gpstest.c     **** 			sentence[0] = ' ';
 2650               		.stabn	68,0,372,.LM222-i2cSlaveTransmitService
 2651               	.LM222:
 2652 0d14 80E2      		ldi r24,lo8(32)
 2653 0d16 8093 0000 		sts sentence,r24
 373:gpstest.c     **** 			rprintfStr(sentence);
 2654               		.stabn	68,0,373,.LM223-i2cSlaveTransmitService
 2655               	.LM223:
 2656 0d1a 80E0      		ldi r24,lo8(sentence)
 2657 0d1c 90E0      		ldi r25,hi8(sentence)
 2658 0d1e 0E94 0000 		call rprintfStr
 2659 0d22 5DC0      		rjmp .L185
 2660               	.L175:
 374:gpstest.c     **** 			break;
 375:gpstest.c     **** 		case 't':
 376:gpstest.c     **** 			rprintf("d ");
 2661               		.stabn	68,0,376,.LM224-i2cSlaveTransmitService
 2662               	.LM224:
 2663 0d24 80E0      		ldi r24,lo8(__c.2645)
 2664 0d26 90E0      		ldi r25,hi8(__c.2645)
 2665 0d28 9F93      		push r25
 2666 0d2a 8F93      		push r24
 2667 0d2c 81E0      		ldi r24,lo8(1)
 2668 0d2e 8F93      		push r24
 2669 0d30 0E94 0000 		call rprintf1RamRom
 377:gpstest.c     **** 			rprintfFloat(9,rmc.date);
 2670               		.stabn	68,0,377,.LM225-i2cSlaveTransmitService
 2671               	.LM225:
 2672 0d34 2091 0000 		lds r18,rmc+21
 2673 0d38 3091 0000 		lds r19,(rmc+21)+1
 2674 0d3c 4091 0000 		lds r20,(rmc+21)+2
 2675 0d40 5091 0000 		lds r21,(rmc+21)+3
 2676 0d44 57FD      		sbrc r21,7
 2677 0d46 05C0      		rjmp .L180
 2678 0d48 CA01      		movw r24,r20
 2679 0d4a B901      		movw r22,r18
 2680 0d4c 0E94 0000 		call __floatsisf
 2681 0d50 14C0      		rjmp .L179
 2682               	.L180:
 2683 0d52 CA01      		movw r24,r20
 2684 0d54 B901      		movw r22,r18
 2685 0d56 6170      		andi r22,lo8(1)
 2686 0d58 7070      		andi r23,hi8(1)
 2687 0d5a 8070      		andi r24,hlo8(1)
 2688 0d5c 9070      		andi r25,hhi8(1)
 2689 0d5e 5695      		lsr r21
 2690 0d60 4795      		ror r20
 2691 0d62 3795      		ror r19
 2692 0d64 2795      		ror r18
 2693 0d66 622B      		or r22,r18
 2694 0d68 732B      		or r23,r19
 2695 0d6a 842B      		or r24,r20
 2696 0d6c 952B      		or r25,r21
 2697 0d6e 0E94 0000 		call __floatsisf
 2698 0d72 9B01      		movw r18,r22
 2699 0d74 AC01      		movw r20,r24
GAS LISTING /var/tmp//cchOv7GV.s 			page 71


 2700 0d76 0E94 0000 		call __addsf3
 2701               	.L179:
 2702 0d7a AB01      		movw r20,r22
 2703 0d7c BC01      		movw r22,r24
 2704 0d7e 89E0      		ldi r24,lo8(9)
 2705 0d80 11C0      		rjmp .L186
 2706               	.L169:
 378:gpstest.c     **** 			break;
 379:gpstest.c     **** 		case 'g':  // groundspeed is speed from gps -- prone to errors
 380:gpstest.c     **** 			rprintf("g ");
 2707               		.stabn	68,0,380,.LM226-i2cSlaveTransmitService
 2708               	.LM226:
 2709 0d82 80E0      		ldi r24,lo8(__c.2648)
 2710 0d84 90E0      		ldi r25,hi8(__c.2648)
 2711 0d86 9F93      		push r25
 2712 0d88 8F93      		push r24
 2713 0d8a 81E0      		ldi r24,lo8(1)
 2714 0d8c 8F93      		push r24
 2715 0d8e 0E94 0000 		call rprintf1RamRom
 381:gpstest.c     **** 			rprintfFloat(7,rmc.speed);
 2716               		.stabn	68,0,381,.LM227-i2cSlaveTransmitService
 2717               	.LM227:
 2718 0d92 4091 0000 		lds r20,rmc+13
 2719 0d96 5091 0000 		lds r21,(rmc+13)+1
 2720 0d9a 6091 0000 		lds r22,(rmc+13)+2
 2721 0d9e 7091 0000 		lds r23,(rmc+13)+3
 2722 0da2 87E0      		ldi r24,lo8(7)
 2723               	.L186:
 2724 0da4 0E94 0000 		call rprintfFloat
 2725 0da8 1AC0      		rjmp .L185
 2726               	.L170:
 382:gpstest.c     **** 			break;
 383:gpstest.c     **** 		case 'h':
 384:gpstest.c     **** 			voiceBoxCue = 'h';
 2727               		.stabn	68,0,384,.LM228-i2cSlaveTransmitService
 2728               	.LM228:
 2729 0daa 8093 0000 		sts voiceBoxCue,r24
 385:gpstest.c     **** 			rprintf("h ");
 2730               		.stabn	68,0,385,.LM229-i2cSlaveTransmitService
 2731               	.LM229:
 2732 0dae 80E0      		ldi r24,lo8(__c.2651)
 2733 0db0 90E0      		ldi r25,hi8(__c.2651)
 2734 0db2 0FC0      		rjmp .L187
 2735               	.L172:
 386:gpstest.c     **** 			break;
 387:gpstest.c     **** 		case 'n':
 388:gpstest.c     **** 			voiceBoxCue = 'n';
 2736               		.stabn	68,0,388,.LM230-i2cSlaveTransmitService
 2737               	.LM230:
 2738 0db4 8093 0000 		sts voiceBoxCue,r24
 389:gpstest.c     **** 			rprintf("n ");
 2739               		.stabn	68,0,389,.LM231-i2cSlaveTransmitService
 2740               	.LM231:
 2741 0db8 80E0      		ldi r24,lo8(__c.2654)
 2742 0dba 90E0      		ldi r25,hi8(__c.2654)
 2743 0dbc 0AC0      		rjmp .L187
 2744               	.L171:
GAS LISTING /var/tmp//cchOv7GV.s 			page 72


 390:gpstest.c     **** 			break;
 391:gpstest.c     **** 		case 'm':
 392:gpstest.c     **** 			voiceBoxCue = 'm';
 2745               		.stabn	68,0,392,.LM232-i2cSlaveTransmitService
 2746               	.LM232:
 2747 0dbe 8093 0000 		sts voiceBoxCue,r24
 393:gpstest.c     **** 			rprintf("m ");
 2748               		.stabn	68,0,393,.LM233-i2cSlaveTransmitService
 2749               	.LM233:
 2750 0dc2 80E0      		ldi r24,lo8(__c.2657)
 2751 0dc4 90E0      		ldi r25,hi8(__c.2657)
 2752 0dc6 05C0      		rjmp .L187
 2753               	.L174:
 394:gpstest.c     **** 			break;
 395:gpstest.c     **** 		case 'p':
 396:gpstest.c     **** 			voiceBoxCue = 22;
 2754               		.stabn	68,0,396,.LM234-i2cSlaveTransmitService
 2755               	.LM234:
 2756 0dc8 86E1      		ldi r24,lo8(22)
 2757 0dca 8093 0000 		sts voiceBoxCue,r24
 397:gpstest.c     **** 			rprintf("p ");
 2758               		.stabn	68,0,397,.LM235-i2cSlaveTransmitService
 2759               	.LM235:
 2760 0dce 80E0      		ldi r24,lo8(__c.2660)
 2761 0dd0 90E0      		ldi r25,hi8(__c.2660)
 2762               	.L187:
 2763 0dd2 9F93      		push r25
 2764 0dd4 8F93      		push r24
 2765 0dd6 81E0      		ldi r24,lo8(1)
 2766 0dd8 8F93      		push r24
 2767 0dda 0E94 0000 		call rprintf1RamRom
 2768               	.L185:
 2769 0dde 0F90      		pop __tmp_reg__
 2770 0de0 0F90      		pop __tmp_reg__
 2771 0de2 0F90      	 	pop __tmp_reg__
 2772               	.L165:
 398:gpstest.c     **** 			break;
 399:gpstest.c     **** 		default:
 400:gpstest.c     **** 		//	rprintf(" E");  //CE = Command Error
 401:gpstest.c     **** 			break;
 402:gpstest.c     **** 	}
 403:gpstest.c     **** 	rprintfInit(uartSendByte);
 2773               		.stabn	68,0,403,.LM236-i2cSlaveTransmitService
 2774               	.LM236:
 2775 0de4 80E0      		ldi r24,lo8(pm(uartSendByte))
 2776 0de6 90E0      		ldi r25,hi8(pm(uartSendByte))
 2777 0de8 0E94 0000 		call rprintfInit
 2778 0dec DE01      		movw r26,r28
 2779 0dee 05C0      		rjmp .L181
 2780               	.L182:
 404:gpstest.c     **** 	//sprintf(temp_buffer, "%f,%f",gga.latitude,gga.longitude);
 405:gpstest.c     **** 	
 406:gpstest.c     **** 	// copy the local buffer to the transmit buffer -- this buffer size is set in i2c.conf
 407:gpstest.c     **** 	for(i=0; i<=stackem_pointer; i++)
 408:gpstest.c     **** 	{
 409:gpstest.c     **** 		*transmitData++ = stackem[i];
 2781               		.stabn	68,0,409,.LM237-i2cSlaveTransmitService
GAS LISTING /var/tmp//cchOv7GV.s 			page 73


 2782               	.LM237:
 2783 0df0 FF27      		clr r31
 2784 0df2 E050      		subi r30,lo8(-(stackem))
 2785 0df4 F040      		sbci r31,hi8(-(stackem))
 2786 0df6 8081      		ld r24,Z
 2787 0df8 8D93      		st X+,r24
 2788               	.L181:
 2789 0dfa EA2F      		mov r30,r26
 2790 0dfc EC1B      		sub r30,r28
 2791               		.stabn	68,0,407,.LM238-i2cSlaveTransmitService
 2792               	.LM238:
 2793 0dfe 8091 0000 		lds r24,stackem_pointer
 2794 0e02 8E17      		cp r24,r30
 2795 0e04 A8F7      		brsh .L182
 2796 0e06 8F5F      		subi r24,lo8(-(1))
 410:gpstest.c     **** 	}
 411:gpstest.c     **** 	
 412:gpstest.c     **** 	
 413:gpstest.c     **** 	//localBuffer[0]++;
 414:gpstest.c     **** 	//message_sent = 1;
 415:gpstest.c     **** 
 416:gpstest.c     **** 	return stackem_pointer+1;
 417:gpstest.c     **** }
 2797               		.stabn	68,0,417,.LM239-i2cSlaveTransmitService
 2798               	.LM239:
 2799 0e08 9927      		clr r25
 2800               	/* epilogue: frame size=0 */
 2801 0e0a DF91      		pop r29
 2802 0e0c CF91      		pop r28
 2803 0e0e 0895      		ret
 2804               	/* epilogue end (size=3) */
 2805               	/* function i2cSlaveTransmitService size 236 (231) */
 2806               		.size	i2cSlaveTransmitService, .-i2cSlaveTransmitService
 2807               		.stabs	"i:r(7,1)",64,0,341,30
 2808               		.stabn	192,0,0,i2cSlaveTransmitService-i2cSlaveTransmitService
 2809               		.stabn	224,0,0,.Lscope20-i2cSlaveTransmitService
 2810               	.Lscope20:
 2811               		.stabs	"",36,0,0,.Lscope20-i2cSlaveTransmitService
 2812               		.stabd	78,0,0
 2813               		.stabs	"print_to_string:F(0,15)",36,0,419,print_to_string
 2814               		.stabs	"the_char:P(7,1)",64,0,418,24
 2815               	.global	print_to_string
 2816               		.type	print_to_string, @function
 2817               	print_to_string:
 2818               		.stabd	46,0,0
 418:gpstest.c     **** void print_to_string(u08 the_char)
 419:gpstest.c     **** {
 2819               		.stabn	68,0,419,.LM240-print_to_string
 2820               	.LM240:
 2821               	/* prologue: frame size=0 */
 2822               	/* prologue end (size=0) */
 420:gpstest.c     **** 	if(stackem_pointer<(stackem_length-1))  //-1 to allow for null char to still fit
 2823               		.stabn	68,0,420,.LM241-print_to_string
 2824               	.LM241:
 2825 0e10 9091 0000 		lds r25,stackem_pointer
 2826 0e14 9F31      		cpi r25,lo8(31)
 2827 0e16 68F4      		brsh .L192
GAS LISTING /var/tmp//cchOv7GV.s 			page 74


 421:gpstest.c     **** 	{
 422:gpstest.c     **** 		stackem[stackem_pointer] = the_char;
 2828               		.stabn	68,0,422,.LM242-print_to_string
 2829               	.LM242:
 2830 0e18 E92F      		mov r30,r25
 2831 0e1a FF27      		clr r31
 2832 0e1c E050      		subi r30,lo8(-(stackem))
 2833 0e1e F040      		sbci r31,hi8(-(stackem))
 2834 0e20 8083      		st Z,r24
 423:gpstest.c     **** 		stackem_pointer++;
 2835               		.stabn	68,0,423,.LM243-print_to_string
 2836               	.LM243:
 2837 0e22 E92F      		mov r30,r25
 2838 0e24 EF5F      		subi r30,lo8(-(1))
 2839 0e26 E093 0000 		sts stackem_pointer,r30
 424:gpstest.c     **** 		stackem[stackem_pointer] = 0;
 2840               		.stabn	68,0,424,.LM244-print_to_string
 2841               	.LM244:
 2842 0e2a FF27      		clr r31
 2843 0e2c E050      		subi r30,lo8(-(stackem))
 2844 0e2e F040      		sbci r31,hi8(-(stackem))
 2845 0e30 1082      		st Z,__zero_reg__
 2846               	.L192:
 2847 0e32 0895      		ret
 2848               	/* epilogue: frame size=0 */
 2849               	/* epilogue: noreturn */
 2850               	/* epilogue end (size=0) */
 2851               	/* function print_to_string size 18 (18) */
 2852               		.size	print_to_string, .-print_to_string
 2853               	.Lscope21:
 2854               		.stabs	"",36,0,0,.Lscope21-print_to_string
 2855               		.stabd	78,0,0
 2856               		.stabs	"getCompass:F(0,15)",36,0,430,getCompass
 2857               	.global	getCompass
 2858               		.type	getCompass, @function
 2859               	getCompass:
 2860               		.stabd	46,0,0
 425:gpstest.c     **** 	}
 426:gpstest.c     **** }
 427:gpstest.c     **** 
 428:gpstest.c     **** //I think this is unused?
 429:gpstest.c     **** void getCompass(void)
 430:gpstest.c     **** {
 2861               		.stabn	68,0,430,.LM245-getCompass
 2862               	.LM245:
 2863               	/* prologue: frame size=1 */
 2864 0e34 CF93      		push r28
 2865 0e36 DF93      		push r29
 2866 0e38 CDB7      		in r28,__SP_L__
 2867 0e3a DEB7      		in r29,__SP_H__
 2868 0e3c 2197      		sbiw r28,1
 2869 0e3e 0FB6      		in __tmp_reg__,__SREG__
 2870 0e40 F894      		cli
 2871 0e42 DEBF      		out __SP_H__,r29
 2872 0e44 0FBE      		out __SREG__,__tmp_reg__
 2873 0e46 CDBF      		out __SP_L__,r28
 2874               	/* prologue end (size=10) */
GAS LISTING /var/tmp//cchOv7GV.s 			page 75


 2875               	.L203:
 431:gpstest.c     **** 	u08 data;
 432:gpstest.c     **** 	
 433:gpstest.c     **** 	while(1)
 434:gpstest.c     **** 	{
 435:gpstest.c     **** 		if(uartswReceiveByte(&data))
 2876               		.stabn	68,0,435,.LM246-getCompass
 2877               	.LM246:
 2878 0e48 CE01      		movw r24,r28
 2879 0e4a 0196      		adiw r24,1
 2880 0e4c 0E94 0000 		call uartswReceiveByte
 2881 0e50 8823      		tst r24
 2882 0e52 D1F3      		breq .L203
 436:gpstest.c     **** 			rprintfChar(data);
 2883               		.stabn	68,0,436,.LM247-getCompass
 2884               	.LM247:
 2885 0e54 8981      		ldd r24,Y+1
 2886 0e56 0E94 0000 		call rprintfChar
 2887 0e5a F6CF      		rjmp .L203
 2888               	/* epilogue: frame size=1 */
 2889               	/* epilogue: noreturn */
 2890               	/* epilogue end (size=0) */
 2891               	/* function getCompass size 20 (10) */
 2892               		.size	getCompass, .-getCompass
 2893               		.stabs	"data:(7,1)",128,0,431,1
 2894               		.stabn	192,0,0,getCompass-getCompass
 2895               		.stabn	224,0,0,.Lscope22-getCompass
 2896               	.Lscope22:
 2897               		.stabs	"",36,0,0,.Lscope22-getCompass
 2898               		.stabd	78,0,0
 2899               		.section	.progmem.data
 2900               		.type	__c.2701, @object
 2901               		.size	__c.2701, 3
 2902               	__c.2701:
 2903 01cf 0D0A 00   		.string	"\r\n"
 2904               		.text
 2905               		.stabs	"setCompassBaud:F(0,15)",36,0,441,setCompassBaud
 2906               	.global	setCompassBaud
 2907               		.type	setCompassBaud, @function
 2908               	setCompassBaud:
 2909               		.stabd	46,0,0
 437:gpstest.c     **** 	}
 438:gpstest.c     **** }
 439:gpstest.c     **** 
 440:gpstest.c     **** void setCompassBaud(void)
 441:gpstest.c     **** {
 2910               		.stabn	68,0,441,.LM248-setCompassBaud
 2911               	.LM248:
 2912               	/* prologue: frame size=0 */
 2913               	/* prologue end (size=0) */
 442:gpstest.c     **** 	sentence[0]=' ';
 2914               		.stabn	68,0,442,.LM249-setCompassBaud
 2915               	.LM249:
 2916 0e5c 80E2      		ldi r24,lo8(32)
 2917 0e5e 8093 0000 		sts sentence,r24
 443:gpstest.c     **** 	//uartswSetBaudRate(cmdlineGetArgInt(1));
 444:gpstest.c     **** 	rprintfStr(sentence);
GAS LISTING /var/tmp//cchOv7GV.s 			page 76


 2918               		.stabn	68,0,444,.LM250-setCompassBaud
 2919               	.LM250:
 2920 0e62 80E0      		ldi r24,lo8(sentence)
 2921 0e64 90E0      		ldi r25,hi8(sentence)
 2922 0e66 0E94 0000 		call rprintfStr
 445:gpstest.c     **** 	rprintf("\r\n");
 2923               		.stabn	68,0,445,.LM251-setCompassBaud
 2924               	.LM251:
 2925 0e6a 80E0      		ldi r24,lo8(__c.2701)
 2926 0e6c 90E0      		ldi r25,hi8(__c.2701)
 2927 0e6e 9F93      		push r25
 2928 0e70 8F93      		push r24
 2929 0e72 81E0      		ldi r24,lo8(1)
 2930 0e74 8F93      		push r24
 2931 0e76 0E94 0000 		call rprintf1RamRom
 2932 0e7a 0F90      		pop __tmp_reg__
 2933 0e7c 0F90      		pop __tmp_reg__
 2934 0e7e 0F90      	 	pop __tmp_reg__
 2935               	/* epilogue: frame size=0 */
 2936 0e80 0895      		ret
 2937               	/* epilogue end (size=1) */
 2938               	/* function setCompassBaud size 19 (18) */
 2939               		.size	setCompassBaud, .-setCompassBaud
 2940               	.Lscope23:
 2941               		.stabs	"",36,0,0,.Lscope23-setCompassBaud
 2942               		.stabd	78,0,0
 2943               		.stabs	"nmeap_latitude:F(0,13)",36,0,58,nmeap_latitude
 2944               		.stabs	"plat:P(0,16)",64,0,57,30
 2945               		.stabs	"phem:P(0,16)",64,0,57,26
 2946               	.global	nmeap_latitude
 2947               		.type	nmeap_latitude, @function
 2948               	nmeap_latitude:
 2949               		.stabd	46,0,0
 2950               		.stabs	"nmeap01.c",132,0,0,.Ltext5
 2951               	.Ltext5:
 2952               		.stabn	68,0,58,.LM252-nmeap_latitude
 2953               	.LM252:
 2954               	/* prologue: frame size=0 */
 2955 0e82 AF92      		push r10
 2956 0e84 BF92      		push r11
 2957 0e86 CF92      		push r12
 2958 0e88 DF92      		push r13
 2959 0e8a EF92      		push r14
 2960 0e8c FF92      		push r15
 2961 0e8e 0F93      		push r16
 2962 0e90 1F93      		push r17
 2963 0e92 CF93      		push r28
 2964 0e94 DF93      		push r29
 2965               	/* prologue end (size=10) */
 2966 0e96 FC01      		movw r30,r24
 2967 0e98 DB01      		movw r26,r22
 2968               		.stabn	68,0,64,.LM253-nmeap_latitude
 2969               	.LM253:
 2970 0e9a 892B      		or r24,r25
 2971 0e9c 09F4      		brne .L207
 2972               	.L220:
 2973 0e9e FFCF      		rjmp .L220
GAS LISTING /var/tmp//cchOv7GV.s 			page 77


 2974               	.L207:
 2975               		.stabn	68,0,65,.LM254-nmeap_latitude
 2976               	.LM254:
 2977 0ea0 672B      		or r22,r23
 2978 0ea2 09F4      		brne .L209
 2979               	.L221:
 2980 0ea4 FFCF      		rjmp .L221
 2981               	.L209:
 2982               		.stabn	68,0,67,.LM255-nmeap_latitude
 2983               	.LM255:
 2984 0ea6 8081      		ld r24,Z
 2985 0ea8 8823      		tst r24
 2986 0eaa 19F0      		breq .L222
 2987               		.stabn	68,0,70,.LM256-nmeap_latitude
 2988               	.LM256:
 2989 0eac 6C91      		ld r22,X
 2990 0eae 6623      		tst r22
 2991 0eb0 29F4      		brne .L214
 2992               	.L222:
 2993 0eb2 60E0      		ldi r22,lo8(0x0)
 2994 0eb4 70E0      		ldi r23,hi8(0x0)
 2995 0eb6 80E0      		ldi r24,hlo8(0x0)
 2996 0eb8 90E0      		ldi r25,hhi8(0x0)
 2997 0eba 43C0      		rjmp .L213
 2998               	.L214:
 2999               		.stabn	68,0,75,.LM257-nmeap_latitude
 3000               	.LM257:
 3001 0ebc 6E34      		cpi r22,lo8(78)
 3002 0ebe 19F4      		brne .L216
 3003 0ec0 C1E0      		ldi r28,lo8(1)
 3004 0ec2 D0E0      		ldi r29,hi8(1)
 3005 0ec4 02C0      		rjmp .L218
 3006               	.L216:
 3007 0ec6 CFEF      		ldi r28,lo8(-1)
 3008 0ec8 DFEF      		ldi r29,hi8(-1)
 3009               	.L218:
 3010               		.stabn	68,0,85,.LM258-nmeap_latitude
 3011               	.LM258:
 3012 0eca CF01      		movw r24,r30
 3013 0ecc 0E94 0000 		call atof
 3014 0ed0 5B01      		movw r10,r22
 3015 0ed2 6C01      		movw r12,r24
 3016               		.stabn	68,0,91,.LM259-nmeap_latitude
 3017               	.LM259:
 3018 0ed4 20E0      		ldi r18,lo8(0x42c80000)
 3019 0ed6 30E0      		ldi r19,hi8(0x42c80000)
 3020 0ed8 48EC      		ldi r20,hlo8(0x42c80000)
 3021 0eda 52E4      		ldi r21,hhi8(0x42c80000)
 3022 0edc 0E94 0000 		call __divsf3
 3023 0ee0 0E94 0000 		call __fixsfsi
 3024 0ee4 8827      		clr r24
 3025 0ee6 77FD      		sbrc r23,7
 3026 0ee8 8095      		com r24
 3027 0eea 982F      		mov r25,r24
 3028 0eec 0E94 0000 		call __floatsisf
 3029 0ef0 7B01      		movw r14,r22
 3030 0ef2 8C01      		movw r16,r24
GAS LISTING /var/tmp//cchOv7GV.s 			page 78


 3031               		.stabn	68,0,94,.LM260-nmeap_latitude
 3032               	.LM260:
 3033 0ef4 20E0      		ldi r18,lo8(0xc2c80000)
 3034 0ef6 30E0      		ldi r19,hi8(0xc2c80000)
 3035 0ef8 48EC      		ldi r20,hlo8(0xc2c80000)
 3036 0efa 52EC      		ldi r21,hhi8(0xc2c80000)
 3037 0efc 0E94 0000 		call __mulsf3
 3038 0f00 9B01      		movw r18,r22
 3039 0f02 AC01      		movw r20,r24
 3040 0f04 C601      		movw r24,r12
 3041 0f06 B501      		movw r22,r10
 3042 0f08 0E94 0000 		call __addsf3
 3043 0f0c 20E0      		ldi r18,lo8(0x42700000)
 3044 0f0e 30E0      		ldi r19,hi8(0x42700000)
 3045 0f10 40E7      		ldi r20,hlo8(0x42700000)
 3046 0f12 52E4      		ldi r21,hhi8(0x42700000)
 3047 0f14 0E94 0000 		call __divsf3
 3048 0f18 9B01      		movw r18,r22
 3049 0f1a AC01      		movw r20,r24
 3050 0f1c C801      		movw r24,r16
 3051 0f1e B701      		movw r22,r14
 3052 0f20 0E94 0000 		call __addsf3
 3053 0f24 7B01      		movw r14,r22
 3054 0f26 8C01      		movw r16,r24
 3055 0f28 BE01      		movw r22,r28
 3056 0f2a 8827      		clr r24
 3057 0f2c 77FD      		sbrc r23,7
 3058 0f2e 8095      		com r24
 3059 0f30 982F      		mov r25,r24
 3060 0f32 0E94 0000 		call __floatsisf
 3061 0f36 9B01      		movw r18,r22
 3062 0f38 AC01      		movw r20,r24
 3063 0f3a C801      		movw r24,r16
 3064 0f3c B701      		movw r22,r14
 3065 0f3e 0E94 0000 		call __mulsf3
 3066               	.L213:
 3067               	/* epilogue: frame size=0 */
 3068 0f42 DF91      		pop r29
 3069 0f44 CF91      		pop r28
 3070 0f46 1F91      		pop r17
 3071 0f48 0F91      		pop r16
 3072 0f4a FF90      		pop r15
 3073 0f4c EF90      		pop r14
 3074 0f4e DF90      		pop r13
 3075 0f50 CF90      		pop r12
 3076 0f52 BF90      		pop r11
 3077 0f54 AF90      		pop r10
 3078 0f56 0895      		ret
 3079               	/* epilogue end (size=11) */
 3080               	/* function nmeap_latitude size 107 (86) */
 3081               		.size	nmeap_latitude, .-nmeap_latitude
 3082               		.stabs	"lat:r(0,13)",64,0,59,22
 3083               		.stabs	"ns:r(0,1)",64,0,62,28
 3084               		.stabn	192,0,0,nmeap_latitude-nmeap_latitude
 3085               		.stabn	224,0,0,.Lscope24-nmeap_latitude
 3086               	.Lscope24:
 3087               		.stabs	"",36,0,0,.Lscope24-nmeap_latitude
GAS LISTING /var/tmp//cchOv7GV.s 			page 79


 3088               		.stabd	78,0,0
 3089               		.stabs	"nmeap_longitude:F(0,13)",36,0,105,nmeap_longitude
 3090               		.stabs	"plon:P(0,16)",64,0,104,30
 3091               		.stabs	"phem:P(0,16)",64,0,104,26
 3092               	.global	nmeap_longitude
 3093               		.type	nmeap_longitude, @function
 3094               	nmeap_longitude:
 3095               		.stabd	46,0,0
 3096               		.stabn	68,0,105,.LM261-nmeap_longitude
 3097               	.LM261:
 3098               	/* prologue: frame size=0 */
 3099 0f58 AF92      		push r10
 3100 0f5a BF92      		push r11
 3101 0f5c CF92      		push r12
 3102 0f5e DF92      		push r13
 3103 0f60 EF92      		push r14
 3104 0f62 FF92      		push r15
 3105 0f64 0F93      		push r16
 3106 0f66 1F93      		push r17
 3107 0f68 CF93      		push r28
 3108 0f6a DF93      		push r29
 3109               	/* prologue end (size=10) */
 3110 0f6c FC01      		movw r30,r24
 3111 0f6e DB01      		movw r26,r22
 3112               		.stabn	68,0,111,.LM262-nmeap_longitude
 3113               	.LM262:
 3114 0f70 892B      		or r24,r25
 3115 0f72 09F4      		brne .L224
 3116               	.L237:
 3117 0f74 FFCF      		rjmp .L237
 3118               	.L224:
 3119               		.stabn	68,0,112,.LM263-nmeap_longitude
 3120               	.LM263:
 3121 0f76 672B      		or r22,r23
 3122 0f78 09F4      		brne .L226
 3123               	.L238:
 3124 0f7a FFCF      		rjmp .L238
 3125               	.L226:
 3126               		.stabn	68,0,114,.LM264-nmeap_longitude
 3127               	.LM264:
 3128 0f7c 8081      		ld r24,Z
 3129 0f7e 8823      		tst r24
 3130 0f80 19F0      		breq .L239
 3131               		.stabn	68,0,117,.LM265-nmeap_longitude
 3132               	.LM265:
 3133 0f82 6C91      		ld r22,X
 3134 0f84 6623      		tst r22
 3135 0f86 29F4      		brne .L231
 3136               	.L239:
 3137 0f88 60E0      		ldi r22,lo8(0x0)
 3138 0f8a 70E0      		ldi r23,hi8(0x0)
 3139 0f8c 80E0      		ldi r24,hlo8(0x0)
 3140 0f8e 90E0      		ldi r25,hhi8(0x0)
 3141 0f90 43C0      		rjmp .L230
 3142               	.L231:
 3143               		.stabn	68,0,122,.LM266-nmeap_longitude
 3144               	.LM266:
GAS LISTING /var/tmp//cchOv7GV.s 			page 80


 3145 0f92 6534      		cpi r22,lo8(69)
 3146 0f94 19F4      		brne .L233
 3147 0f96 C1E0      		ldi r28,lo8(1)
 3148 0f98 D0E0      		ldi r29,hi8(1)
 3149 0f9a 02C0      		rjmp .L235
 3150               	.L233:
 3151 0f9c CFEF      		ldi r28,lo8(-1)
 3152 0f9e DFEF      		ldi r29,hi8(-1)
 3153               	.L235:
 3154               		.stabn	68,0,132,.LM267-nmeap_longitude
 3155               	.LM267:
 3156 0fa0 CF01      		movw r24,r30
 3157 0fa2 0E94 0000 		call atof
 3158 0fa6 5B01      		movw r10,r22
 3159 0fa8 6C01      		movw r12,r24
 3160               		.stabn	68,0,138,.LM268-nmeap_longitude
 3161               	.LM268:
 3162 0faa 20E0      		ldi r18,lo8(0x42c80000)
 3163 0fac 30E0      		ldi r19,hi8(0x42c80000)
 3164 0fae 48EC      		ldi r20,hlo8(0x42c80000)
 3165 0fb0 52E4      		ldi r21,hhi8(0x42c80000)
 3166 0fb2 0E94 0000 		call __divsf3
 3167 0fb6 0E94 0000 		call __fixsfsi
 3168 0fba 8827      		clr r24
 3169 0fbc 77FD      		sbrc r23,7
 3170 0fbe 8095      		com r24
 3171 0fc0 982F      		mov r25,r24
 3172 0fc2 0E94 0000 		call __floatsisf
 3173 0fc6 7B01      		movw r14,r22
 3174 0fc8 8C01      		movw r16,r24
 3175               		.stabn	68,0,141,.LM269-nmeap_longitude
 3176               	.LM269:
 3177 0fca 20E0      		ldi r18,lo8(0xc2c80000)
 3178 0fcc 30E0      		ldi r19,hi8(0xc2c80000)
 3179 0fce 48EC      		ldi r20,hlo8(0xc2c80000)
 3180 0fd0 52EC      		ldi r21,hhi8(0xc2c80000)
 3181 0fd2 0E94 0000 		call __mulsf3
 3182 0fd6 9B01      		movw r18,r22
 3183 0fd8 AC01      		movw r20,r24
 3184 0fda C601      		movw r24,r12
 3185 0fdc B501      		movw r22,r10
 3186 0fde 0E94 0000 		call __addsf3
 3187 0fe2 20E0      		ldi r18,lo8(0x42700000)
 3188 0fe4 30E0      		ldi r19,hi8(0x42700000)
 3189 0fe6 40E7      		ldi r20,hlo8(0x42700000)
 3190 0fe8 52E4      		ldi r21,hhi8(0x42700000)
 3191 0fea 0E94 0000 		call __divsf3
 3192 0fee 9B01      		movw r18,r22
 3193 0ff0 AC01      		movw r20,r24
 3194 0ff2 C801      		movw r24,r16
 3195 0ff4 B701      		movw r22,r14
 3196 0ff6 0E94 0000 		call __addsf3
 3197 0ffa 7B01      		movw r14,r22
 3198 0ffc 8C01      		movw r16,r24
 3199 0ffe BE01      		movw r22,r28
 3200 1000 8827      		clr r24
 3201 1002 77FD      		sbrc r23,7
GAS LISTING /var/tmp//cchOv7GV.s 			page 81


 3202 1004 8095      		com r24
 3203 1006 982F      		mov r25,r24
 3204 1008 0E94 0000 		call __floatsisf
 3205 100c 9B01      		movw r18,r22
 3206 100e AC01      		movw r20,r24
 3207 1010 C801      		movw r24,r16
 3208 1012 B701      		movw r22,r14
 3209 1014 0E94 0000 		call __mulsf3
 3210               	.L230:
 3211               	/* epilogue: frame size=0 */
 3212 1018 DF91      		pop r29
 3213 101a CF91      		pop r28
 3214 101c 1F91      		pop r17
 3215 101e 0F91      		pop r16
 3216 1020 FF90      		pop r15
 3217 1022 EF90      		pop r14
 3218 1024 DF90      		pop r13
 3219 1026 CF90      		pop r12
 3220 1028 BF90      		pop r11
 3221 102a AF90      		pop r10
 3222 102c 0895      		ret
 3223               	/* epilogue end (size=11) */
 3224               	/* function nmeap_longitude size 107 (86) */
 3225               		.size	nmeap_longitude, .-nmeap_longitude
 3226               		.stabs	"lon:r(0,13)",64,0,106,22
 3227               		.stabs	"ew:r(0,1)",64,0,109,28
 3228               		.stabn	192,0,0,nmeap_longitude-nmeap_longitude
 3229               		.stabn	224,0,0,.Lscope25-nmeap_longitude
 3230               	.Lscope25:
 3231               		.stabs	"",36,0,0,.Lscope25-nmeap_longitude
 3232               		.stabd	78,0,0
 3233               		.data
 3234               	.LC0:
 3235 0023 2573 00   		.string	"%s"
 3236               	.LC1:
 3237 0026 2573 3D3D 		.string	"%s==%s %02x==%02x\n"
 3237      2573 2025 
 3237      3032 783D 
 3237      3D25 3032 
 3237      780A 00
 3238               	.LC2:
 3239 0039 2564 3A25 		.string	"%d:%s\n"
 3239      730A 00
 3240               		.text
 3241               		.stabs	"nmeap_gprmc:F(0,1)",36,0,582,nmeap_gprmc
 3242               		.stabs	"context:P(0,18)",64,0,581,28
 3243               		.stabs	"sentence:P(0,22)=*(13,5)",64,0,581,10
 3244               	.global	nmeap_gprmc
 3245               		.type	nmeap_gprmc, @function
 3246               	nmeap_gprmc:
 3247               		.stabd	46,0,0
 529:nmeap01.c     ****     return status;
 530:nmeap01.c     **** }
 531:nmeap01.c     **** 
 532:nmeap01.c     **** /** 
 533:nmeap01.c     ****  * standard GPGGA sentence parser 
 534:nmeap01.c     ****  */
GAS LISTING /var/tmp//cchOv7GV.s 			page 82


 535:nmeap01.c     **** int nmeap_gpgga(nmeap_context_t *context,nmeap_sentence_t *sentence)
 536:nmeap01.c     **** {
 537:nmeap01.c     **** #ifndef NDEBUG	
 538:nmeap01.c     ****     int i;
 539:nmeap01.c     **** #endif
 540:nmeap01.c     ****     
 541:nmeap01.c     ****     /* get pointer to sentence data */
 542:nmeap01.c     ****     nmeap_gga_t *gga = (nmeap_gga_t *)sentence->data;
 543:nmeap01.c     ****     
 544:nmeap01.c     ****     /* if there is a data element, extract data from the tokens */
 545:nmeap01.c     **** 	if (gga != 0) {
 546:nmeap01.c     **** 		gga->latitude  = nmeap_latitude(context->token[2],context->token[3]);
 547:nmeap01.c     **** 		gga->longitude = nmeap_longitude(context->token[4],context->token[5]);
 548:nmeap01.c     **** 		gga->altitude  = nmeap_altitude(context->token[9],context->token[10]);
 549:nmeap01.c     **** 		gga->time       = atoi(context->token[1]);
 550:nmeap01.c     **** 		gga->satellites = atoi(context->token[7]);
 551:nmeap01.c     **** 		gga->quality    = atoi(context->token[6]);
 552:nmeap01.c     **** 		gga->hdop       = atof(context->token[8]);
 553:nmeap01.c     **** 		gga->geoid      = nmeap_altitude(context->token[11],context->token[12]);
 554:nmeap01.c     **** 	}
 555:nmeap01.c     **** 
 556:nmeap01.c     **** #ifndef NDEBUG    
 557:nmeap01.c     ****     /* print raw input string */
 558:nmeap01.c     ****     printf("%s",context->debug_input);
 559:nmeap01.c     ****     
 560:nmeap01.c     ****     /* print some validation data */
 561:nmeap01.c     ****     printf("%s==%s %02x==%02x\n",context->input_name,sentence->name,context->icks,context->ccks);
 562:nmeap01.c     ****     
 563:nmeap01.c     ****     /* print the tokens */
 564:nmeap01.c     ****     for(i=0;i<context->tokens;i++) {
 565:nmeap01.c     ****         printf("%d:%s\n",i,context->token[i]);
 566:nmeap01.c     ****     }
 567:nmeap01.c     **** #endif   
 568:nmeap01.c     **** 
 569:nmeap01.c     ****     /* if the sentence has a callout, call it */
 570:nmeap01.c     ****     if (sentence->callout != 0) {
 571:nmeap01.c     ****         (*sentence->callout)(context,gga,context->user_data);
 572:nmeap01.c     ****     }
 573:nmeap01.c     ****     
 574:nmeap01.c     ****     return NMEAP_GPGGA;
 575:nmeap01.c     **** }
 576:nmeap01.c     **** 
 577:nmeap01.c     **** /** 
 578:nmeap01.c     ****  * standard GPRMCntence parser 
 579:nmeap01.c     ****  */
 580:nmeap01.c     **** int nmeap_gprmc(nmeap_context_t *context,nmeap_sentence_t *sentence)
 581:nmeap01.c     **** {
 582:nmeap01.c     **** #ifndef NDEBUG	
 3248               		.stabn	68,0,582,.LM270-nmeap_gprmc
 3249               	.LM270:
 3250               	/* prologue: frame size=0 */
 3251 102e AF92      		push r10
 3252 1030 BF92      		push r11
 3253 1032 CF92      		push r12
 3254 1034 DF92      		push r13
 3255 1036 EF92      		push r14
 3256 1038 FF92      		push r15
GAS LISTING /var/tmp//cchOv7GV.s 			page 83


 3257 103a 0F93      		push r16
 3258 103c 1F93      		push r17
 3259 103e CF93      		push r28
 3260 1040 DF93      		push r29
 3261               	/* prologue end (size=10) */
 3262 1042 EC01      		movw r28,r24
 3263 1044 5B01      		movw r10,r22
 583:nmeap01.c     ****     int i;
 584:nmeap01.c     **** #endif
 585:nmeap01.c     **** 
 586:nmeap01.c     ****     /* get pointer to sentence data */
 587:nmeap01.c     ****     nmeap_rmc_t *rmc = (nmeap_rmc_t *)sentence->data;
 588:nmeap01.c     ****     
 3264               		.stabn	68,0,588,.LM271-nmeap_gprmc
 3265               	.LM271:
 3266 1046 FB01      		movw r30,r22
 3267 1048 0485      		ldd r16,Z+12
 3268 104a 1585      		ldd r17,Z+13
 589:nmeap01.c     **** 	/* if there is a data element, use it */
 590:nmeap01.c     **** 	if (rmc != 0) {
 591:nmeap01.c     **** 		/* extract data from the tokens */
 3269               		.stabn	68,0,591,.LM272-nmeap_gprmc
 3270               	.LM272:
 3271 104c 0115      		cp r16,__zero_reg__
 3272 104e 1105      		cpc r17,__zero_reg__
 3273 1050 09F4      		brne .+2
 3274 1052 65C0      		rjmp .L241
 592:nmeap01.c     **** 		rmc->time       = atoi(context->token[1]);
 593:nmeap01.c     **** 		rmc->warn       = *context->token[2];
 3275               		.stabn	68,0,593,.LM273-nmeap_gprmc
 3276               	.LM273:
 3277 1054 C058      		subi r28,lo8(-(384))
 3278 1056 DE4F      		sbci r29,hi8(-(384))
 3279 1058 8991      		ld r24,Y+
 3280 105a 9991      		ld r25,Y+
 3281 105c 0E94 0000 		call atoi
 3282 1060 AA27      		clr r26
 3283 1062 97FD      		sbrc r25,7
 3284 1064 A095      		com r26
 3285 1066 BA2F      		mov r27,r26
 3286 1068 F801      		movw r30,r16
 3287 106a 8083      		st Z,r24
 3288 106c 9183      		std Z+1,r25
 3289 106e A283      		std Z+2,r26
 3290 1070 B383      		std Z+3,r27
 594:nmeap01.c     **** 		rmc->latitude  = nmeap_latitude(context->token[3],context->token[4]);
 3291               		.stabn	68,0,594,.LM274-nmeap_gprmc
 3292               	.LM274:
 3293 1072 E881      		ld r30,Y
 3294 1074 F981      		ldd r31,Y+1
 3295 1076 8081      		ld r24,Z
 3296 1078 F801      		movw r30,r16
 3297 107a 8483      		std Z+4,r24
 595:nmeap01.c     **** 		rmc->longitude = nmeap_longitude(context->token[5],context->token[6]);
 3298               		.stabn	68,0,595,.LM275-nmeap_gprmc
 3299               	.LM275:
 3300 107c 2496      		adiw r28,4
GAS LISTING /var/tmp//cchOv7GV.s 			page 84


 3301 107e 6881      		ld r22,Y
 3302 1080 7981      		ldd r23,Y+1
 3303 1082 9A91      		ld r25,-Y
 3304 1084 8A91      		ld r24,-Y
 3305 1086 0E94 0000 		call nmeap_latitude
 3306 108a F801      		movw r30,r16
 3307 108c 6583      		std Z+5,r22
 3308 108e 7683      		std Z+6,r23
 3309 1090 8783      		std Z+7,r24
 3310 1092 9087      		std Z+8,r25
 596:nmeap01.c     **** 		rmc->speed      = atof(context->token[7]);
 3311               		.stabn	68,0,596,.LM276-nmeap_gprmc
 3312               	.LM276:
 3313 1094 2696      		adiw r28,6
 3314 1096 6881      		ld r22,Y
 3315 1098 7981      		ldd r23,Y+1
 3316 109a CA58      		subi r28,lo8(-(-394))
 3317 109c D140      		sbci r29,hi8(-(-394))
 3318 109e FE01      		movw r30,r28
 3319 10a0 E857      		subi r30,lo8(-(392))
 3320 10a2 FE4F      		sbci r31,hi8(-(392))
 3321 10a4 8081      		ld r24,Z
 3322 10a6 9181      		ldd r25,Z+1
 3323 10a8 0E94 0000 		call nmeap_longitude
 3324 10ac F801      		movw r30,r16
 3325 10ae 6187      		std Z+9,r22
 3326 10b0 7287      		std Z+10,r23
 3327 10b2 8387      		std Z+11,r24
 3328 10b4 9487      		std Z+12,r25
 597:nmeap01.c     **** 		rmc->course     = atof(context->token[8]);
 3329               		.stabn	68,0,597,.LM277-nmeap_gprmc
 3330               	.LM277:
 3331 10b6 FE01      		movw r30,r28
 3332 10b8 E457      		subi r30,lo8(-(396))
 3333 10ba FE4F      		sbci r31,hi8(-(396))
 3334 10bc 8081      		ld r24,Z
 3335 10be 9181      		ldd r25,Z+1
 3336 10c0 0E94 0000 		call atof
 3337 10c4 F801      		movw r30,r16
 3338 10c6 6587      		std Z+13,r22
 3339 10c8 7687      		std Z+14,r23
 3340 10ca 8787      		std Z+15,r24
 3341 10cc 908B      		std Z+16,r25
 598:nmeap01.c     **** 		rmc->date       = atoi(context->token[9]);
 3342               		.stabn	68,0,598,.LM278-nmeap_gprmc
 3343               	.LM278:
 3344 10ce FE01      		movw r30,r28
 3345 10d0 E257      		subi r30,lo8(-(398))
 3346 10d2 FE4F      		sbci r31,hi8(-(398))
 3347 10d4 8081      		ld r24,Z
 3348 10d6 9181      		ldd r25,Z+1
 3349 10d8 0E94 0000 		call atof
 3350 10dc F801      		movw r30,r16
 3351 10de 618B      		std Z+17,r22
 3352 10e0 728B      		std Z+18,r23
 3353 10e2 838B      		std Z+19,r24
 3354 10e4 948B      		std Z+20,r25
GAS LISTING /var/tmp//cchOv7GV.s 			page 85


 599:nmeap01.c     **** 		rmc->magvar     = atof(context->token[10]);
 3355               		.stabn	68,0,599,.LM279-nmeap_gprmc
 3356               	.LM279:
 3357 10e6 FE01      		movw r30,r28
 3358 10e8 E057      		subi r30,lo8(-(400))
 3359 10ea FE4F      		sbci r31,hi8(-(400))
 3360 10ec 8081      		ld r24,Z
 3361 10ee 9181      		ldd r25,Z+1
 3362 10f0 0E94 0000 		call atoi
 3363 10f4 AA27      		clr r26
 3364 10f6 97FD      		sbrc r25,7
 3365 10f8 A095      		com r26
 3366 10fa BA2F      		mov r27,r26
 3367 10fc F801      		movw r30,r16
 3368 10fe 858B      		std Z+21,r24
 3369 1100 968B      		std Z+22,r25
 3370 1102 A78B      		std Z+23,r26
 3371 1104 B08F      		std Z+24,r27
 600:nmeap01.c     **** 	}
 3372               		.stabn	68,0,600,.LM280-nmeap_gprmc
 3373               	.LM280:
 3374 1106 FE01      		movw r30,r28
 3375 1108 EE56      		subi r30,lo8(-(402))
 3376 110a FE4F      		sbci r31,hi8(-(402))
 3377 110c 8081      		ld r24,Z
 3378 110e 9181      		ldd r25,Z+1
 3379 1110 0E94 0000 		call atof
 3380 1114 F801      		movw r30,r16
 3381 1116 618F      		std Z+25,r22
 3382 1118 728F      		std Z+26,r23
 3383 111a 838F      		std Z+27,r24
 3384 111c 948F      		std Z+28,r25
 3385               	.L241:
 601:nmeap01.c     **** 
 602:nmeap01.c     **** #ifndef NDEBUG    
 603:nmeap01.c     ****     /* print raw input string */
 604:nmeap01.c     ****     printf("%s",context->debug_input);
 605:nmeap01.c     ****     
 3386               		.stabn	68,0,605,.LM281-nmeap_gprmc
 3387               	.LM281:
 3388 111e C453      		subi r28,lo8(-(460))
 3389 1120 DE4F      		sbci r29,hi8(-(460))
 3390 1122 DF93      		push r29
 3391 1124 CF93      		push r28
 3392 1126 80E0      		ldi r24,lo8(.LC0)
 3393 1128 90E0      		ldi r25,hi8(.LC0)
 3394 112a 9F93      		push r25
 3395 112c 8F93      		push r24
 3396 112e 0E94 0000 		call printf
 606:nmeap01.c     ****     /* print some validation data */
 607:nmeap01.c     ****     printf("%s==%s %02x==%02x\n",context->input_name,sentence->name,context->icks,context->ccks);
 608:nmeap01.c     ****     
 3397               		.stabn	68,0,608,.LM282-nmeap_gprmc
 3398               	.LM282:
 3399 1132 CF54      		subi r28,lo8(-(-79))
 3400 1134 D040      		sbci r29,hi8(-(-79))
 3401 1136 8881      		ld r24,Y
GAS LISTING /var/tmp//cchOv7GV.s 			page 86


 3402 1138 9927      		clr r25
 3403 113a 87FD      		sbrc r24,7
 3404 113c 9095      		com r25
 3405 113e 9F93      		push r25
 3406 1140 8F93      		push r24
 3407 1142 8A91      		ld r24,-Y
 3408 1144 9927      		clr r25
 3409 1146 87FD      		sbrc r24,7
 3410 1148 9095      		com r25
 3411 114a 9F93      		push r25
 3412 114c 8F93      		push r24
 3413 114e BF92      		push r11
 3414 1150 AF92      		push r10
 3415 1152 2697      		sbiw r28,6
 3416 1154 DF93      		push r29
 3417 1156 CF93      		push r28
 3418 1158 C657      		subi r28,lo8(-(-374))
 3419 115a D140      		sbci r29,hi8(-(-374))
 3420 115c 80E0      		ldi r24,lo8(.LC1)
 3421 115e 90E0      		ldi r25,hi8(.LC1)
 3422 1160 9F93      		push r25
 3423 1162 8F93      		push r24
 3424 1164 0E94 0000 		call printf
 3425 1168 FEE7      		ldi r31,lo8(382)
 3426 116a CF2E      		mov r12,r31
 3427 116c F1E0      		ldi r31,hi8(382)
 3428 116e DF2E      		mov r13,r31
 3429 1170 CC0E      		add r12,r28
 3430 1172 DD1E      		adc r13,r29
 3431 1174 EE24      		clr r14
 3432 1176 FF24      		clr r15
 609:nmeap01.c     ****     /* print the tokens */
 610:nmeap01.c     ****     for(i=0;i<context->tokens;i++) {
 611:nmeap01.c     ****         printf("%d:%s\n",i,context->token[i]);
 3433               		.stabn	68,0,611,.LM283-nmeap_gprmc
 3434               	.LM283:
 3435 1178 8DB7      		in r24,__SP_L__
 3436 117a 9EB7      		in r25,__SP_H__
 3437 117c 0E96      		adiw r24,14
 3438 117e 14C0      		rjmp .L249
 3439               	.L244:
 612:nmeap01.c     ****     }
 3440               		.stabn	68,0,612,.LM284-nmeap_gprmc
 3441               	.LM284:
 3442 1180 F601      		movw r30,r12
 3443 1182 8191      		ld r24,Z+
 3444 1184 9191      		ld r25,Z+
 3445 1186 6F01      		movw r12,r30
 3446 1188 9F93      		push r25
 3447 118a 8F93      		push r24
 3448 118c FF92      		push r15
 3449 118e EF92      		push r14
 3450 1190 80E0      		ldi r24,lo8(.LC2)
 3451 1192 90E0      		ldi r25,hi8(.LC2)
 3452 1194 9F93      		push r25
 3453 1196 8F93      		push r24
 3454 1198 0E94 0000 		call printf
GAS LISTING /var/tmp//cchOv7GV.s 			page 87


 3455               		.stabn	68,0,611,.LM285-nmeap_gprmc
 3456               	.LM285:
 3457 119c 0894      		sec
 3458 119e E11C      		adc r14,__zero_reg__
 3459 11a0 F11C      		adc r15,__zero_reg__
 3460 11a2 8DB7      		in r24,__SP_L__
 3461 11a4 9EB7      		in r25,__SP_H__
 3462 11a6 0696      		adiw r24,6
 3463               	.L249:
 3464 11a8 0FB6      		in __tmp_reg__,__SREG__
 3465 11aa F894      		cli
 3466 11ac 9EBF      		out __SP_H__,r25
 3467 11ae 0FBE      		out __SREG__,__tmp_reg__
 3468 11b0 8DBF      		out __SP_L__,r24
 3469 11b2 C255      		subi r28,lo8(-(430))
 3470 11b4 DE4F      		sbci r29,hi8(-(430))
 3471 11b6 8881      		ld r24,Y
 3472 11b8 9981      		ldd r25,Y+1
 3473 11ba CE5A      		subi r28,lo8(-(-430))
 3474 11bc D140      		sbci r29,hi8(-(-430))
 3475 11be E816      		cp r14,r24
 3476 11c0 F906      		cpc r15,r25
 3477 11c2 F4F2      		brlt .L244
 613:nmeap01.c     **** #endif   
 614:nmeap01.c     **** 
 615:nmeap01.c     ****     /* if the sentence has a callout, call it */
 616:nmeap01.c     ****     if (sentence->callout != 0) {
 617:nmeap01.c     ****         (*sentence->callout)(context,rmc,context->user_data);
 3478               		.stabn	68,0,617,.LM286-nmeap_gprmc
 3479               	.LM286:
 3480 11c4 F501      		movw r30,r10
 3481 11c6 2285      		ldd r18,Z+10
 3482 11c8 3385      		ldd r19,Z+11
 3483 11ca 2115      		cp r18,__zero_reg__
 3484 11cc 3105      		cpc r19,__zero_reg__
 3485 11ce 51F0      		breq .L246
 618:nmeap01.c     ****     }
 3486               		.stabn	68,0,618,.LM287-nmeap_gprmc
 3487               	.LM287:
 3488 11d0 C453      		subi r28,lo8(-(716))
 3489 11d2 DD4F      		sbci r29,hi8(-(716))
 3490 11d4 4881      		ld r20,Y
 3491 11d6 5981      		ldd r21,Y+1
 3492 11d8 CC5C      		subi r28,lo8(-(-716))
 3493 11da D240      		sbci r29,hi8(-(-716))
 3494 11dc B801      		movw r22,r16
 3495 11de CE01      		movw r24,r28
 3496 11e0 F901      		movw r30,r18
 3497 11e2 0995      		icall
 3498               	.L246:
 619:nmeap01.c     ****     
 620:nmeap01.c     ****     return NMEAP_GPRMC;
 621:nmeap01.c     **** }
 622:nmeap01.c     **** 
 3499               		.stabn	68,0,622,.LM288-nmeap_gprmc
 3500               	.LM288:
 3501 11e4 82E0      		ldi r24,lo8(2)
GAS LISTING /var/tmp//cchOv7GV.s 			page 88


 3502 11e6 90E0      		ldi r25,hi8(2)
 3503               	/* epilogue: frame size=0 */
 3504 11e8 DF91      		pop r29
 3505 11ea CF91      		pop r28
 3506 11ec 1F91      		pop r17
 3507 11ee 0F91      		pop r16
 3508 11f0 FF90      		pop r15
 3509 11f2 EF90      		pop r14
 3510 11f4 DF90      		pop r13
 3511 11f6 CF90      		pop r12
 3512 11f8 BF90      		pop r11
 3513 11fa AF90      		pop r10
 3514 11fc 0895      		ret
 3515               	/* epilogue end (size=11) */
 3516               	/* function nmeap_gprmc size 232 (211) */
 3517               		.size	nmeap_gprmc, .-nmeap_gprmc
 3518               		.stabs	"i:r(0,1)",64,0,584,14
 3519               		.stabs	"rmc:r(0,23)=*(12,10)",64,0,588,16
 3520               		.stabn	192,0,0,nmeap_gprmc-nmeap_gprmc
 3521               		.stabn	224,0,0,.Lscope26-nmeap_gprmc
 3522               	.Lscope26:
 3523               		.stabs	"",36,0,0,.Lscope26-nmeap_gprmc
 3524               		.stabd	78,0,0
 3525               		.stabs	"nmeap_gpgga:F(0,1)",36,0,537,nmeap_gpgga
 3526               		.stabs	"context:P(0,18)",64,0,536,28
 3527               		.stabs	"sentence:P(0,22)",64,0,536,10
 3528               	.global	nmeap_gpgga
 3529               		.type	nmeap_gpgga, @function
 3530               	nmeap_gpgga:
 3531               		.stabd	46,0,0
 3532               		.stabn	68,0,537,.LM289-nmeap_gpgga
 3533               	.LM289:
 3534               	/* prologue: frame size=0 */
 3535 11fe AF92      		push r10
 3536 1200 BF92      		push r11
 3537 1202 CF92      		push r12
 3538 1204 DF92      		push r13
 3539 1206 EF92      		push r14
 3540 1208 FF92      		push r15
 3541 120a 0F93      		push r16
 3542 120c 1F93      		push r17
 3543 120e CF93      		push r28
 3544 1210 DF93      		push r29
 3545               	/* prologue end (size=10) */
 3546 1212 EC01      		movw r28,r24
 3547 1214 5B01      		movw r10,r22
 3548               		.stabn	68,0,543,.LM290-nmeap_gpgga
 3549               	.LM290:
 3550 1216 FB01      		movw r30,r22
 3551 1218 0485      		ldd r16,Z+12
 3552 121a 1585      		ldd r17,Z+13
 3553               		.stabn	68,0,546,.LM291-nmeap_gpgga
 3554               	.LM291:
 3555 121c 0115      		cp r16,__zero_reg__
 3556 121e 1105      		cpc r17,__zero_reg__
 3557 1220 09F4      		brne .+2
 3558 1222 5DC0      		rjmp .L251
GAS LISTING /var/tmp//cchOv7GV.s 			page 89


 3559               		.stabn	68,0,547,.LM292-nmeap_gpgga
 3560               	.LM292:
 3561 1224 CC57      		subi r28,lo8(-(388))
 3562 1226 DE4F      		sbci r29,hi8(-(388))
 3563 1228 6881      		ld r22,Y
 3564 122a 7981      		ldd r23,Y+1
 3565 122c 9A91      		ld r25,-Y
 3566 122e 8A91      		ld r24,-Y
 3567 1230 0E94 0000 		call nmeap_latitude
 3568 1234 F801      		movw r30,r16
 3569 1236 6083      		st Z,r22
 3570 1238 7183      		std Z+1,r23
 3571 123a 8283      		std Z+2,r24
 3572 123c 9383      		std Z+3,r25
 3573               		.stabn	68,0,548,.LM293-nmeap_gpgga
 3574               	.LM293:
 3575 123e 2696      		adiw r28,6
 3576 1240 6881      		ld r22,Y
 3577 1242 7981      		ldd r23,Y+1
 3578 1244 9A91      		ld r25,-Y
 3579 1246 8A91      		ld r24,-Y
 3580 1248 0E94 0000 		call nmeap_longitude
 3581 124c F801      		movw r30,r16
 3582 124e 6483      		std Z+4,r22
 3583 1250 7583      		std Z+5,r23
 3584 1252 8683      		std Z+6,r24
 3585 1254 9783      		std Z+7,r25
 3586               		.stabn	68,0,549,.LM294-nmeap_gpgga
 3587               	.LM294:
 3588 1256 2C96      		adiw r28,12
 3589 1258 6881      		ld r22,Y
 3590 125a 7981      		ldd r23,Y+1
 3591 125c 9A91      		ld r25,-Y
 3592 125e 8A91      		ld r24,-Y
 3593 1260 0E94 0000 		call nmeap_altitude
 3594 1264 F801      		movw r30,r16
 3595 1266 6087      		std Z+8,r22
 3596 1268 7187      		std Z+9,r23
 3597 126a 8287      		std Z+10,r24
 3598 126c 9387      		std Z+11,r25
 3599               		.stabn	68,0,550,.LM295-nmeap_gpgga
 3600               	.LM295:
 3601 126e 6097      		sbiw r28,16
 3602 1270 8881      		ld r24,Y
 3603 1272 9981      		ldd r25,Y+1
 3604 1274 0E94 0000 		call atoi
 3605 1278 AA27      		clr r26
 3606 127a 97FD      		sbrc r25,7
 3607 127c A095      		com r26
 3608 127e BA2F      		mov r27,r26
 3609 1280 F801      		movw r30,r16
 3610 1282 8487      		std Z+12,r24
 3611 1284 9587      		std Z+13,r25
 3612 1286 A687      		std Z+14,r26
 3613 1288 B787      		std Z+15,r27
 3614               		.stabn	68,0,551,.LM296-nmeap_gpgga
 3615               	.LM296:
GAS LISTING /var/tmp//cchOv7GV.s 			page 90


 3616 128a 2C96      		adiw r28,12
 3617 128c 8881      		ld r24,Y
 3618 128e 9981      		ldd r25,Y+1
 3619 1290 0E94 0000 		call atoi
 3620 1294 F801      		movw r30,r16
 3621 1296 918B      		std Z+17,r25
 3622 1298 808B      		std Z+16,r24
 3623               		.stabn	68,0,552,.LM297-nmeap_gpgga
 3624               	.LM297:
 3625 129a 9A91      		ld r25,-Y
 3626 129c 8A91      		ld r24,-Y
 3627 129e 0E94 0000 		call atoi
 3628 12a2 F801      		movw r30,r16
 3629 12a4 938B      		std Z+19,r25
 3630 12a6 828B      		std Z+18,r24
 3631               		.stabn	68,0,553,.LM298-nmeap_gpgga
 3632               	.LM298:
 3633 12a8 2496      		adiw r28,4
 3634 12aa 8881      		ld r24,Y
 3635 12ac 9981      		ldd r25,Y+1
 3636 12ae 0E94 0000 		call atof
 3637 12b2 F801      		movw r30,r16
 3638 12b4 648B      		std Z+20,r22
 3639 12b6 758B      		std Z+21,r23
 3640 12b8 868B      		std Z+22,r24
 3641 12ba 978B      		std Z+23,r25
 3642               		.stabn	68,0,554,.LM299-nmeap_gpgga
 3643               	.LM299:
 3644 12bc 2896      		adiw r28,8
 3645 12be 6881      		ld r22,Y
 3646 12c0 7981      		ldd r23,Y+1
 3647 12c2 C659      		subi r28,lo8(-(-406))
 3648 12c4 D140      		sbci r29,hi8(-(-406))
 3649 12c6 FE01      		movw r30,r28
 3650 12c8 EC56      		subi r30,lo8(-(404))
 3651 12ca FE4F      		sbci r31,hi8(-(404))
 3652 12cc 8081      		ld r24,Z
 3653 12ce 9181      		ldd r25,Z+1
 3654 12d0 0E94 0000 		call nmeap_altitude
 3655 12d4 F801      		movw r30,r16
 3656 12d6 608F      		std Z+24,r22
 3657 12d8 718F      		std Z+25,r23
 3658 12da 828F      		std Z+26,r24
 3659 12dc 938F      		std Z+27,r25
 3660               	.L251:
 3661               		.stabn	68,0,559,.LM300-nmeap_gpgga
 3662               	.LM300:
 3663 12de C453      		subi r28,lo8(-(460))
 3664 12e0 DE4F      		sbci r29,hi8(-(460))
 3665 12e2 DF93      		push r29
 3666 12e4 CF93      		push r28
 3667 12e6 80E0      		ldi r24,lo8(.LC0)
 3668 12e8 90E0      		ldi r25,hi8(.LC0)
 3669 12ea 9F93      		push r25
 3670 12ec 8F93      		push r24
 3671 12ee 0E94 0000 		call printf
 3672               		.stabn	68,0,562,.LM301-nmeap_gpgga
GAS LISTING /var/tmp//cchOv7GV.s 			page 91


 3673               	.LM301:
 3674 12f2 CF54      		subi r28,lo8(-(-79))
 3675 12f4 D040      		sbci r29,hi8(-(-79))
 3676 12f6 8881      		ld r24,Y
 3677 12f8 9927      		clr r25
 3678 12fa 87FD      		sbrc r24,7
 3679 12fc 9095      		com r25
 3680 12fe 9F93      		push r25
 3681 1300 8F93      		push r24
 3682 1302 8A91      		ld r24,-Y
 3683 1304 9927      		clr r25
 3684 1306 87FD      		sbrc r24,7
 3685 1308 9095      		com r25
 3686 130a 9F93      		push r25
 3687 130c 8F93      		push r24
 3688 130e BF92      		push r11
 3689 1310 AF92      		push r10
 3690 1312 2697      		sbiw r28,6
 3691 1314 DF93      		push r29
 3692 1316 CF93      		push r28
 3693 1318 C657      		subi r28,lo8(-(-374))
 3694 131a D140      		sbci r29,hi8(-(-374))
 3695 131c 80E0      		ldi r24,lo8(.LC1)
 3696 131e 90E0      		ldi r25,hi8(.LC1)
 3697 1320 9F93      		push r25
 3698 1322 8F93      		push r24
 3699 1324 0E94 0000 		call printf
 3700 1328 AEE7      		ldi r26,lo8(382)
 3701 132a CA2E      		mov r12,r26
 3702 132c A1E0      		ldi r26,hi8(382)
 3703 132e DA2E      		mov r13,r26
 3704 1330 CC0E      		add r12,r28
 3705 1332 DD1E      		adc r13,r29
 3706 1334 EE24      		clr r14
 3707 1336 FF24      		clr r15
 3708               		.stabn	68,0,565,.LM302-nmeap_gpgga
 3709               	.LM302:
 3710 1338 8DB7      		in r24,__SP_L__
 3711 133a 9EB7      		in r25,__SP_H__
 3712 133c 0E96      		adiw r24,14
 3713 133e 14C0      		rjmp .L259
 3714               	.L254:
 3715               		.stabn	68,0,566,.LM303-nmeap_gpgga
 3716               	.LM303:
 3717 1340 F601      		movw r30,r12
 3718 1342 8191      		ld r24,Z+
 3719 1344 9191      		ld r25,Z+
 3720 1346 6F01      		movw r12,r30
 3721 1348 9F93      		push r25
 3722 134a 8F93      		push r24
 3723 134c FF92      		push r15
 3724 134e EF92      		push r14
 3725 1350 80E0      		ldi r24,lo8(.LC2)
 3726 1352 90E0      		ldi r25,hi8(.LC2)
 3727 1354 9F93      		push r25
 3728 1356 8F93      		push r24
 3729 1358 0E94 0000 		call printf
GAS LISTING /var/tmp//cchOv7GV.s 			page 92


 3730               		.stabn	68,0,565,.LM304-nmeap_gpgga
 3731               	.LM304:
 3732 135c 0894      		sec
 3733 135e E11C      		adc r14,__zero_reg__
 3734 1360 F11C      		adc r15,__zero_reg__
 3735 1362 8DB7      		in r24,__SP_L__
 3736 1364 9EB7      		in r25,__SP_H__
 3737 1366 0696      		adiw r24,6
 3738               	.L259:
 3739 1368 0FB6      		in __tmp_reg__,__SREG__
 3740 136a F894      		cli
 3741 136c 9EBF      		out __SP_H__,r25
 3742 136e 0FBE      		out __SREG__,__tmp_reg__
 3743 1370 8DBF      		out __SP_L__,r24
 3744 1372 C255      		subi r28,lo8(-(430))
 3745 1374 DE4F      		sbci r29,hi8(-(430))
 3746 1376 8881      		ld r24,Y
 3747 1378 9981      		ldd r25,Y+1
 3748 137a CE5A      		subi r28,lo8(-(-430))
 3749 137c D140      		sbci r29,hi8(-(-430))
 3750 137e E816      		cp r14,r24
 3751 1380 F906      		cpc r15,r25
 3752 1382 F4F2      		brlt .L254
 3753               		.stabn	68,0,571,.LM305-nmeap_gpgga
 3754               	.LM305:
 3755 1384 F501      		movw r30,r10
 3756 1386 2285      		ldd r18,Z+10
 3757 1388 3385      		ldd r19,Z+11
 3758 138a 2115      		cp r18,__zero_reg__
 3759 138c 3105      		cpc r19,__zero_reg__
 3760 138e 51F0      		breq .L256
 3761               		.stabn	68,0,572,.LM306-nmeap_gpgga
 3762               	.LM306:
 3763 1390 C453      		subi r28,lo8(-(716))
 3764 1392 DD4F      		sbci r29,hi8(-(716))
 3765 1394 4881      		ld r20,Y
 3766 1396 5981      		ldd r21,Y+1
 3767 1398 CC5C      		subi r28,lo8(-(-716))
 3768 139a D240      		sbci r29,hi8(-(-716))
 3769 139c B801      		movw r22,r16
 3770 139e CE01      		movw r24,r28
 3771 13a0 F901      		movw r30,r18
 3772 13a2 0995      		icall
 3773               	.L256:
 3774               		.stabn	68,0,576,.LM307-nmeap_gpgga
 3775               	.LM307:
 3776 13a4 81E0      		ldi r24,lo8(1)
 3777 13a6 90E0      		ldi r25,hi8(1)
 3778               	/* epilogue: frame size=0 */
 3779 13a8 DF91      		pop r29
 3780 13aa CF91      		pop r28
 3781 13ac 1F91      		pop r17
 3782 13ae 0F91      		pop r16
 3783 13b0 FF90      		pop r15
 3784 13b2 EF90      		pop r14
 3785 13b4 DF90      		pop r13
 3786 13b6 CF90      		pop r12
GAS LISTING /var/tmp//cchOv7GV.s 			page 93


 3787 13b8 BF90      		pop r11
 3788 13ba AF90      		pop r10
 3789 13bc 0895      		ret
 3790               	/* epilogue end (size=11) */
 3791               	/* function nmeap_gpgga size 224 (203) */
 3792               		.size	nmeap_gpgga, .-nmeap_gpgga
 3793               		.stabs	"i:r(0,1)",64,0,539,14
 3794               		.stabs	"gga:r(0,24)=*(12,8)",64,0,543,16
 3795               		.stabn	192,0,0,nmeap_gpgga-nmeap_gpgga
 3796               		.stabn	224,0,0,.Lscope27-nmeap_gpgga
 3797               	.Lscope27:
 3798               		.stabs	"",36,0,0,.Lscope27-nmeap_gpgga
 3799               		.stabd	78,0,0
 3800               		.stabs	"nmeap_init:F(0,1)",36,0,177,nmeap_init
 3801               		.stabs	"context:P(0,18)",64,0,176,30
 3802               		.stabs	"user_data:P(13,4)",64,0,176,22
 3803               	.global	nmeap_init
 3804               		.type	nmeap_init, @function
 3805               	nmeap_init:
 3806               		.stabd	46,0,0
 3807               		.stabn	68,0,177,.LM308-nmeap_init
 3808               	.LM308:
 3809               	/* prologue: frame size=0 */
 3810               	/* prologue end (size=0) */
 3811 13be FC01      		movw r30,r24
 3812               		.stabn	68,0,178,.LM309-nmeap_init
 3813               	.LM309:
 3814 13c0 892B      		or r24,r25
 3815 13c2 09F4      		brne .L261
 3816               	.L264:
 3817 13c4 FFCF      		rjmp .L264
 3818               	.L261:
 3819               		.stabn	68,0,180,.LM310-nmeap_init
 3820               	.LM310:
 3821 13c6 8EEC      		ldi r24,lo8(718)
 3822 13c8 92E0      		ldi r25,hi8(718)
 3823 13ca DF01      		movw r26,r30
 3824 13cc 1D92      		st X+,__zero_reg__
 3825 13ce 0197      		sbiw r24,1
 3826 13d0 E9F7      		brne .-6
 3827               		.stabn	68,0,182,.LM311-nmeap_init
 3828               	.LM311:
 3829 13d2 E453      		subi r30,lo8(-(716))
 3830 13d4 FD4F      		sbci r31,hi8(-(716))
 3831 13d6 7183      		std Z+1,r23
 3832 13d8 6083      		st Z,r22
 3833               		.stabn	68,0,185,.LM312-nmeap_init
 3834               	.LM312:
 3835 13da 80E0      		ldi r24,lo8(0)
 3836 13dc 90E0      		ldi r25,hi8(0)
 3837               	/* epilogue: frame size=0 */
 3838 13de 0895      		ret
 3839               	/* epilogue end (size=1) */
 3840               	/* function nmeap_init size 17 (16) */
 3841               		.size	nmeap_init, .-nmeap_init
 3842               	.Lscope28:
 3843               		.stabs	"",36,0,0,.Lscope28-nmeap_init
GAS LISTING /var/tmp//cchOv7GV.s 			page 94


 3844               		.stabd	78,0,0
 3845               		.stabs	"nmeap_addParser:F(0,1)",36,0,197,nmeap_addParser
 3846               		.stabs	"context:P(0,18)",64,0,191,30
 3847               		.stabs	"sentence_name:P(0,16)",64,0,192,22
 3848               		.stabs	"sentence_parser:P(12,4)",64,0,193,28
 3849               		.stabs	"sentence_callout:P(12,1)",64,0,194,14
 3850               		.stabs	"sentence_data:P(13,4)",64,0,196,12
 3851               	.global	nmeap_addParser
 3852               		.type	nmeap_addParser, @function
 3853               	nmeap_addParser:
 3854               		.stabd	46,0,0
 3855               		.stabn	68,0,197,.LM313-nmeap_addParser
 3856               	.LM313:
 3857               	/* prologue: frame size=0 */
 3858 13e0 CF92      		push r12
 3859 13e2 DF92      		push r13
 3860 13e4 EF92      		push r14
 3861 13e6 FF92      		push r15
 3862 13e8 0F93      		push r16
 3863 13ea 1F93      		push r17
 3864 13ec CF93      		push r28
 3865 13ee DF93      		push r29
 3866               	/* prologue end (size=8) */
 3867 13f0 FC01      		movw r30,r24
 3868 13f2 EA01      		movw r28,r20
 3869 13f4 7901      		movw r14,r18
 3870 13f6 6801      		movw r12,r16
 3871               		.stabn	68,0,201,.LM314-nmeap_addParser
 3872               	.LM314:
 3873 13f8 0097      		sbiw r24,0
 3874 13fa 09F4      		brne .L266
 3875               	.L272:
 3876 13fc FFCF      		rjmp .L272
 3877               	.L266:
 3878               		.stabn	68,0,204,.LM315-nmeap_addParser
 3879               	.LM315:
 3880 13fe DC01      		movw r26,r24
 3881 1400 A059      		subi r26,lo8(-(112))
 3882 1402 BF4F      		sbci r27,hi8(-(112))
 3883 1404 2D91      		ld r18,X+
 3884 1406 3C91      		ld r19,X
 3885 1408 1197      		sbiw r26,1
 3886 140a 2830      		cpi r18,8
 3887 140c 3105      		cpc r19,__zero_reg__
 3888 140e 1CF0      		brlt .L268
 3889 1410 8FEF      		ldi r24,lo8(-1)
 3890 1412 9FEF      		ldi r25,hi8(-1)
 3891 1414 22C0      		rjmp .L270
 3892               	.L268:
 3893               		.stabn	68,0,209,.LM316-nmeap_addParser
 3894               	.LM316:
 3895 1416 8EE0      		ldi r24,lo8(14)
 3896 1418 90E0      		ldi r25,hi8(14)
 3897 141a 289F      		mul r18,r24
 3898 141c 8001      		movw r16,r0
 3899 141e 299F      		mul r18,r25
 3900 1420 100D      		add r17,r0
GAS LISTING /var/tmp//cchOv7GV.s 			page 95


 3901 1422 389F      		mul r19,r24
 3902 1424 100D      		add r17,r0
 3903 1426 1124      		clr r1
 3904 1428 0E0F      		add r16,r30
 3905 142a 1F1F      		adc r17,r31
 3906               		.stabn	68,0,212,.LM317-nmeap_addParser
 3907               	.LM317:
 3908 142c 2F5F      		subi r18,lo8(-(1))
 3909 142e 3F4F      		sbci r19,hi8(-(1))
 3910 1430 2D93      		st X+,r18
 3911 1432 3C93      		st X,r19
 3912               		.stabn	68,0,215,.LM318-nmeap_addParser
 3913               	.LM318:
 3914 1434 8EE0      		ldi r24,lo8(14)
 3915 1436 F801      		movw r30,r16
 3916 1438 1192      		st Z+,__zero_reg__
 3917 143a 8A95      	        dec r24
 3918 143c E9F7      		brne .-6
 3919               		.stabn	68,0,218,.LM319-nmeap_addParser
 3920               	.LM319:
 3921 143e 45E0      		ldi r20,lo8(5)
 3922 1440 50E0      		ldi r21,hi8(5)
 3923 1442 C801      		movw r24,r16
 3924 1444 0E94 0000 		call strncpy
 3925               		.stabn	68,0,221,.LM320-nmeap_addParser
 3926               	.LM320:
 3927 1448 F801      		movw r30,r16
 3928 144a D187      		std Z+9,r29
 3929 144c C087      		std Z+8,r28
 3930               		.stabn	68,0,224,.LM321-nmeap_addParser
 3931               	.LM321:
 3932 144e F386      		std Z+11,r15
 3933 1450 E286      		std Z+10,r14
 3934               		.stabn	68,0,227,.LM322-nmeap_addParser
 3935               	.LM322:
 3936 1452 D586      		std Z+13,r13
 3937 1454 C486      		std Z+12,r12
 3938 1456 80E0      		ldi r24,lo8(0)
 3939 1458 90E0      		ldi r25,hi8(0)
 3940               	.L270:
 3941               	/* epilogue: frame size=0 */
 3942 145a DF91      		pop r29
 3943 145c CF91      		pop r28
 3944 145e 1F91      		pop r17
 3945 1460 0F91      		pop r16
 3946 1462 FF90      		pop r15
 3947 1464 EF90      		pop r14
 3948 1466 DF90      		pop r13
 3949 1468 CF90      		pop r12
 3950 146a 0895      		ret
 3951               	/* epilogue end (size=9) */
 3952               	/* function nmeap_addParser size 70 (53) */
 3953               		.size	nmeap_addParser, .-nmeap_addParser
 3954               		.stabs	"s:r(0,22)",64,0,198,16
 3955               		.stabn	192,0,0,nmeap_addParser-nmeap_addParser
 3956               		.stabn	224,0,0,.Lscope29-nmeap_addParser
 3957               	.Lscope29:
GAS LISTING /var/tmp//cchOv7GV.s 			page 96


 3958               		.stabs	"",36,0,0,.Lscope29-nmeap_addParser
 3959               		.stabd	78,0,0
 3960               		.section	.progmem.data
 3961               		.type	__c.2558, @object
 3962               		.size	__c.2558, 12
 3963               	__c.2558:
 3964 01d2 0D0A 7365 		.string	"\r\nsent i2c!"
 3964      6E74 2069 
 3964      3263 2100 
 3965               		.type	__c.2547, @object
 3966               		.size	__c.2547, 18
 3967               	__c.2547:
 3968 01de 6E6D 6561 		.string	"nmeap_add RMC %d\n"
 3968      705F 6164 
 3968      6420 524D 
 3968      4320 2564 
 3968      0A00 
 3969               		.type	__c.2545, @object
 3970               		.size	__c.2545, 18
 3971               	__c.2545:
 3972 01f0 6E6D 6561 		.string	"nmeap_add GGA %d\n"
 3972      705F 6164 
 3972      6420 4747 
 3972      4120 2564 
 3972      0A00 
 3973               		.type	__c.2543, @object
 3974               		.size	__c.2543, 15
 3975               	__c.2543:
 3976 0202 6E6D 6561 		.string	"nmeap_init %d\n"
 3976      705F 696E 
 3976      6974 2025 
 3976      640A 00
 3977               		.type	__c.2541, @object
 3978               		.size	__c.2541, 30
 3979               	__c.2541:
 3980 0211 0D0A 5765 		.string	"\r\nWelcome to GPS subsystem!\r\n"
 3980      6C63 6F6D 
 3980      6520 746F 
 3980      2047 5053 
 3980      2073 7562 
 3981               		.data
 3982               	.LC3:
 3983 0040 4750 4747 		.string	"GPGGA"
 3983      4100 
 3984               	.LC4:
 3985 0046 4750 524D 		.string	"GPRMC"
 3985      4300 
 3986               		.text
 3987               		.stabs	"main:F(0,1)",36,0,67,main
 3988               	.global	main
 3989               		.type	main, @function
 3990               	main:
 3991               		.stabd	46,0,0
 3992               		.stabs	"gpstest.c",132,0,0,.Ltext6
 3993               	.Ltext6:
 3994               		.stabn	68,0,67,.LM323-main
 3995               	.LM323:
GAS LISTING /var/tmp//cchOv7GV.s 			page 97


 3996               	/* prologue: frame size=0 */
 3997 146c C0E0      		ldi r28,lo8(__stack - 0)
 3998 146e D0E0      		ldi r29,hi8(__stack - 0)
 3999 1470 DEBF      		out __SP_H__,r29
 4000 1472 CDBF      		out __SP_L__,r28
 4001               	/* prologue end (size=4) */
 4002               		.stabn	68,0,79,.LM324-main
 4003               	.LM324:
 4004 1474 1092 0000 		sts message_sent,__zero_reg__
 4005               		.stabn	68,0,86,.LM325-main
 4006               	.LM325:
 4007 1478 0E94 0000 		call uartInit
 4008               		.stabn	68,0,87,.LM326-main
 4009               	.LM326:
 4010 147c 0E94 0000 		call timerInit
 4011               		.stabn	68,0,88,.LM327-main
 4012               	.LM327:
 4013 1480 84EF      		ldi r24,lo8(500)
 4014 1482 91E0      		ldi r25,hi8(500)
 4015 1484 0E94 0000 		call timerPause
 4016               		.stabn	68,0,93,.LM328-main
 4017               	.LM328:
 4018 1488 60EC      		ldi r22,lo8(4800)
 4019 148a 72E1      		ldi r23,hi8(4800)
 4020 148c 80E0      		ldi r24,hlo8(4800)
 4021 148e 90E0      		ldi r25,hhi8(4800)
 4022 1490 0E94 0000 		call uartSetBaudRate
 4023               		.stabn	68,0,95,.LM329-main
 4024               	.LM329:
 4025 1494 80E0      		ldi r24,lo8(pm(uartSendByte))
 4026 1496 90E0      		ldi r25,hi8(pm(uartSendByte))
 4027 1498 0E94 0000 		call rprintfInit
 4028               		.stabn	68,0,96,.LM330-main
 4029               	.LM330:
 4030 149c 0E94 0000 		call initVoiceBox
 4031               		.stabn	68,0,97,.LM331-main
 4032               	.LM331:
 4033 14a0 88E7      		ldi r24,lo8(120)
 4034 14a2 8093 0000 		sts voiceBoxCue,r24
 4035               		.stabn	68,0,119,.LM332-main
 4036               	.LM332:
 4037 14a6 80E0      		ldi r24,lo8(__c.2541)
 4038 14a8 90E0      		ldi r25,hi8(__c.2541)
 4039 14aa 9F93      		push r25
 4040 14ac 8F93      		push r24
 4041 14ae B1E0      		ldi r27,lo8(1)
 4042 14b0 FB2E      		mov r15,r27
 4043 14b2 FF92      		push r15
 4044 14b4 0E94 0000 		call rprintf1RamRom
 4045               		.stabn	68,0,125,.LM333-main
 4046               	.LM333:
 4047 14b8 0E94 0000 		call uartswInit
 4048               		.stabn	68,0,126,.LM334-main
 4049               	.LM334:
 4050 14bc 60E0      		ldi r22,lo8(19200)
 4051 14be 7BE4      		ldi r23,hi8(19200)
 4052 14c0 80E0      		ldi r24,hlo8(19200)
GAS LISTING /var/tmp//cchOv7GV.s 			page 98


 4053 14c2 90E0      		ldi r25,hhi8(19200)
 4054 14c4 0E94 0000 		call uartswSetBaudRate
 4055               		.stabn	68,0,130,.LM335-main
 4056               	.LM335:
 4057 14c8 0E94 0000 		call i2cInit
 4058               		.stabn	68,0,132,.LM336-main
 4059               	.LM336:
 4060 14cc 6FEF      		ldi r22,lo8(-1)
 4061 14ce 80EA      		ldi r24,lo8(-96)
 4062 14d0 0E94 0000 		call i2cSetLocalDeviceAddr
 4063               		.stabn	68,0,136,.LM337-main
 4064               	.LM337:
 4065 14d4 80E0      		ldi r24,lo8(pm(i2cSlaveReceiveService))
 4066 14d6 90E0      		ldi r25,hi8(pm(i2cSlaveReceiveService))
 4067 14d8 0E94 0000 		call i2cSetSlaveReceiveHandler
 4068               		.stabn	68,0,140,.LM338-main
 4069               	.LM338:
 4070 14dc 80E0      		ldi r24,lo8(pm(i2cSlaveTransmitService))
 4071 14de 90E0      		ldi r25,hi8(pm(i2cSlaveTransmitService))
 4072 14e0 0E94 0000 		call i2cSetSlaveTransmitHandler
 4073               		.stabn	68,0,144,.LM339-main
 4074               	.LM339:
 4075 14e4 40E8      		ldi r20,lo8(128)
 4076 14e6 50E0      		ldi r21,hi8(128)
 4077 14e8 60E0      		ldi r22,lo8(gpsBufferData)
 4078 14ea 70E0      		ldi r23,hi8(gpsBufferData)
 4079 14ec 80E0      		ldi r24,lo8(gpsBuffer)
 4080 14ee 90E0      		ldi r25,hi8(gpsBuffer)
 4081 14f0 0E94 0000 		call bufferInit
 4082               		.stabn	68,0,146,.LM340-main
 4083               	.LM340:
 4084 14f4 80E0      		ldi r24,lo8(pm(addToBuffer))
 4085 14f6 90E0      		ldi r25,hi8(pm(addToBuffer))
 4086 14f8 0E94 0000 		call uartSetRxHandler
 4087               		.stabn	68,0,151,.LM341-main
 4088               	.LM341:
 4089 14fc 60E0      		ldi r22,lo8(user_data)
 4090 14fe 70E0      		ldi r23,hi8(user_data)
 4091 1500 80E0      		ldi r24,lo8(nmea)
 4092 1502 90E0      		ldi r25,hi8(nmea)
 4093 1504 0E94 0000 		call nmeap_init
 4094               		.stabn	68,0,152,.LM342-main
 4095               	.LM342:
 4096 1508 0F90      		pop __tmp_reg__
 4097 150a 0F90      		pop __tmp_reg__
 4098 150c 0F90      	 	pop __tmp_reg__
 4099 150e 0097      		sbiw r24,0
 4100 1510 71F0      		breq .L274
 4101               		.stabn	68,0,153,.LM343-main
 4102               	.LM343:
 4103 1512 9F93      		push r25
 4104 1514 8F93      		push r24
 4105 1516 80E0      		ldi r24,lo8(__c.2543)
 4106 1518 90E0      		ldi r25,hi8(__c.2543)
 4107 151a 9F93      		push r25
 4108 151c 8F93      		push r24
 4109 151e FF92      		push r15
GAS LISTING /var/tmp//cchOv7GV.s 			page 99


 4110 1520 0E94 0000 		call rprintf1RamRom
 4111 1524 0F90      		pop __tmp_reg__
 4112 1526 0F90      		pop __tmp_reg__
 4113 1528 0F90      		pop __tmp_reg__
 4114 152a 0F90      		pop __tmp_reg__
 4115 152c 0F90      		pop __tmp_reg__
 4116               	.L274:
 4117               		.stabn	68,0,156,.LM344-main
 4118               	.LM344:
 4119 152e 00E0      		ldi r16,lo8(gga)
 4120 1530 10E0      		ldi r17,hi8(gga)
 4121 1532 20E0      		ldi r18,lo8(0)
 4122 1534 30E0      		ldi r19,hi8(0)
 4123 1536 40E0      		ldi r20,lo8(pm(nmeap_gpgga))
 4124 1538 50E0      		ldi r21,hi8(pm(nmeap_gpgga))
 4125 153a 60E0      		ldi r22,lo8(.LC3)
 4126 153c 70E0      		ldi r23,hi8(.LC3)
 4127 153e 80E0      		ldi r24,lo8(nmea)
 4128 1540 90E0      		ldi r25,hi8(nmea)
 4129 1542 0E94 0000 		call nmeap_addParser
 4130               		.stabn	68,0,157,.LM345-main
 4131               	.LM345:
 4132 1546 0097      		sbiw r24,0
 4133 1548 71F0      		breq .L276
 4134               		.stabn	68,0,158,.LM346-main
 4135               	.LM346:
 4136 154a 9F93      		push r25
 4137 154c 8F93      		push r24
 4138 154e 80E0      		ldi r24,lo8(__c.2545)
 4139 1550 90E0      		ldi r25,hi8(__c.2545)
 4140 1552 9F93      		push r25
 4141 1554 8F93      		push r24
 4142 1556 FF92      		push r15
 4143 1558 0E94 0000 		call rprintf1RamRom
 4144 155c 0F90      		pop __tmp_reg__
 4145 155e 0F90      		pop __tmp_reg__
 4146 1560 0F90      		pop __tmp_reg__
 4147 1562 0F90      		pop __tmp_reg__
 4148 1564 0F90      		pop __tmp_reg__
 4149               	.L276:
 4150               		.stabn	68,0,160,.LM347-main
 4151               	.LM347:
 4152 1566 00E0      		ldi r16,lo8(rmc)
 4153 1568 10E0      		ldi r17,hi8(rmc)
 4154 156a 20E0      		ldi r18,lo8(0)
 4155 156c 30E0      		ldi r19,hi8(0)
 4156 156e 40E0      		ldi r20,lo8(pm(nmeap_gprmc))
 4157 1570 50E0      		ldi r21,hi8(pm(nmeap_gprmc))
 4158 1572 60E0      		ldi r22,lo8(.LC4)
 4159 1574 70E0      		ldi r23,hi8(.LC4)
 4160 1576 80E0      		ldi r24,lo8(nmea)
 4161 1578 90E0      		ldi r25,hi8(nmea)
 4162 157a 0E94 0000 		call nmeap_addParser
 4163               		.stabn	68,0,161,.LM348-main
 4164               	.LM348:
 4165 157e 0097      		sbiw r24,0
 4166 1580 71F0      		breq .L292
GAS LISTING /var/tmp//cchOv7GV.s 			page 100


 4167               		.stabn	68,0,162,.LM349-main
 4168               	.LM349:
 4169 1582 9F93      		push r25
 4170 1584 8F93      		push r24
 4171 1586 80E0      		ldi r24,lo8(__c.2547)
 4172 1588 90E0      		ldi r25,hi8(__c.2547)
 4173 158a 9F93      		push r25
 4174 158c 8F93      		push r24
 4175 158e FF92      		push r15
 4176 1590 0E94 0000 		call rprintf1RamRom
 4177 1594 0F90      		pop __tmp_reg__
 4178 1596 0F90      		pop __tmp_reg__
 4179 1598 0F90      		pop __tmp_reg__
 4180 159a 0F90      		pop __tmp_reg__
 4181 159c 0F90      		pop __tmp_reg__
 4182               	.L292:
 4183               	.LBB2:
 4184               		.stabn	68,0,173,.LM350-main
 4185               	.LM350:
 4186 159e 80E0      		ldi r24,lo8(gpsBuffer)
 4187 15a0 90E0      		ldi r25,hi8(gpsBuffer)
 4188 15a2 0E94 0000 		call bufferGetFromFront
 4189 15a6 682F      		mov r22,r24
 4190               		.stabn	68,0,174,.LM351-main
 4191               	.LM351:
 4192 15a8 8823      		tst r24
 4193 15aa 21F0      		breq .L280
 4194               		.stabn	68,0,176,.LM352-main
 4195               	.LM352:
 4196 15ac 80E0      		ldi r24,lo8(nmea)
 4197 15ae 90E0      		ldi r25,hi8(nmea)
 4198 15b0 0E94 0000 		call nmeap_parse
 4199               	.L280:
 4200               		.stabn	68,0,236,.LM353-main
 4201               	.LM353:
 4202 15b4 8091 0000 		lds r24,voiceBoxCue
 4203 15b8 8837      		cpi r24,lo8(120)
 4204 15ba 11F0      		breq .L282
 4205               		.stabn	68,0,238,.LM354-main
 4206               	.LM354:
 4207 15bc 0E94 0000 		call sendTextMessage
 4208               	.L282:
 4209               		.stabn	68,0,241,.LM355-main
 4210               	.LM355:
 4211 15c0 8091 0000 		lds r24,message_sent
 4212 15c4 8823      		tst r24
 4213 15c6 59F3      		breq .L292
 4214               		.stabn	68,0,243,.LM356-main
 4215               	.LM356:
 4216 15c8 21E0      		ldi r18,lo8(1)
 4217 15ca 2093 0000 		sts message_sent,r18
 4218               		.stabn	68,0,244,.LM357-main
 4219               	.LM357:
 4220 15ce 80E0      		ldi r24,lo8(__c.2558)
 4221 15d0 90E0      		ldi r25,hi8(__c.2558)
 4222 15d2 9F93      		push r25
 4223 15d4 8F93      		push r24
GAS LISTING /var/tmp//cchOv7GV.s 			page 101


 4224 15d6 2F93      		push r18
 4225 15d8 0E94 0000 		call rprintf1RamRom
 4226 15dc 0F90      		pop __tmp_reg__
 4227 15de 0F90      		pop __tmp_reg__
 4228 15e0 0F90      	 	pop __tmp_reg__
 4229 15e2 DDCF      		rjmp .L292
 4230               	.LBE2:
 4231               	/* epilogue: frame size=0 */
 4232               	/* epilogue: noreturn */
 4233               	/* epilogue end (size=0) */
 4234               	/* function main size 188 (184) */
 4235               		.size	main, .-main
 4236               		.stabs	"status:r(0,1)",64,0,68,24
 4237               		.stabn	192,0,0,main-main
 4238               		.stabn	224,0,0,.Lscope30-main
 4239               	.Lscope30:
 4240               		.stabs	"",36,0,0,.Lscope30-main
 4241               		.stabd	78,0,0
 4242               		.stabs	"UartswTxBusy:S(0,25)=B(7,1)",40,0,30,UartswTxBusy
 4243               		.stabs	"UartswTxData:S(0,25)",40,0,31,UartswTxData
 4244               		.stabs	"UartswTxBitNum:S(0,25)",40,0,32,UartswTxBitNum
 4245               		.stabs	"UartswBaudRateDiv:S(0,26)=B(7,3)",40,0,35,UartswBaudRateDiv
 4246               		.stabs	"UartswRxBusy:S(0,25)",40,0,38,UartswRxBusy
 4247               		.stabs	"UartswRxData:S(0,25)",40,0,39,UartswRxData
 4248               		.stabs	"UartswRxBitNum:S(0,25)",40,0,40,UartswRxBitNum
 4249               		.stabs	"uartswRxBuffer:S(8,3)",40,0,42,uartswRxBuffer
 4250               		.stabs	"uartswRxData:S(0,27)=ar(13,3);0;31;(0,2)",40,0,44,uartswRxData
 4251               		.stabs	"sentence:S(0,28)=ar(13,3);0;19;(0,2)",40,0,45,sentence
 4252               		.stabs	"nmea:S(13,11)",40,0,39,nmea
 4253               		.stabs	"user_data:S(0,1)",40,0,40,user_data
 4254               		.stabs	"gga:S(12,8)",40,0,41,gga
 4255               		.stabs	"rmc:S(12,10)",40,0,42,rmc
 4256               		.stabs	"gpsBuffer:S(8,3)",40,0,44,gpsBuffer
 4257               		.stabs	"gpsBufferData:S(0,29)=ar(13,3);0;127;(0,2)",40,0,45,gpsBufferData
 4258               		.stabs	"voiceBoxCue:G(0,11)",32,0,34,0
 4259               		.stabs	"localBuffer:G(0,30)=ar(13,3);0;33;(0,11)",32,0,36,0
 4260               		.stabs	"localBufferLength:G(0,11)",32,0,37,0
 4261               		.stabs	"message_sent:G(7,1)",32,0,51,0
 4262               		.stabs	"stackem:G(0,31)=ar(13,3);0;31;(7,1)",32,0,57,0
 4263               		.stabs	"stackem_pointer:G(7,1)",32,0,58,0
 4264               		.comm stackem,32,1
 4265               		.comm message_sent,1,1
 4266               		.comm voiceBoxCue,1,1
 4267               		.lcomm gpsBufferData,128
 4268               		.lcomm gpsBuffer,8
 4269               		.lcomm rmc,29
 4270               		.lcomm gga,28
 4271               		.lcomm user_data,2
 4272               		.lcomm nmea,718
 4273               		.lcomm sentence,20
 4274               		.lcomm uartswRxData,32
 4275               		.lcomm uartswRxBuffer,8
 4276               		.lcomm UartswRxBitNum,1
 4277               		.lcomm UartswRxData,1
 4278               		.lcomm UartswRxBusy,1
 4279               		.lcomm UartswBaudRateDiv,2
 4280               		.lcomm UartswTxBitNum,1
GAS LISTING /var/tmp//cchOv7GV.s 			page 102


 4281               		.lcomm UartswTxData,1
 4282               		.lcomm UartswTxBusy,1
 4283               		.stabs	"",100,0,0,.Letext0
 4284               	.Letext0:
 4285               	/* File "gpstest.c": code 2805 = 0x0af5 (2470), prologues 163, epilogues 172 */
GAS LISTING /var/tmp//cchOv7GV.s 			page 103


DEFINED SYMBOLS
                            *ABS*:00000000 gpstest.c
/var/tmp//cchOv7GV.s:3      *ABS*:0000003f __SREG__
/var/tmp//cchOv7GV.s:4      *ABS*:0000003e __SP_H__
/var/tmp//cchOv7GV.s:5      *ABS*:0000003d __SP_L__
/var/tmp//cchOv7GV.s:6      *ABS*:00000000 __tmp_reg__
/var/tmp//cchOv7GV.s:7      *ABS*:00000001 __zero_reg__
/var/tmp//cchOv7GV.s:160    .bss:00000000 stackem_pointer
/var/tmp//cchOv7GV.s:166    .data:00000000 localBufferLength
/var/tmp//cchOv7GV.s:171    .data:00000001 localBuffer
/var/tmp//cchOv7GV.s:179    .text:00000000 nmeap_altitude
/var/tmp//cchOv7GV.s:242    .text:0000003a nmeap_tokenize
/var/tmp//cchOv7GV.s:339    .text:00000096 nmeap_process
/var/tmp//cchOv7GV.s:462    .text:0000013a nmeap_parse
/var/tmp//cchOv7GV.s:975    .text:00000424 nmeap_parseBuffer
/var/tmp//cchOv7GV.s:1068   .text:00000492 dist
/var/tmp//cchOv7GV.s:1312   .text:00000678 bearing
/var/tmp//cchOv7GV.s:1542   .text:0000083e uartswInitBuffers
/var/tmp//cchOv7GV.s:4273   .bss:000003a6 uartswRxData
/var/tmp//cchOv7GV.s:4274   .bss:000003c6 uartswRxBuffer
/var/tmp//cchOv7GV.s:1570   .text:00000850 uartswOff
/var/tmp//cchOv7GV.s:1615   .text:00000876 uartswSetBaudRate
/var/tmp//cchOv7GV.s:4278   .bss:000003d1 UartswBaudRateDiv
/var/tmp//cchOv7GV.s:1663   .text:000008b6 uartswInit
/var/tmp//cchOv7GV.s:4281   .bss:000003d5 UartswTxBusy
/var/tmp//cchOv7GV.s:1877   .text:0000098c uartswTxBitService
/var/tmp//cchOv7GV.s:4277   .bss:000003d0 UartswRxBusy
/var/tmp//cchOv7GV.s:1950   .text:000009de uartswRxBitService
/var/tmp//cchOv7GV.s:1752   .text:00000916 uartswGetRxBuffer
/var/tmp//cchOv7GV.s:1774   .text:0000091c uartswSendByte
/var/tmp//cchOv7GV.s:4280   .bss:000003d4 UartswTxData
/var/tmp//cchOv7GV.s:4279   .bss:000003d3 UartswTxBitNum
/var/tmp//cchOv7GV.s:1828   .text:00000954 uartswReceiveByte
/var/tmp//cchOv7GV.s:4275   .bss:000003ce UartswRxBitNum
/var/tmp//cchOv7GV.s:4276   .bss:000003cf UartswRxData
/var/tmp//cchOv7GV.s:4272   .bss:00000392 sentence
/var/tmp//cchOv7GV.s:2170   .progmem.data:00000000 __c.2588
/var/tmp//cchOv7GV.s:2174   .progmem.data:0000002e __c.2585
/var/tmp//cchOv7GV.s:2178   .progmem.data:0000005c __c.2582
/var/tmp//cchOv7GV.s:2184   .progmem.data:000000df __c.2579
/var/tmp//cchOv7GV.s:2189   .progmem.data:00000137 __c.2575
/var/tmp//cchOv7GV.s:2196   .text:00000b1e sendTextMessage
                            *COM*:00000001 voiceBoxCue
/var/tmp//cchOv7GV.s:2277   .progmem.data:00000168 __c.2606
/var/tmp//cchOv7GV.s:2281   .progmem.data:00000182 __c.2604
/var/tmp//cchOv7GV.s:2285   .progmem.data:00000189 __c.2602
/var/tmp//cchOv7GV.s:2289   .progmem.data:00000190 __c.2600
/var/tmp//cchOv7GV.s:2293   .progmem.data:000001a8 __c.2598
/var/tmp//cchOv7GV.s:2297   .progmem.data:000001ad __c.2596
/var/tmp//cchOv7GV.s:2303   .text:00000b70 initVoiceBox
/var/tmp//cchOv7GV.s:2405   .text:00000c06 addToBuffer
/var/tmp//cchOv7GV.s:4267   .bss:00000081 gpsBuffer
/var/tmp//cchOv7GV.s:2430   .text:00000c12 i2cSlaveReceiveService
/var/tmp//cchOv7GV.s:2477   .progmem.data:000001b2 __c.2660
/var/tmp//cchOv7GV.s:2481   .progmem.data:000001b5 __c.2657
/var/tmp//cchOv7GV.s:2485   .progmem.data:000001b8 __c.2654
/var/tmp//cchOv7GV.s:2489   .progmem.data:000001bb __c.2651
GAS LISTING /var/tmp//cchOv7GV.s 			page 104


/var/tmp//cchOv7GV.s:2493   .progmem.data:000001be __c.2648
/var/tmp//cchOv7GV.s:2497   .progmem.data:000001c1 __c.2645
/var/tmp//cchOv7GV.s:2501   .progmem.data:000001c4 __c.2642
/var/tmp//cchOv7GV.s:2505   .progmem.data:000001c6 __c.2639
/var/tmp//cchOv7GV.s:2509   .progmem.data:000001c9 __c.2636
/var/tmp//cchOv7GV.s:2513   .progmem.data:000001cc __c.2632
/var/tmp//cchOv7GV.s:2521   .text:00000c38 i2cSlaveTransmitService
/var/tmp//cchOv7GV.s:2817   .text:00000e10 print_to_string
/var/tmp//cchOv7GV.s:4269   .bss:000000a6 gga
/var/tmp//cchOv7GV.s:4268   .bss:00000089 rmc
                            *COM*:00000020 stackem
/var/tmp//cchOv7GV.s:2859   .text:00000e34 getCompass
/var/tmp//cchOv7GV.s:2902   .progmem.data:000001cf __c.2701
/var/tmp//cchOv7GV.s:2908   .text:00000e5c setCompassBaud
/var/tmp//cchOv7GV.s:2948   .text:00000e82 nmeap_latitude
/var/tmp//cchOv7GV.s:3094   .text:00000f58 nmeap_longitude
/var/tmp//cchOv7GV.s:3246   .text:0000102e nmeap_gprmc
/var/tmp//cchOv7GV.s:3530   .text:000011fe nmeap_gpgga
/var/tmp//cchOv7GV.s:3805   .text:000013be nmeap_init
/var/tmp//cchOv7GV.s:3853   .text:000013e0 nmeap_addParser
/var/tmp//cchOv7GV.s:3963   .progmem.data:000001d2 __c.2558
/var/tmp//cchOv7GV.s:3967   .progmem.data:000001de __c.2547
/var/tmp//cchOv7GV.s:3971   .progmem.data:000001f0 __c.2545
/var/tmp//cchOv7GV.s:3975   .progmem.data:00000202 __c.2543
/var/tmp//cchOv7GV.s:3979   .progmem.data:00000211 __c.2541
/var/tmp//cchOv7GV.s:3990   .text:0000146c main
                            *COM*:00000001 message_sent
                             .bss:00000001 gpsBufferData
/var/tmp//cchOv7GV.s:4270   .bss:000000c2 user_data
/var/tmp//cchOv7GV.s:4271   .bss:000000c4 nmea

UNDEFINED SYMBOLS
__do_copy_data
__do_clear_bss
atof
__mulsf3
strncpy
strncmp
isalnum
isxdigit
__divsf3
__subsf3
sin
cos
__addsf3
sqrt
atan2
bufferInit
timerDetach
timer1SetPrescaler
__udivmodsi4
timerAttach
bufferGetFromFront
bufferAddToEnd
bufferFlush
rprintf1RamRom
rprintfCRLF
GAS LISTING /var/tmp//cchOv7GV.s 			page 105


rprintfu08
rprintfInit
rprintfStr
__floatsisf
rprintfFloat
uartSendByte
rprintfChar
__fixsfsi
atoi
printf
__stack
uartInit
timerInit
timerPause
uartSetBaudRate
i2cInit
i2cSetLocalDeviceAddr
i2cSetSlaveReceiveHandler
i2cSetSlaveTransmitHandler
uartSetRxHandler
